(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{498:function(t,s,e){"use strict";e.r(s);var a=e(2),v=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"学习进度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#学习进度"}},[t._v("#")]),t._v(" 学习进度")]),t._v(" "),e("p",[t._v("https://cn.vitejs.dev/guide/features.html#build-optimizations")]),t._v(" "),e("h2",{attrs:{id:"介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),e("p",[t._v("vite有几个比较重要的概念：")]),t._v(" "),e("h3",{attrs:{id:"预构建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#预构建"}},[t._v("#")]),t._v(" 预构建")]),t._v(" "),e("p",[t._v("使用esbuild执行预构建，速度非常快。在服务器已经启动之后，如果遇到一个新的依赖关系导入，而这个依赖关系还没有在缓存中，Vite 将重新运行依赖构建进程并重新加载页面。")]),t._v(" "),e("h4",{attrs:{id:"为什么需要与构建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要与构建"}},[t._v("#")]),t._v(" 为什么需要与构建？")]),t._v(" "),e("ol",[e("li",[t._v("兼容性：因为vite对待所有js文件都当作es模块处理，所以需要先将cjs和umd转换为"),e("code",[t._v("es module")])]),t._v(" "),e("li",[t._v("性能：Vite 将有许多内部模块的 ESM 依赖关系转换为单个模块，以提高后续页面加载性能。例如：当我们执行 "),e("code",[t._v("import { debounce } from 'lodash-es'")]),t._v(" 时，浏览器同时发出 600 多个 HTTP 请求！通过预构建 "),e("code",[t._v("lodash-es")]),t._v(" 成为一个模块，我们就只需要一个 HTTP 请求了！")])]),t._v(" "),e("h3",{attrs:{id:"缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存"}},[t._v("#")]),t._v(" 缓存")]),t._v(" "),e("h4",{attrs:{id:"文件缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文件缓存"}},[t._v("#")]),t._v(" 文件缓存")]),t._v(" "),e("p",[t._v("Vite 会将预构建的依赖缓存到 "),e("code",[t._v("node_modules/.vite")]),t._v("，以下有变动时会重新构建：")]),t._v(" "),e("ol",[e("li",[e("code",[t._v("package.json")]),t._v(" 中的 "),e("code",[t._v("dependencies")]),t._v(" 列表")]),t._v(" "),e("li",[t._v("包管理器的 lockfile，例如 "),e("code",[t._v("package-lock.json")]),t._v(", "),e("code",[t._v("yarn.lock")]),t._v("，或者 "),e("code",[t._v("pnpm-lock.yaml")])]),t._v(" "),e("li",[t._v("可能在 "),e("code",[t._v("vite.config.js")]),t._v(" 相关字段中配置过的")])]),t._v(" "),e("p",[t._v("想重新构建可以在启动命令行后输入"),e("code",[t._v("--force")]),t._v("，或者手动删除"),e("code",[t._v("node_modules/.vite")])]),t._v(" "),e("h4",{attrs:{id:"浏览器缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#浏览器缓存"}},[t._v("#")]),t._v(" 浏览器缓存")]),t._v(" "),e("p",[t._v("解析后的依赖请求会以 HTTP 头 "),e("code",[t._v("max-age=31536000,immutable")]),t._v(" 强缓存，以提高在开发时的页面重载性能。一旦被缓存，这些请求将永远不会再到达开发服务器")]),t._v(" "),e("h2",{attrs:{id:"功能"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#功能"}},[t._v("#")]),t._v(" 功能")]),t._v(" "),e("h3",{attrs:{id:"css"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#css"}},[t._v("#")]),t._v(" css")]),t._v(" "),e("p",[t._v("内置支持"),e("code",[t._v("@import")]),t._v("内联和变基、PostCSS、 CSS Modules。支持CSS 预处理器,"),e("code",[t._v(".scss")]),t._v(", "),e("code",[t._v(".sass")]),t._v(", "),e("code",[t._v(".less")]),t._v(", "),e("code",[t._v(".styl")]),t._v(" 和 "),e("code",[t._v(".stylus")]),t._v(" 文件都是内置支持的，需要手动安装相应依赖，例如：")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -D sass\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .less")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -D "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("less")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# .styl and .stylus")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -D stylus\n")])])]),e("h2",{attrs:{id:"插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[t._v("#")]),t._v(" 插件")]),t._v(" "),e("h3",{attrs:{id:"vite-plugin-singlefile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vite-plugin-singlefile"}},[t._v("#")]),t._v(" vite-plugin-singlefile")]),t._v(" "),e("p",[t._v("内联js和css文件")]),t._v(" "),e("h3",{attrs:{id:"vite-plugin-imp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vite-plugin-imp"}},[t._v("#")]),t._v(" vite-plugin-imp")]),t._v(" "),e("p",[t._v("自动引入组件库样式文件")]),t._v(" "),e("h2",{attrs:{id:"迁移指南"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#迁移指南"}},[t._v("#")]),t._v(" 迁移指南")]),t._v(" "),e("p",[t._v("从webpack迁移到vite是一个很繁琐的事情，好在有"),e("code",[t._v("wp2vite")]),t._v("这个包自动帮我们实现这些步骤")]),t._v(" "),e("blockquote",[e("p",[t._v("迁移参考：")]),t._v(" "),e("ol",[e("li",[t._v("https://cloud.tencent.com/developer/article/1819625")])])]),t._v(" "),e("h2",{attrs:{id:"问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),e("h3",{attrs:{id:"vite运行dev报错-then-it-is-likely-the-case-that-a-known-bug-in-npm-v7-hascorrupted-your-package-lock-json-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vite运行dev报错-then-it-is-likely-the-case-that-a-known-bug-in-npm-v7-hascorrupted-your-package-lock-json-file"}},[t._v("#")]),t._v(" vite运行dev报错：then it is likely the case that a known bug in npm v7 hascorrupted your package-lock.json file")]),t._v(" "),e("p",[t._v("这是"),e("code",[t._v("esbuild")]),t._v("的bug，针对"),e("code",[t._v("npm")]),t._v("版本大于7的解决办法："),e("code",[t._v("node node_modules/esbuild/install.js")])]),t._v(" "),e("p",[t._v("问题链接：https://github.com/evanw/esbuild/issues/462")])])}),[],!1,null,null,null);s.default=v.exports}}]);