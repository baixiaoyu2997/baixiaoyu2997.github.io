(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{517:function(t,s,a){"use strict";a.r(s);var e=a(2),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),a("p",[t._v("为什么引入组合式API？")]),t._v(" "),a("h3",{attrs:{id:"对象式api存在的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对象式api存在的问题"}},[t._v("#")]),t._v(" 对象式API存在的问题")]),t._v(" "),a("ol",[a("li",[t._v("不利于复用")]),t._v(" "),a("li",[t._v("潜在命名冲突")]),t._v(" "),a("li",[t._v("上下文丢失")]),t._v(" "),a("li",[t._v("有限的类型支持")]),t._v(" "),a("li",[t._v("按APi类型组织")])]),t._v(" "),a("h3",{attrs:{id:"组合式api提供的能力"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组合式api提供的能力"}},[t._v("#")]),t._v(" 组合式API提供的能力")]),t._v(" "),a("ol",[a("li",[t._v("极易复用")]),t._v(" "),a("li",[t._v("可灵活组合（生命周期钩子可多次使用）")]),t._v(" "),a("li",[t._v("提供更好的上下文支持")]),t._v(" "),a("li",[t._v("更好的TS支持")]),t._v(" "),a("li",[t._v("按功能/逻辑组织")]),t._v(" "),a("li",[t._v("可独立于Vue组件使用")])]),t._v(" "),a("h2",{attrs:{id:"目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),a("p",[t._v("参考：https://v3.cn.vuejs.org/api/options-data.html#props")]),t._v(" "),a("h2",{attrs:{id:"库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#库"}},[t._v("#")]),t._v(" 库")]),t._v(" "),a("h3",{attrs:{id:"compiler-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compiler-dom"}},[t._v("#")]),t._v(" compiler-dom")]),t._v(" "),a("p",[t._v("实现"),a("code",[t._v("template")]),t._v("语法到"),a("code",[t._v("render")]),t._v("函数的转换")]),t._v(" "),a("h3",{attrs:{id:"compiler-sfc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#compiler-sfc"}},[t._v("#")]),t._v(" compiler-sfc")]),t._v(" "),a("p",[t._v("专门处理sfc文件的解析")]),t._v(" "),a("h2",{attrs:{id:"全局api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局api"}},[t._v("#")]),t._v(" 全局API")]),t._v(" "),a("h3",{attrs:{id:"createapp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#createapp"}},[t._v("#")]),t._v(" createApp")]),t._v(" "),a("p",[t._v("当创建实例的时候如果没有"),a("code",[t._v("template")]),t._v("，并且挂载元素不为空时，会使用挂载元素中的节点作为"),a("code",[t._v("tempalte")]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"h"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#h"}},[t._v("#")]),t._v(" h")]),t._v(" "),a("p",[t._v("hyperscript返回一个”虚拟节点“，通常缩写为 "),a("strong",[t._v("VNode")]),t._v("：一个普通对象，其中包含向 Vue 描述它应在页面上渲染哪种节点的信息，包括所有子节点的描述。它的目的是用于手动编写的"),a("a",{attrs:{href:"https://v3.cn.vuejs.org/guide/render-function.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("渲染函数"),a("OutboundLink")],1),t._v("：")]),t._v(" "),a("h3",{attrs:{id:"definecustomelement"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#definecustomelement"}},[t._v("#")]),t._v(" defineCustomElement")]),t._v(" "),a("p",[t._v("定义web component组件，定义后的组件通过原生"),a("code",[t._v("customElements.difine('my-vue-element',MyVueElement)")]),t._v("注册,注册后的组件应该由浏览器接管，而不是vue，需要配置vite：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        compilerOptions"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue将跳过my-vue-element解析")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("isCustomElement")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("tag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-vue-element"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),a("h3",{attrs:{id:"data"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data"}},[t._v("#")]),t._v(" Data")]),t._v(" "),a("h4",{attrs:{id:"props"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#props"}},[t._v("#")]),t._v(" props")]),t._v(" "),a("p",[t._v("props 无需通过 setup 函数 return，也可以在 template 进行绑定对应的值。推荐使用这种语法绑定"),a("code",[t._v("props")]),t._v(":")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("const props=defineProps()\nconst title=computed({\n  get() {\n    return props.modelValue\n  },\n  set(value) {\n    emits('update:modelValue', value)\n  },\n})\n")])])]),a("h4",{attrs:{id:"emits"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#emits"}},[t._v("#")]),t._v(" emits")]),t._v(" "),a("p",[t._v("组件事件现在可以在emits中声明（非强制），支持数组或者对象语法，对象语法中，值可以验证函数。")]),t._v(" "),a("h3",{attrs:{id:"dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dom"}},[t._v("#")]),t._v(" DOM")]),t._v(" "),a("h4",{attrs:{id:"render"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#render"}},[t._v("#")]),t._v(" render")]),t._v(" "),a("p",[t._v("大多数情况下应该使用"),a("code",[t._v("template")]),t._v("，遇到使用tempalte编写比js编写更复杂的时候应该使用render函数来渲染。")]),t._v(" "),a("h2",{attrs:{id:"实例property"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实例property"}},[t._v("#")]),t._v(" 实例property")]),t._v(" "),a("h3",{attrs:{id:"attrs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attrs"}},[t._v("#")]),t._v(" $attrs")]),t._v(" "),a("p",[t._v("vue3中$attrs将包含"),a("code",[t._v("class")]),t._v("、"),a("code",[t._v("style")]),t._v("、"),a("code",[t._v("$listeners")])]),t._v(" "),a("h2",{attrs:{id:"指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指令"}},[t._v("#")]),t._v(" 指令")]),t._v(" "),a("h3",{attrs:{id:"v-model"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#v-model"}},[t._v("#")]),t._v(" v-model")]),t._v(" "),a("p",[t._v("可以使用在"),a("code",[t._v("input、select、textarea和components")]),t._v("上。")]),t._v(" "),a("p",[t._v("当被使用在组件上时，等价于：")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("custom-input")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":model-value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("searchText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("@update:")]),t._v("model-value")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("searchText = $event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("custom-input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),a("p",[t._v("自定义组件绑定属性:")]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("custom-input")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("v-model:")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("searchText"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("custom-input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("vue3中不再支持"),a("code",[t._v("v-bind.sync")]),t._v(",使用v-model来替换")]),t._v(" "),a("h3",{attrs:{id:"v-bind"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#v-bind"}},[t._v("#")]),t._v(" v-bind")]),t._v(" "),a("p",[t._v("vue2中当有v-bind和其他单独的属性绑定，则不论单独的属性在哪里，v-bind中的属性永远是被替换的，而在vue3中替换条件则根据定义的位置决定")]),t._v(" "),a("p",[t._v("vue3中以"),a("code",[t._v("on")]),t._v("开头的属性绑定被当做事件处理，这会有个隐性问题，使用组件时"),a("code",[t._v("@click")]),t._v("和"),a("code",[t._v("on-click")]),t._v("是等价的，在组件内部props接收时都为"),a("code",[t._v("onClick")]),t._v(",使用attrs可以区分。使用"),a("code",[t._v("emit")]),t._v("触发事件可以解决这个问题。")]),t._v(" "),a("h2",{attrs:{id:"特殊指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特殊指令"}},[t._v("#")]),t._v(" 特殊指令")]),t._v(" "),a("h3",{attrs:{id:"is"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#is"}},[t._v("#")]),t._v(" is")]),t._v(" "),a("p",[a("code",[t._v("vue3.1")]),t._v("之后可以用在html原生组件上，is在html中表示该元素使用自定组件渲染，想要使用vue的组件，需要添加前缀"),a("code",[t._v("vue:：")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("tr")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("is")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("vue:my-row-component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("tr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h2",{attrs:{id:"响应性api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应性api"}},[t._v("#")]),t._v(" 响应性API")]),t._v(" "),a("h3",{attrs:{id:"响应性基础api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#响应性基础api"}},[t._v("#")]),t._v(" 响应性基础API")]),t._v(" "),a("h3",{attrs:{id:"reactive"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#reactive"}},[t._v("#")]),t._v(" reactive")]),t._v(" "),a("p",[t._v("返回对象的响应式副本，响应式转换是深度的，影响所有嵌套属性.")]),t._v(" "),a("p",[t._v("当ref被包裹在响应式"),a("code",[t._v("Object")]),t._v("中时，会自动展开，不需要写"),a("code",[t._v(".value")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  count\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 0")]),t._v("\n\nstate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"readonly"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#readonly"}},[t._v("#")]),t._v(" readonly")]),t._v(" "),a("p",[t._v("接收一个对象或响应式对象，并返回一个原始对象的只读代理（不可增删改）。修改原始对象会导致readonly对象值变更。")]),t._v(" "),a("h4",{attrs:{id:"toraw"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#toraw"}},[t._v("#")]),t._v(" toRaw")]),t._v(" "),a("p",[t._v("返回 "),a("a",{attrs:{href:"https://v3.cn.vuejs.org/api/basic-reactivity.html#reactive",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("reactive")]),a("OutboundLink")],1),t._v(" 或 "),a("a",{attrs:{href:"https://v3.cn.vuejs.org/api/basic-reactivity.html#readonly",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("readonly")]),a("OutboundLink")],1),t._v(" proxy 的原始对象。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" reactiveFoo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toRaw")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reactiveFoo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])])]),a("h3",{attrs:{id:"markraw"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#markraw"}},[t._v("#")]),t._v(" markRaw")]),t._v(" "),a("p",[t._v("标记一个对象永远不会被reactive，即使是被嵌套在其他reactive对象中")]),t._v(" "),a("h4",{attrs:{id:"isproxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#isproxy"}},[t._v("#")]),t._v(" isProxy")]),t._v(" "),a("p",[t._v("用于判断一个对象是否由"),a("a",{attrs:{href:"https://vuejs.org/api/reactivity-core.html#reactive",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("reactive()")]),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://vuejs.org/api/reactivity-core.html#readonly",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("readonly()")]),a("OutboundLink")],1),t._v(", "),a("a",{attrs:{href:"https://vuejs.org/api/reactivity-advanced.html#shallowreactive",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("shallowReactive()")]),a("OutboundLink")],1),t._v(" or "),a("a",{attrs:{href:"https://vuejs.org/api/reactivity-advanced.html#shallowreadonly",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("shallowReadonly()")]),a("OutboundLink")],1),t._v("创建")]),t._v(" "),a("h4",{attrs:{id:"isreative"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#isreative"}},[t._v("#")]),t._v(" isReative")]),t._v(" "),a("p",[t._v("用于判断数据是否有"),a("code",[t._v("reactive")]),t._v("创建的")]),t._v(" "),a("h4",{attrs:{id:"isreadonly"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#isreadonly"}},[t._v("#")]),t._v(" isReadonly")]),t._v(" "),a("p",[t._v("用于判断数据是否由"),a("code",[t._v("readonly")]),t._v("创建")]),t._v(" "),a("h3",{attrs:{id:"refs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#refs"}},[t._v("#")]),t._v(" Refs")]),t._v(" "),a("h4",{attrs:{id:"ref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ref"}},[t._v("#")]),t._v(" ref")]),t._v(" "),a("p",[t._v("ref 和 reactive 的存在都是了追踪值变化（响应式），ref 有个「包装」的概念，它用来包装原始值类型，如 string 和 number ，我们都知道不是引用类型是无法追踪后续的变化的。ref 返回的是一个包含 "),a("code",[t._v(".value")]),t._v(" 属性的对象。ref本质也是"),a("code",[t._v("reactive")]),t._v("。")]),t._v(" "),a("p",[t._v("如果将一个"),a("code",[t._v("ref")]),t._v("传递给"),a("code",[t._v("ref()")]),t._v("，它将原样将其返回。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v("bar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isRef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以上面的判断也可以简写下边这样")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("ref值的修改：ref值的修改应该是在"),a("code",[t._v("xxx.value")]),t._v("上进行，如果对返回的ref对象进行修改，则会因为被覆盖导致响应性丢失。")]),t._v(" "),a("p",[a("code",[t._v("watch")]),t._v("函数监听"),a("code",[t._v("ref")]),t._v("时，返回值会自动解包：")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 已经解包的值")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("ref还可以创建对元素的引用,与"),a("code",[t._v("react")]),t._v("类似：")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("div元素"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ref"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onMounted "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建一个DOM引用，名称必须与元素的ref属性名相同")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" el "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在挂载后才能通过 el 获取到目标元素")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onMounted")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'内容被修改'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 把创建的引用 return 出去")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("el"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("有些情况可以使用ref也可以使用toRef，具体的区别是：")]),t._v(" "),a("ol",[a("li",[a("code",[t._v("ref")]),t._v("是对传入数据的拷贝；"),a("code",[t._v("toRef")]),t._v("是对传入数据的引用")]),t._v(" "),a("li",[a("code",[t._v("ref")]),t._v("的值改变会更新视图；"),a("code",[t._v("toRef")]),t._v("的值改变不会更新视图")])]),t._v(" "),a("h4",{attrs:{id:"isref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#isref"}},[t._v("#")]),t._v(" isRef")]),t._v(" "),a("p",[t._v("用于判断数据是否是"),a("code",[t._v("ref")]),t._v("对象")]),t._v(" "),a("h4",{attrs:{id:"unref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#unref"}},[t._v("#")]),t._v(" unref")]),t._v(" "),a("p",[t._v("如果参数为ref，返回"),a("code",[t._v(".value")]),t._v("，否则返回参数本身。相当于"),a("code",[t._v("val = isRef(val) ? val.value : val")]),t._v(".")]),t._v(" "),a("p",[t._v("使用场景：unref可以用作在不确定参数类型的工具函数中使用。")]),t._v(" "),a("p",[t._v("注意：unref不支持deep处理，使用"),a("code",[t._v("JSON.parse(JSON.stringify(data))")]),t._v("可以快速实现"),a("code",[t._v("unwrap")]),t._v(",但是不能对computedRef使用，相关讨论：https://github.com/vuejs/rfcs/discussions/366`")]),t._v(" "),a("h4",{attrs:{id:"torefs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#torefs"}},[t._v("#")]),t._v(" toRefs")]),t._v(" "),a("p",[t._v("将响应式对象转换为普通对象，其中结果对象的每个 property 都是指向原始对象相应 property 的"),a("code",[t._v("ref")]),t._v("。保持响应式对象中属性的引用，可以理解这一切都是因为我们要用解构，"),a("code",[t._v("toRefs")]),t._v(" 所采取的解决方案。")]),t._v(" "),a("p",[t._v("toRefs的参数只应该为"),a("code",[t._v("reactive")]),t._v("对象。")]),t._v(" "),a("p",[t._v("以下情况不需要使用"),a("code",[t._v("toRefs")]),t._v("，因为解构后reactive和ref还是保持原对象的引用：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\nexport const useTest = () => {\n  const a = reactive({\n    c: 1,\n    b: 2,\n  })\n  const d= ref(0)\n  const change=()=>{\n    a.c=3\n  }\n  return {\n    a,\n    d,\n    change\n  }\n}\n\n")])])]),a("h4",{attrs:{id:"shallowref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shallowref"}},[t._v("#")]),t._v(" shallowRef")]),t._v(" "),a("p",[t._v("因为ref是"),a("code",[t._v("深proxy")]),t._v("，"),a("code",[t._v("shallowRef")]),t._v("只做"),a("code",[t._v("浅proxy")]),t._v(" ，可以用来做优化")]),t._v(" "),a("h4",{attrs:{id:"triggerref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#triggerref"}},[t._v("#")]),t._v(" triggerRef")]),t._v(" "),a("p",[a("code",[t._v("shallowRef")]),t._v("中没有被监听的数据改变时，不会触发视图更新，这个时候可以使用"),a("code",[t._v("triggerRef")]),t._v("来立刻更新视图")]),t._v(" "),a("h3",{attrs:{id:"computed与watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#computed与watch"}},[t._v("#")]),t._v(" Computed与Watch")]),t._v(" "),a("h4",{attrs:{id:"computed"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#computed"}},[t._v("#")]),t._v(" computed")]),t._v(" "),a("p",[t._v("接收getter函数或者"),a("code",[t._v("get、set")]),t._v("对象为参数，返回"),a("code",[t._v("ref")]),t._v("对象。当使用getter函数为参数时，返回的是一个"),a("code",[t._v("readonly ref")])]),t._v(" "),a("p",[t._v("当computed监听一个中间值computed时，如果中间值computed的值没变，但是它依赖的值变了，那么监听中间值的computed还是会再次执行。例如：")]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" d"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\ta"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\tb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"watcheffect"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watcheffect"}},[t._v("#")]),t._v(" watchEffect")]),t._v(" "),a("p",[t._v("与watch的区别，watch是惰性出发的，而watchEffect会在声明时就触发。因为需要预先收集依赖关系，所以不能为惰性触发。")]),t._v(" "),a("p",[t._v("当watchEffect函数中包含响应性数据的get方法，就会进行收集依赖。")]),t._v(" "),a("p",[t._v("如果想要获取"),a("code",[t._v("oldValue")]),t._v(",那么应该使用"),a("code",[t._v("watch")])]),t._v(" "),a("p",[a("code",[t._v("onTrack和onTrigger")]),t._v("会在每次值变更时触发，初始化时只会触发"),a("code",[t._v("onTrack")]),t._v("。")]),t._v(" "),a("p",[t._v("watchEffect有着与上边computed一样的中间值问题。")]),t._v(" "),a("h4",{attrs:{id:"watch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watch"}},[t._v("#")]),t._v(" watch")]),t._v(" "),a("p",[a("code",[t._v("watch")]),t._v(" api监听的数据源可以是返回值的 getter 函数，也可以是"),a("code",[t._v("ref")]),t._v("数组,也可以直接是 "),a("code",[t._v("ref")]),t._v("，这点与"),a("code",[t._v("watchEffect")]),t._v("不同，"),a("code",[t._v("watchEffect")]),t._v("不能直接监听ref，"),a("code",[t._v("watch")]),t._v("如果监听的是"),a("code",[t._v("ref")]),t._v(",那么回调函数返回的值则是解包后的值。")]),t._v(" "),a("p",[a("code",[t._v("watch")]),t._v("现在有一个问题就是如果在组件实例化之前 监听的内容有多次变更只会触发一次，issue:https://github.com/vuejs/docs/issues/1154?utm_source=wechat_session&utm_medium=social&utm_oi=43554147663872")]),t._v(" "),a("h3",{attrs:{id:"effect-scope"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#effect-scope"}},[t._v("#")]),t._v(" Effect Scope")]),t._v(" "),a("p",[t._v("在Vue的setup中，响应会在开始初始化的时候被收集，在实例被卸载的时候，响应就会自动的被取消追踪了，这时一个很方便的特性。\n但是，当我们在组件外使用或者编写一个独立的包时，这会变得非常麻烦。当在单独的文件中，我们该如何停止computed & watch的响应式依赖呢？使用effetScope可以手动清除依赖绑定:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" scope "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("effectScope")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nscope"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" doubled "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("doubled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("doubled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watchEffect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Count: '")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" doubled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// to dispose all effects in the scope")]),t._v("\nscope"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"和"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#和"}},[t._v("#")]),t._v(" $()和$$()")]),t._v(" "),a("ol",[a("li",[t._v("$ref 尽量用"),a("code",[t._v("let")]),t._v("声明，如果不用let则不能修改")])]),t._v(" "),a("h2",{attrs:{id:"组合式api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组合式api"}},[t._v("#")]),t._v(" 组合式API")]),t._v(" "),a("h3",{attrs:{id:"setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" setup")]),t._v(" "),a("p",[t._v("setup函数的执行顺序要早于"),a("code",[t._v("beforeCreate")]),t._v(",并且vue3为了区分options api，特意让setup中不能调用"),a("code",[t._v("this")]),t._v("，"),a("code",[t._v("this")]),t._v("的值为"),a("code",[t._v("undefined")]),t._v("。每个单文件中只能有一个"),a("code",[t._v("setup script")])]),t._v(" "),a("p",[t._v("setup可以返回两种类型：")]),t._v(" "),a("ol",[a("li",[t._v("object类型，用来配合模版使用，")]),t._v(" "),a("li",[t._v("function类型，为渲染函数")])]),t._v(" "),a("h4",{attrs:{id:"特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[t._v("#")]),t._v(" 特性")]),t._v(" "),a("ol",[a("li",[t._v("顶层await：setup支持顶层使用await,但是会导致await之后的代码无法获取实例上下文。使用await时使用"),a("code",[t._v("withAsyncContext")]),t._v("对其进行包裹来重新获取上下文。本质原因是setup本身是个同步执行的函数，内部在执行完毕后会清空实例数据。")]),t._v(" "),a("li",[t._v("内部函数："),a("code",[t._v("v3.2")]),t._v("之后默认不需要导入支持的函数有"),a("code",[t._v("defineProps、defineEmits、defineExpose")]),t._v(",define开头的都不需要导入了。")]),t._v(" "),a("li",[t._v("外部无法获取内部导出：外部组件想要调用特定组件的内部变量或者方法时，需要在被调用组件内部导入defineExpose`，并设置要导出的变量")]),t._v(" "),a("li",[t._v("外部导入：组件内部可以通过再添加一个"),a("code",[t._v("script")]),t._v("标签，来"),a("code",[t._v("export")]),t._v("，位置必须在setup上边。相当于setup负责渲染部分，其他的script可以用来导出。也可以"),a("code",[t._v("export default")]),t._v(",这里导出的就相当于是在原先导出的组件上添加的属性。")]),t._v(" "),a("li",[a("code",[t._v("useAttrs")]),t._v(":用于输出当前组件非"),a("code",[t._v("defineProps")]),t._v("定义的属性,非响应式")]),t._v(" "),a("li",[a("code",[t._v("useSlots")]),t._v("：用于输出当前组件的插槽")])]),t._v(" "),a("h3",{attrs:{id:"defineexpose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#defineexpose"}},[t._v("#")]),t._v(" defineExpose")]),t._v(" "),a("p",[t._v("导出会自动"),a("code",[t._v("unwrapped")]),t._v(",这个函数时通过"),a("code",[t._v("setup")]),t._v("上下文提供的，不是通过全局api，所以他不能在外部组合函数中导入")]),t._v(" "),a("h3",{attrs:{id:"effectscope"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#effectscope"}},[t._v("#")]),t._v(" effectScope")]),t._v(" "),a("p",[t._v("一个新的API用于自动收集副作用，计划在"),a("code",[t._v("3.2")]),t._v("中引入")]),t._v(" "),a("h3",{attrs:{id:"provide-inject"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#provide-inject"}},[t._v("#")]),t._v(" Provide/Inject")]),t._v(" "),a("p",[t._v("当provide传递一个对象时，如果对象值没变，即使重复赋值，inject获取的值也不会变化")]),t._v(" "),a("h3",{attrs:{id:"getcurrentinstance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getcurrentinstance"}},[t._v("#")]),t._v(" getCurrentInstance")]),t._v(" "),a("p",[t._v("getCurrentInstance返回的值大部分都不是响应性的。可以通过@vue/runtime-core/dist/runtime-core.d.ts文件查看哪些在属性在运行时被排除")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" declare "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ComponentInternalInstance")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    uid"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ConcreteComponent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    parent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ComponentInternalInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    root"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ComponentInternalInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    appContext"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" AppContext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Vnode representing this component in its parent's vdom tree\n     */")]),t._v("\n    vnode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: next */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Root vnode of this component's own vdom tree\n     */")]),t._v("\n    subTree"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Render effect instance\n     */")]),t._v("\n    effect"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ReactiveEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Bound effect runner to be passed to schedulers\n     */")]),t._v("\n    update"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" SchedulerJob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: render */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: ssrRender */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: provides */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: scope */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: accessCache */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: renderCache */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: components */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: directives */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: filters */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: propsOptions */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: emitsOptions */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: inheritAttrs */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * is custom element?\n     */")]),t._v("\n    isCE"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * custom element specific HMR method\n     */")]),t._v("\n    ceReload"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("newStyles"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ComponentPublicInstance "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    exposed"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Record"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    exposeProxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Record"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: withProxy */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: ctx */")]),t._v("\n    data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    attrs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    slots"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" InternalSlots"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    refs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    emit"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" EmitFn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: emitted */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: propsDefaults */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: setupState */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: devtoolsRawSetupState */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: setupContext */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: suspense */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: suspenseId */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: asyncDep */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: asyncResolved */")]),t._v("\n    isMounted"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    isUnmounted"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    isDeactivated"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: bc */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: c */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: bm */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: m */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: bu */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: u */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: bum */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: um */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: rtc */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: rtg */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: a */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: da */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: ec */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* Excluded from this release type: sp */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"生命周期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),a("p",[t._v("执行顺序：")]),t._v(" "),a("ol",[a("li",[t._v("onMounted")]),t._v(" "),a("li",[a("code",[t._v("onBeforeUnmount")])]),t._v(" "),a("li",[t._v("onScopeDispose,或者使用"),a("code",[t._v("scope?.cleanups?.push(_off)")])]),t._v(" "),a("li",[t._v("onUnmounted")])]),t._v(" "),a("h4",{attrs:{id:"onscopedispose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#onscopedispose"}},[t._v("#")]),t._v(" onScopeDispose")]),t._v(" "),a("p",[t._v("实现源码：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 注册stop scope时的回调\nexport function onScopeDispose(fn: () => void) {\n  if (activeEffectScope) {\n    activeEffectScope.cleanups.push(fn)\n  } else if (__DEV__) {\n    warn(\n      `onScopeDispose() is called when there is no active effect scope` +\n        ` to be associated with.`\n    )\n  }\n}\n")])])]),a("h2",{attrs:{id:"选项式api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#选项式api"}},[t._v("#")]),t._v(" 选项式API")]),t._v(" "),a("h3",{attrs:{id:"inheritattrs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#inheritattrs"}},[t._v("#")]),t._v(" inheritAttrs")]),t._v(" "),a("p",[t._v("设置false防止组件直接绑定到顶级元素")]),t._v(" "),a("h2",{attrs:{id:"单文件组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#单文件组件"}},[t._v("#")]),t._v(" 单文件组件")]),t._v(" "),a("h3",{attrs:{id:"script-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#script-setup"}},[t._v("#")]),t._v(" "),a("code",[t._v("<script setup>")])]),t._v(" "),a("h4",{attrs:{id:"全局变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局变量"}},[t._v("#")]),t._v(" 全局变量")]),t._v(" "),a("ol",[a("li",[t._v("$ref：v3.2目前仅支持不在函数或者其他块级作用域中的"),a("code",[t._v("ref")]),t._v("语法糖")]),t._v(" "),a("li",[t._v("$computed")]),t._v(" "),a("li",[t._v("$fromRefs")]),t._v(" "),a("li",[t._v("$raw")])]),t._v(" "),a("h3",{attrs:{id:"css-特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-特性"}},[t._v("#")]),t._v(" CSS 特性")]),t._v(" "),a("h4",{attrs:{id:"v-bind-in-css"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#v-bind-in-css"}},[t._v("#")]),t._v(" v-bind in css")]),t._v(" "),a("p",[t._v("可以支持将响应性变量绑定到css中，使用content时需要加双引号")]),t._v(" "),a("h2",{attrs:{id:"渲染函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染函数"}},[t._v("#")]),t._v(" 渲染函数")]),t._v(" "),a("h2",{attrs:{id:"typescript"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#typescript"}},[t._v("#")]),t._v(" TypeScript")]),t._v(" "),a("h3",{attrs:{id:"volar"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#volar"}},[t._v("#")]),t._v(" volar")]),t._v(" "),a("p",[t._v("设置接管模式可以防止性能损耗，因为volar自己维护一个ts服务，而编辑器对于ts文件使用自己的ts服务。")]),t._v(" "),a("p",[t._v("禁用当前项目的ts语法服务有助于加速编辑器速度：")]),t._v(" "),a("ol",[a("li",[t._v("在插件中搜索"),a("code",[t._v("@builtin typescript")]),t._v("，禁用"),a("code",[t._v("Typescript and JavaScript Language Features")])]),t._v(" "),a("li",[t._v("重新加载窗口")])]),t._v(" "),a("h3",{attrs:{id:"ref-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ref-2"}},[t._v("#")]),t._v(" ref")]),t._v(" "),a("p",[t._v("ref子组件的类型提示：")]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MyModal "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./MyModal.vue'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" modal "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token generic-function"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token generic class-name"}},[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("InstanceType"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),t._v(" MyModal"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h3",{attrs:{id:"定义props类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#定义props类型"}},[t._v("#")]),t._v(" 定义props类型")]),t._v(" "),a("ol",[a("li",[t._v("defineProps和defineEmits可以使用运行时声明或者类型声明，但是不能两者同时使用")]),t._v(" "),a("li",[t._v("使用类型声明的时候有个限制，不能使用通过import导入的类型变量")]),t._v(" "),a("li",[t._v("默认props值，可以使用"),a("code",[t._v("withDefaults")])])]),t._v(" "),a("div",{staticClass:"language-ts extra-class"},[a("pre",{pre:!0,attrs:{class:"language-ts"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" props "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  selected"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  supports"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Array")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Create'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Redeem'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Create'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[t._v("注意: 无法toRefs()中嵌套withDefaults使用")]),t._v(" "),a("h3",{attrs:{id:"封装第三方ui库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#封装第三方ui库"}},[t._v("#")]),t._v(" 封装第三方UI库")]),t._v(" "),a("p",[t._v("为了保留第三方UI原本的props和event,通过import继承并扩展：")]),t._v(" "),a("div",{staticClass:"language-jsx extra-class"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n  ")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("el-input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("elRef"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("el-input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("\n")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("setup")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v('\nimport { inputProps } from "element-plus";\n  \nconst props = defineProps({\n  ...inputProps,\n  testLabel: String, // 自定义扩展\n});\nconst emits = defineEmits({\n  ...inputEmits,\n  "prefix-click": (v: number) => true, \n  // 事件返回应该为真值,否则devtool会提示Invalid event arguments: event validation failed for event "prefix-click".\n});  \n')]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h2",{attrs:{id:"最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),a("h3",{attrs:{id:"快速查看template被转换之后的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#快速查看template被转换之后的代码"}},[t._v("#")]),t._v(" 快速查看template被转换之后的代码？")]),t._v(" "),a("p",[t._v("可以通过"),a("a",{attrs:{href:"https://vue-next-template-explorer.netlify.app/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue3-template-explorer"),a("OutboundLink")],1),t._v("进行快速查看")]),t._v(" "),a("h3",{attrs:{id:"代码重构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码重构"}},[t._v("#")]),t._v(" 代码重构")]),t._v(" "),a("p",[t._v("尽量把业务逻辑相关代码写在一起，而不是方法都写在一起，变量都写在一起。这样后期的代码重构更便利，")]),t._v(" "),a("h3",{attrs:{id:"防止重新渲染"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防止重新渲染"}},[t._v("#")]),t._v(" 防止重新渲染")]),t._v(" "),a("p",[t._v("vue3 的tempalte自动为内联函数缓存了，不需要手动优化")]),t._v(" "),a("h3",{attrs:{id:"ref和reactive的使用选择"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ref和reactive的使用选择"}},[t._v("#")]),t._v(" ref和reactive的使用选择")]),t._v(" "),a("p",[t._v("更推荐使用ref：")]),t._v(" "),a("ol",[a("li",[t._v("因为单独的数据更容易进行逻辑的拆分")]),t._v(" "),a("li",[t._v("显示调用，类型检查")]),t._v(" "),a("li",[t._v("不存在reactive的种种限制：使用es6解会导致响应式丢失，需要使用箭头函数包装才能使用"),a("code",[t._v("watch")])]),t._v(" "),a("li",[t._v("即使使用对象也可以通过一个普通对象包裹属性值为ref，这样解构不会引用丢失，而且当想要使用自动解包时，也可以直接通过"),a("code",[t._v("reactive")]),t._v("包裹,产生保持引用的对象")])]),t._v(" "),a("h3",{attrs:{id:"组合式api-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组合式api-2"}},[t._v("#")]),t._v(" 组合式api")]),t._v(" "),a("p",[t._v("当使用合成 API 显式创建响应式对象时，最佳做法是不要保留对原始对象的引用，而只使用响应式版本")]),t._v(" "),a("h3",{attrs:{id:"如何修改响应性provide的值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何修改响应性provide的值"}},[t._v("#")]),t._v(" 如何修改响应性provide的值？")]),t._v(" "),a("p",[t._v("建议尽可能，在提供者内保持响应式 property 的任何更改。提供者提供一个修改方法传递到子孙组件。")]),t._v(" "),a("h3",{attrs:{id:"当前作用域或者组件保存为唯一key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#当前作用域或者组件保存为唯一key"}},[t._v("#")]),t._v(" 当前作用域或者组件保存为唯一key?")]),t._v(" "),a("p",[t._v("通常做法是使用"),a("code",[t._v("map")]),t._v("或者"),a("code",[t._v("weakmap")]),t._v("， key值可以为"),a("code",[t._v("getCurrentInstance")]),t._v(",但是我发现"),a("code",[t._v("getCurrentScope")]),t._v("所占内存更小，但不确定是唯一值")]),t._v(" "),a("h3",{attrs:{id:"封装第三方ui组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#封装第三方ui组件"}},[t._v("#")]),t._v(" 封装第三方UI组件")]),t._v(" "),a("p",[t._v("代理UI组件的属性、事件、slot")]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("el-input")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("elRef"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-bind")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("{ ...$attrs, ...props }"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-on")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("$listeners"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("b-input"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("v-for")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("name in Object.keys($slots)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("#[name]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("slot")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("slot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("el-input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" props "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProps")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  size"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mini'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 父组件通过ref.value.elRef.xxx调用element-ui组件方法")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" elRef"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  inheritAttrs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("style")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("less"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("scoped")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token style"}},[a("span",{pre:!0,attrs:{class:"token language-css"}},[t._v("\n"),a("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".b-input")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("style")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),a("h2",{attrs:{id:"性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/150732926",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue3 Compiler 优化细节，如何手写高性能渲染函数"),a("OutboundLink")],1)])]),t._v(" "),a("h2",{attrs:{id:"ui"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ui"}},[t._v("#")]),t._v(" UI")]),t._v(" "),a("ol",[a("li",[t._v("pc端：element-plus")]),t._v(" "),a("li",[t._v("移动端：vant、ionic vue、varlet")])]),t._v(" "),a("h2",{attrs:{id:"迁移指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#迁移指南"}},[t._v("#")]),t._v(" 迁移指南")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("vue3兼容vue2运行时，需要使用"),a("code",[t._v("@vue/compat")]),t._v("包，  该包会从"),a("code",[t._v("Vue v3.1")]),t._v("版本开始推出，同步维护到"),a("code",[t._v("v3.2")]),t._v("。如果是"),a("code",[t._v("nuxt")]),t._v("项目最好还是等"),a("code",[t._v("nuxt3")]),t._v("。")]),t._v(" "),a("ol",[a("li",[t._v("可以全局设置"),a("code",[t._v("configureCompat")]),t._v("兼容性配置，也可以为组件单独添加"),a("code",[t._v("compatConfig")])])])]),t._v(" "),a("li",[a("p",[t._v("vue2项目想体验vue3语法可以使用"),a("code",[t._v("@vue/composition-api")]),t._v(",不过有一些"),a("a",{attrs:{href:"https://github.com/vuejs/composition-api/blob/master/README.zh-CN.md#%E9%99%90%E5%88%B6",target:"_blank",rel:"noopener noreferrer"}},[t._v("限制"),a("OutboundLink")],1),t._v(","),a("code",[t._v("<scriptsetup>")]),t._v("需要安装"),a("code",[t._v("unplugin-vue2-script-setup")]),t._v("这个"),a("a",{attrs:{href:"https://github.com/antfu/unplugin-vue2-script-setup",target:"_blank",rel:"noopener noreferrer"}},[t._v("插件"),a("OutboundLink")],1)]),t._v(" "),a("ol",[a("li",[t._v("readonly没有实际效果，只是提供类型，可以被"),a("code",[t._v("isReadonly")]),t._v("检测。")])])]),t._v(" "),a("li",[a("p",[t._v("vue2转换成vue3代码，使用"),a("code",[t._v("gogocode-plugin-vue")]),t._v("：https://juejin.cn/post/6977259197566517284?share_token=cafe7b9c-6292-4b25-91c4-6bf6f7903fff")])]),t._v(" "),a("li",[a("p",[t._v("想要更稳定的迁移，可以等待"),a("code",[t._v("vue v2.7")]),t._v(",该版本会包含"),a("code",[t._v("@vue/composition-api")]),t._v("和"),a("code",[t._v("<script setup>")]),t._v("等一些其他的vue3的api和特性。（计划在2021的Q3末发布）")])]),t._v(" "),a("li",[a("p",[t._v("nuxt项目需要使用"),a("a",{attrs:{href:"https://composition-api.nuxtjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("@nuxtjs/composition-api 插件"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("使用vueuse包来减少重复的轮子，兼容vue2和vue3")])]),t._v(" "),a("li",[a("p",[t._v("库作者可以通过"),a("code",[t._v("vue-demi")]),t._v("使用同样的语法在"),a("code",[t._v("vue2和vue3")]),t._v("进行开发。")])]),t._v(" "),a("li",[a("p",[t._v("eslint添加vue3支持,eslint规则应该在prettier上边：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("extends: [\n    'plugin:vue/vue3-recommended',\n ],\n")])])])]),t._v(" "),a("li",[a("p",[t._v("插件使用"),a("code",[t._v("volar,")]),t._v("如果需要支持vue2，那么需要安装"),a("code",[t._v("@vue/runtime-dom")])])]),t._v(" "),a("li",[a("p",[t._v("Vue.prototype替换为app.config.globalProperties")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("::v-deep")]),t._v("修改为"),a("code",[t._v(":deep(.class)")])])]),t._v(" "),a("li",[a("p",[t._v("class和style现在属于"),a("code",[t._v("$attrs")]),t._v(",如果使用时有定义，则会和组件中的class和style合并")])]),t._v(" "),a("li",[a("p",[t._v("更多内容参考官网：https://v3.cn.vuejs.org/guide/migration/migration-build.html")])])]),t._v(" "),a("h2",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),a("h3",{attrs:{id:"如何处理ssr组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何处理ssr组件"}},[t._v("#")]),t._v(" 如何处理ssr组件？")]),t._v(" "),a("ol",[a("li",[t._v("使用"),a("code",[t._v("生命周期函数")]),t._v("可以跳过ssr阶段，目前nuxt3是这样的，不确定其他框架是否如此，查看"),a("a",{attrs:{href:"https://github.com/element-plus/element-plus/pull/6656",target:"_blank",rel:"noopener noreferrer"}},[t._v("element-plus"),a("OutboundLink")],1),t._v("在"),a("code",[t._v("onMounted")]),t._v("中同样加入了isClient判断")]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v("isClient")]),t._v("判断拦截，实现"),a("code",[t._v("const isClient=typeof window === 'undefined'")]),t._v(", (element-plus和vant都使用该方法)")]),t._v(" "),a("li",[t._v("检查组件元素"),a("code",[t._v("Element")]),t._v("是否存在")])]),t._v(" "),a("h3",{attrs:{id:"hook可以被treeshaking吗"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hook可以被treeshaking吗"}},[t._v("#")]),t._v(" hook可以被treeshaking吗？")]),t._v(" "),a("p",[t._v("首先treeshaking是针对import/export来实现的，而且export default 导出的模块，被导入时，即使没有使用，其上边的变量和方法不会被删除掉。")]),t._v(" "),a("p",[t._v("再者，hook其实是减少了代码量，只是会被多次使用，不合理的使用会导致运行时的消耗变多")]),t._v(" "),a("h3",{attrs:{id:"getcurrentinstance注意事项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getcurrentinstance注意事项"}},[t._v("#")]),t._v(" getCurrentInstance注意事项？")]),t._v(" "),a("p",[t._v("返回值中只有"),a("code",[t._v("proxy")]),t._v("会在打包时生成，可以使用"),a("code",[t._v("proxy.$parent")]),t._v("这种内部属性")]),t._v(" "),a("h3",{attrs:{id:"如何区分什么应该放进hook-什么应该放进utils"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何区分什么应该放进hook-什么应该放进utils"}},[t._v("#")]),t._v(" 如何区分什么应该放进hook，什么应该放进"),a("code",[t._v("utils")]),t._v("？")]),t._v(" "),a("p",[t._v("个人认为"),a("code",[t._v("hook")]),t._v("中存放的应当是业务耦合的，或者带有副作用的。而"),a("code",[t._v("utils")]),t._v("应该框架无关的，是无业务逻辑的")]),t._v(" "),a("h3",{attrs:{id:"vue3为什么放弃class-api而转向composition-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue3为什么放弃class-api而转向composition-api"}},[t._v("#")]),t._v(" vue3为什么放弃class api而转向composition api？")]),t._v(" "),a("ol",[a("li",[t._v("对typescript更加友好，typescript对函数的参数和返回值都非常好，写Function-based API既是javascript又是typescript，不需要任何的类型声明，typescript可以自己做类型推导。")]),t._v(" "),a("li",[t._v("静态的import和export是treeshaking的前提，Function-based API中的方法都是从全局的vue中import进来的。")]),t._v(" "),a("li",[t._v("函数内部的变量名和函数名都可以被压缩为单个字母，但是对象和类的属性和方法名默认不被压缩（为了防止引用出错）。")]),t._v(" "),a("li",[t._v("更灵活的逻辑复用。")])]),t._v(" "),a("h3",{attrs:{id:"render函数的使用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#render函数的使用场景"}},[t._v("#")]),t._v(" render函数的使用场景？")]),t._v(" "),a("p",[t._v("通常为可重用的组件")]),t._v(" "),a("h3",{attrs:{id:"watch和watcheffect的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#watch和watcheffect的区别"}},[t._v("#")]),t._v(" watch和watchEffect的区别？")]),t._v(" "),a("p",[t._v("watchEffect会自动收集依赖。")]),t._v(" "),a("p",[t._v("watch：不会一开始就调用监听函数，可以查看旧值。可以监控回调函数中用不到的值。")]),t._v(" "),a("h3",{attrs:{id:"如何使用动态组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何使用动态组件"}},[t._v("#")]),t._v(" 如何使用动态组件？")]),t._v(" "),a("p",[a("code",[t._v('<component :is="bar"></component>')])]),t._v(" "),a("h3",{attrs:{id:"全局变量如何处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局变量如何处理"}},[t._v("#")]),t._v(" 全局变量如何处理?")]),t._v(" "),a("p",[t._v("参考"),a("a",{attrs:{href:"https://blog.csdn.net/qq_40185480/article/details/110926273",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue3中使用element-plus调用message"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("有4种方法：")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("app.config.globalProperties 添加全局方法 $message后，就可以在option api中使用this调用")])]),t._v(" "),a("li",[a("p",[t._v("composition api中需要获取组件实例后调用")])]),t._v(" "),a("li",[a("p",[t._v("provide/inject")])]),t._v(" "),a("li",[a("p",[t._v("不使用全局变量而是按需导入")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("ElMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'element-ui'")]),t._v("\nElMessage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),a("h3",{attrs:{id:"关于defineexpose和ref-value-proxy的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关于defineexpose和ref-value-proxy的区别"}},[t._v("#")]),t._v(" 关于defineExpose和"),a("code",[t._v("ref.value.$.proxy")]),t._v("的区别？")]),t._v(" "),a("p",[a("code",[t._v("definedExpose")]),t._v("只能用于获取组件公开开放的变量，使用方法："),a("code",[t._v("ref.value.xxx")]),t._v(",并且提供"),a("code",[t._v("TS")]),t._v("的类型提示。")]),t._v(" "),a("p",[a("code",[t._v("ref.value.$.proxy")]),t._v("可以获取组价内所有变量，但是没有ts类型提示")]),t._v(" "),a("p",[t._v("通过这两种方式获取的数据都会自动"),a("code",[t._v("unwrapped")])]),t._v(" "),a("h3",{attrs:{id:"如何获取当前组件的ref"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何获取当前组件的ref"}},[t._v("#")]),t._v(" 如何获取当前组件的"),a("code",[t._v("ref")]),t._v("?")]),t._v(" "),a("p",[a("code",[t._v("getCurrentInstance().proxy.$.vnode.ref.r")])]),t._v(" "),a("h3",{attrs:{id:"组件的实例和其在父组件的ref是什么结构关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#组件的实例和其在父组件的ref是什么结构关系"}},[t._v("#")]),t._v(" 组件的实例和其在父组件的ref是什么结构关系？")]),t._v(" "),a("p",[t._v("父组件获取的"),a("code",[t._v("ref")]),t._v("值的"),a("code",[t._v(".value.$")]),t._v("等于子组件中的"),a("code",[t._v("getCurrentInstance()")])]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://juejin.cn/post/6910009240053055496",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue3丨从 5 个维度来讲 Vue3 变化"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.bilibili.com/video/BV1rC4y187Vw?p=1",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue 3 Deep Dive with Evan You "),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);