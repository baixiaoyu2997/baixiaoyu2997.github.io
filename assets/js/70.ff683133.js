(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{501:function(t,a,s){"use strict";s.r(a);var e=s(2),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),s("p",[t._v("为什么引入组合式API？")]),t._v(" "),s("h3",{attrs:{id:"对象式api存在的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对象式api存在的问题"}},[t._v("#")]),t._v(" 对象式API存在的问题")]),t._v(" "),s("ol",[s("li",[t._v("不利于复用")]),t._v(" "),s("li",[t._v("潜在命名冲突")]),t._v(" "),s("li",[t._v("上下文丢失")]),t._v(" "),s("li",[t._v("有限的类型支持")]),t._v(" "),s("li",[t._v("按APi类型组织")])]),t._v(" "),s("h3",{attrs:{id:"做合适api提供的能力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#做合适api提供的能力"}},[t._v("#")]),t._v(" 做合适API提供的能力")]),t._v(" "),s("ol",[s("li",[t._v("极易复用")]),t._v(" "),s("li",[t._v("可灵活组合（生命周期钩子可多次使用）")]),t._v(" "),s("li",[t._v("提供更好的上下文支持")]),t._v(" "),s("li",[t._v("更好的TS支持")]),t._v(" "),s("li",[t._v("按功能/逻辑组织")])]),t._v(" "),s("h2",{attrs:{id:"目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[t._v("#")]),t._v(" 目录结构")]),t._v(" "),s("p",[t._v("参考：https://v3.cn.vuejs.org/api/options-data.html#props")]),t._v(" "),s("h2",{attrs:{id:"全局api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局api"}},[t._v("#")]),t._v(" 全局API")]),t._v(" "),s("h2",{attrs:{id:"createapp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#createapp"}},[t._v("#")]),t._v(" createApp")]),t._v(" "),s("p",[t._v("当创建实例的时候如果没有"),s("code",[t._v("template")]),t._v("，并且挂载元素不为空时，会使用挂载元素中的节点作为"),s("code",[t._v("tempalte")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"h"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#h"}},[t._v("#")]),t._v(" h")]),t._v(" "),s("p",[t._v("hyperscript返回一个”虚拟节点“，通常缩写为 "),s("strong",[t._v("VNode")]),t._v("：一个普通对象，其中包含向 Vue 描述它应在页面上渲染哪种节点的信息，包括所有子节点的描述。它的目的是用于手动编写的"),s("a",{attrs:{href:"https://v3.cn.vuejs.org/guide/render-function.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("渲染函数"),s("OutboundLink")],1),t._v("：")]),t._v(" "),s("h2",{attrs:{id:"选项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#选项"}},[t._v("#")]),t._v(" 选项")]),t._v(" "),s("h3",{attrs:{id:"data"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#data"}},[t._v("#")]),t._v(" Data")]),t._v(" "),s("h4",{attrs:{id:"props"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#props"}},[t._v("#")]),t._v(" props")]),t._v(" "),s("p",[t._v("props 无需通过 setup 函数 return，也可以在 template 进行绑定对应的值")]),t._v(" "),s("h4",{attrs:{id:"emits"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#emits"}},[t._v("#")]),t._v(" emits")]),t._v(" "),s("p",[t._v("组件事件现在可以在emits中声明（非强制），支持数组或者对象语法，对象语法中，值可以验证函数。")]),t._v(" "),s("h3",{attrs:{id:"dom"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dom"}},[t._v("#")]),t._v(" DOM")]),t._v(" "),s("h4",{attrs:{id:"render"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#render"}},[t._v("#")]),t._v(" render")]),t._v(" "),s("p",[t._v("大多数情况下应该使用"),s("code",[t._v("template")]),t._v("，遇到使用tempalte编写比js编写更复杂的时候应该使用render函数来渲染。")]),t._v(" "),s("h2",{attrs:{id:"指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指令"}},[t._v("#")]),t._v(" 指令")]),t._v(" "),s("h3",{attrs:{id:"v-model"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#v-model"}},[t._v("#")]),t._v(" v-model")]),t._v(" "),s("p",[t._v("可以使用在"),s("code",[t._v("input、select、textarea和components")]),t._v("上。")]),t._v(" "),s("p",[t._v("当被使用在组件上时，等价于：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("custom-input")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":model-value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("searchText"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("@update:")]),t._v("model-value")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("searchText = $event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("custom-input")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),s("h2",{attrs:{id:"响应性api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#响应性api"}},[t._v("#")]),t._v(" 响应性API")]),t._v(" "),s("h3",{attrs:{id:"响应性基础api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#响应性基础api"}},[t._v("#")]),t._v(" 响应性基础API")]),t._v(" "),s("h3",{attrs:{id:"reactive"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reactive"}},[t._v("#")]),t._v(" reactive")]),t._v(" "),s("p",[t._v("返回对象的响应式副本，响应式转换是深度的，影响所有嵌套属性")]),t._v(" "),s("h4",{attrs:{id:"torow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#torow"}},[t._v("#")]),t._v(" toRow")]),t._v(" "),s("p",[t._v("返回 "),s("a",{attrs:{href:"https://v3.cn.vuejs.org/api/basic-reactivity.html#reactive",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("reactive")]),s("OutboundLink")],1),t._v(" 或 "),s("a",{attrs:{href:"https://v3.cn.vuejs.org/api/basic-reactivity.html#readonly",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("readonly")]),s("OutboundLink")],1),t._v(" proxy 的原始对象。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" reactiveFoo "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toRaw")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("reactiveFoo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n")])])]),s("h4",{attrs:{id:"isproxy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#isproxy"}},[t._v("#")]),t._v(" isProxy")]),t._v(" "),s("p",[t._v("用于判断数据是否有"),s("code",[t._v("reactive")]),t._v("或"),s("code",[t._v("readonly")]),t._v("获取")]),t._v(" "),s("h4",{attrs:{id:"isreative"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#isreative"}},[t._v("#")]),t._v(" isReative")]),t._v(" "),s("p",[t._v("用于判断数据是否有"),s("code",[t._v("reactive")]),t._v("创建的")]),t._v(" "),s("h4",{attrs:{id:"isreadonly"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#isreadonly"}},[t._v("#")]),t._v(" isReadonly")]),t._v(" "),s("p",[t._v("用于判断数据是否由"),s("code",[t._v("readonly")]),t._v("创建")]),t._v(" "),s("h3",{attrs:{id:"refs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#refs"}},[t._v("#")]),t._v(" Refs")]),t._v(" "),s("h4",{attrs:{id:"ref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ref"}},[t._v("#")]),t._v(" ref")]),t._v(" "),s("p",[t._v("ref 和 reactive 的存在都是了追踪值变化（响应式），ref 有个「包装」的概念，它用来包装原始值类型，如 string 和 number ，我们都知道不是引用类型是无法追踪后续的变化的。ref 返回的是一个包含 "),s("code",[t._v(".value")]),t._v(" 属性的对象。")]),t._v(" "),s("p",[t._v("如果将一个"),s("code",[t._v("ref")]),t._v("传递给"),s("code",[t._v("ref()")]),t._v("，它将原样将其返回。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v("bar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isRef")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 所以上面的判断也可以简写下边这样")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" bar"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ref值的修改：ref值的修改应该是在"),s("code",[t._v("xxx.value")]),t._v("上进行，如果对返回的ref对象进行修改，则会因为被覆盖导致响应性丢失。")]),t._v(" "),s("p",[t._v("当ref被包裹在响应式"),s("code",[t._v("Object")]),t._v("中时，会自动展开，不需要写"),s("code",[t._v(".value")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  count\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 0")]),t._v("\n\nstate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1")]),t._v("\n\n")])])]),s("p",[s("code",[t._v("watch")]),t._v("函数监听"),s("code",[t._v("ref")]),t._v("时，返回值会自动解包：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" counter"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("counter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("count"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 已经解包的值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("ref还可以创建对元素的引用,与"),s("code",[t._v("react")]),t._v("类似：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("div元素"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" ref"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" onMounted "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建一个DOM引用，名称必须与元素的ref属性名相同")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" el "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在挂载后才能通过 el 获取到目标元素")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("onMounted")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'内容被修改'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 把创建的引用 return 出去")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("el"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("有些情况可以使用ref也可以使用toRef，具体的区别是：")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("ref")]),t._v("是对传入数据的拷贝；"),s("code",[t._v("toRef")]),t._v("是对传入数据的引用")]),t._v(" "),s("li",[s("code",[t._v("ref")]),t._v("的值改变会更新视图；"),s("code",[t._v("toRef")]),t._v("的值改变不会更新视图")])]),t._v(" "),s("h4",{attrs:{id:"isref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#isref"}},[t._v("#")]),t._v(" isRef")]),t._v(" "),s("p",[t._v("用于判断数据是否是"),s("code",[t._v("ref")]),t._v("对象")]),t._v(" "),s("h4",{attrs:{id:"unref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unref"}},[t._v("#")]),t._v(" unref")]),t._v(" "),s("p",[t._v("如果参数为ref，返回"),s("code",[t._v(".value")]),t._v("，否则返回参数本身。相当于"),s("code",[t._v("val = isRef(val) ? val.value : val")]),t._v(".")]),t._v(" "),s("p",[t._v("使用场景：unref可以用作在不确定参数类型的工具函数中使用。")]),t._v(" "),s("h4",{attrs:{id:"torefs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#torefs"}},[t._v("#")]),t._v(" toRefs")]),t._v(" "),s("p",[t._v("将响应式对象转换为普通对象，其中结果对象的每个 property 都是指向原始对象相应 property 的"),s("code",[t._v("ref")]),t._v("。保持响应式对象中属性的引用，可以理解这一切都是因为我们要用解构，"),s("code",[t._v("toRefs")]),t._v(" 所采取的解决方案。")]),t._v(" "),s("h4",{attrs:{id:"shallowref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#shallowref"}},[t._v("#")]),t._v(" shallowRef")]),t._v(" "),s("p",[t._v("因为ref是"),s("code",[t._v("深proxy")]),t._v("，"),s("code",[t._v("shallowRef")]),t._v("只做"),s("code",[t._v("浅proxy")]),t._v(" ，可以用来做优化")]),t._v(" "),s("h4",{attrs:{id:"triggerref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#triggerref"}},[t._v("#")]),t._v(" triggerRef")]),t._v(" "),s("p",[s("code",[t._v("shallowRef")]),t._v("中没有被监听的数据改变时，不会触发视图更新，这个时候可以使用"),s("code",[t._v("triggerRef")]),t._v("来立刻更新视图")]),t._v(" "),s("h3",{attrs:{id:"computed与watch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#computed与watch"}},[t._v("#")]),t._v(" Computed与Watch")]),t._v(" "),s("h4",{attrs:{id:"computed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#computed"}},[t._v("#")]),t._v(" computed")]),t._v(" "),s("p",[t._v("接收getter函数或者"),s("code",[t._v("get、set")]),t._v("对象为参数，返回"),s("code",[t._v("ref")]),t._v("对象。当使用getter函数为参数时，返回的是一个"),s("code",[t._v("readonly ref")])]),t._v(" "),s("h4",{attrs:{id:"watcheffect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watcheffect"}},[t._v("#")]),t._v(" watchEffect")]),t._v(" "),s("p",[t._v("与watch的区别，watch是惰性出发的，而watchEffect会在声明时就触发。因为需要预先收集依赖关系，所以不能为惰性触发。")]),t._v(" "),s("p",[t._v("当watchEffect函数中包含响应性数据的get方法，就会进行收集依赖。")]),t._v(" "),s("p",[t._v("如果想要获取"),s("code",[t._v("oldValue")]),t._v(",那么应该使用"),s("code",[t._v("watch")])]),t._v(" "),s("p",[s("code",[t._v("onTrack和onTrigger")]),t._v("会在每次值变更时触发，初始化时只会触发"),s("code",[t._v("onTrack")])]),t._v(" "),s("h4",{attrs:{id:"watch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watch"}},[t._v("#")]),t._v(" watch")]),t._v(" "),s("p",[s("code",[t._v("watch")]),t._v(" api监听的数据源可以是返回值的 getter 函数，也可以是"),s("code",[t._v("ref")]),t._v("数组,也可以直接是 "),s("code",[t._v("ref")]),t._v("，这点与"),s("code",[t._v("watchEffect")]),t._v("不同，"),s("code",[t._v("watchEffect")]),t._v("不能直接监听ref，"),s("code",[t._v("watch")]),t._v("如果监听的是"),s("code",[t._v("ref")]),t._v(",那么回调函数返回的值则是解包后的值。")]),t._v(" "),s("h2",{attrs:{id:"组合式api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合式api"}},[t._v("#")]),t._v(" 组合式API")]),t._v(" "),s("h3",{attrs:{id:"setup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" setup")]),t._v(" "),s("p",[t._v("setup函数的执行顺序要早于"),s("code",[t._v("beforeCreate")]),t._v(",并且vue3为了区分options api，特意让setup中不能调用"),s("code",[t._v("this")]),t._v("，"),s("code",[t._v("this")]),t._v("的值为"),s("code",[t._v("undefined")])]),t._v(" "),s("p",[t._v("setup可以返回两种类型：")]),t._v(" "),s("ol",[s("li",[t._v("object类型，用来配合模版使用，")]),t._v(" "),s("li",[t._v("function类型，为渲染函数")])]),t._v(" "),s("h3",{attrs:{id:"effectscope"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#effectscope"}},[t._v("#")]),t._v(" effectScope")]),t._v(" "),s("p",[t._v("一个新的API用于自动收集副作用，计划在"),s("code",[t._v("3.2")]),t._v("中引入")]),t._v(" "),s("h3",{attrs:{id:"provide-inject"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#provide-inject"}},[t._v("#")]),t._v(" Provide/Inject")]),t._v(" "),s("p",[t._v("当provide传递一个对象时，如果对象值没变，即使重复赋值，inject获取的值也不会变化")]),t._v(" "),s("h2",{attrs:{id:"最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[t._v("#")]),t._v(" 最佳实践")]),t._v(" "),s("h3",{attrs:{id:"快速查看template被转换之后的代码"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速查看template被转换之后的代码"}},[t._v("#")]),t._v(" 快速查看template被转换之后的代码？")]),t._v(" "),s("p",[t._v("可以通过"),s("a",{attrs:{href:"https://vue-next-template-explorer.netlify.app/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue3-template-explorer"),s("OutboundLink")],1),t._v("进行快速查看")]),t._v(" "),s("h3",{attrs:{id:"代码重构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#代码重构"}},[t._v("#")]),t._v(" 代码重构")]),t._v(" "),s("p",[t._v("尽量把业务逻辑相关代码写在一起，而不是方法都写在一起，变量都写在一起。这样后期的代码重构更便利，")]),t._v(" "),s("h3",{attrs:{id:"防止重新渲染"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#防止重新渲染"}},[t._v("#")]),t._v(" 防止重新渲染")]),t._v(" "),s("p",[t._v("vue3 的tempalte自动为内联函数缓存了，不需要手动优化")]),t._v(" "),s("h3",{attrs:{id:"ref和reactive的使用选择"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ref和reactive的使用选择"}},[t._v("#")]),t._v(" ref和reactive的使用选择")]),t._v(" "),s("p",[t._v("更推荐使用ref：")]),t._v(" "),s("ol",[s("li",[t._v("因为单独的数据更容易进行逻辑的拆分")]),t._v(" "),s("li",[t._v("显示调用，类型检查")]),t._v(" "),s("li",[t._v("不存在reactive的种种限制：使用es6结构会导致响应式丢失，需要使用箭头函数包装才能使用"),s("code",[t._v("watch")])])]),t._v(" "),s("h3",{attrs:{id:"组合式api-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合式api-2"}},[t._v("#")]),t._v(" 组合式api")]),t._v(" "),s("p",[t._v("当使用合成 API 显式创建响应式对象时，最佳做法是不要保留对原始对象的引用，而只使用响应式版本")]),t._v(" "),s("h3",{attrs:{id:"如何修改响应性provide的值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何修改响应性provide的值"}},[t._v("#")]),t._v(" 如何修改响应性provide的值？")]),t._v(" "),s("p",[t._v("建议尽可能，在提供者内保持响应式 property 的任何更改。提供者提供一个修改方法传递到子孙组件。")]),t._v(" "),s("h2",{attrs:{id:"性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/150732926",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue3 Compiler 优化细节，如何手写高性能渲染函数"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"迁移指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#迁移指南"}},[t._v("#")]),t._v(" 迁移指南")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("vue3兼容vue2运行时，需要使用"),s("code",[t._v("@vue/compat")]),t._v("包，  该包会从"),s("code",[t._v("Vue v3.1")]),t._v("版本开始推出，同步维护到"),s("code",[t._v("v3.2")]),t._v("。如果是"),s("code",[t._v("nuxt")]),t._v("项目最好还是等"),s("code",[t._v("nuxt3")]),t._v("。")]),t._v(" "),s("ol",[s("li",[t._v("可以全局设置"),s("code",[t._v("configureCompat")]),t._v("兼容性配置，也可以为组件单独添加"),s("code",[t._v("compatConfig")])])])]),t._v(" "),s("li",[s("p",[t._v("vue2项目想体验vue3语法可以使用"),s("code",[t._v("@vue/composition-api")]),t._v(",不过有一些"),s("a",{attrs:{href:"https://github.com/vuejs/composition-api/blob/master/README.zh-CN.md#%E9%99%90%E5%88%B6",target:"_blank",rel:"noopener noreferrer"}},[t._v("限制"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("vue2转换成vue3代码，使用"),s("code",[t._v("gogocode-plugin-vue")]),t._v("：https://juejin.cn/post/6977259197566517284?share_token=cafe7b9c-6292-4b25-91c4-6bf6f7903fff")])]),t._v(" "),s("li",[s("p",[t._v("想要更稳定的迁移，可以等待"),s("code",[t._v("vue v2.7")]),t._v(",该版本会包含"),s("code",[t._v("@vue/composition-api")]),t._v("和"),s("code",[t._v("<script setup>")]),t._v("等一些其他的vue3的api和特性。（计划在2021的Q3末发布）")])]),t._v(" "),s("li",[s("p",[t._v("nuxt项目需要使用"),s("a",{attrs:{href:"https://composition-api.nuxtjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("@nuxtjs/composition-api 插件"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("使用vueuse包来减少重复的轮子，兼容vue2和vue3")])]),t._v(" "),s("li",[s("p",[t._v("库作者可以通过"),s("code",[t._v("vue-demi")]),t._v("使用同样的语法在"),s("code",[t._v("vue2和vue3")]),t._v("进行开发。")])]),t._v(" "),s("li",[s("p",[t._v("eslint添加vue3支持：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("extends: [\n    'plugin:vue/vue3-recommended',\n ],\n")])])])]),t._v(" "),s("li",[s("p",[t._v("插件使用"),s("code",[t._v("volar")])])])]),t._v(" "),s("h2",{attrs:{id:"问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),s("h3",{attrs:{id:"render函数的使用场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#render函数的使用场景"}},[t._v("#")]),t._v(" render函数的使用场景？")]),t._v(" "),s("p",[t._v("通常为可重用的组件")]),t._v(" "),s("h3",{attrs:{id:"watch和watcheffect的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#watch和watcheffect的区别"}},[t._v("#")]),t._v(" watch和watchEffect的区别？")]),t._v(" "),s("p",[t._v("watchEffect会自动收集依赖。")]),t._v(" "),s("p",[t._v("watch：不会一开始就调用监听函数，可以查看旧值。可以监控回调函数中用不到的值。")]),t._v(" "),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://juejin.cn/post/6910009240053055496",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue3丨从 5 个维度来讲 Vue3 变化"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.bilibili.com/video/BV1rC4y187Vw?p=1",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue 3 Deep Dive with Evan You "),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);