(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{505:function(t,a,s){"use strict";s.r(a);var e=s(2),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),s("h3",{attrs:{id:"新增功能"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#新增功能"}},[t._v("#")]),t._v(" 新增功能")]),t._v(" "),s("ol",[s("li",[t._v("增量式更新（ISR）")]),t._v(" "),s("li",[s("code",[t._v("hybrid rendering")]),t._v("：为不同的路由提供不同的渲染模式 ，"),s("code",[t._v("client-side")]),t._v("或者"),s("code",[t._v("universal")])]),t._v(" "),s("li",[s("code",[t._v("edge-side rendering")])])]),t._v(" "),s("h3",{attrs:{id:"通用渲染"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通用渲染"}},[t._v("#")]),t._v(" 通用渲染")]),t._v(" "),s("p",[s("code",[t._v("Universal Rendering")]),t._v("，相当于是"),s("code",[t._v("client-side")]),t._v("和"),s("code",[t._v("server-side")]),t._v("的结合，在服务端直出页面的基础上，能保证浏览器后台处理js执行，来达到单页跳转效果，减少服务器调用。这一过程称为"),s("code",[t._v("Hydration")])]),t._v(" "),s("h3",{attrs:{id:"hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hooks"}},[t._v("#")]),t._v(" hooks")]),t._v(" "),s("p",[t._v("nuxt通过hook系统来提供强大的扩展能力，支持的hook包括：https://github.com/nuxt/framework/blob/a0c4d6e7e32f490d6f375340bffdc1d3b68a42eb/packages/schema/src/types/hooks.ts#L62")]),t._v(" "),s("p",[t._v("除了"),s("code",[t._v("nuxt hooks")]),t._v("还有"),s("a",{attrs:{href:"https://github.com/nuxt/framework/blob/a0c4d6e7e32f490d6f375340bffdc1d3b68a42eb/packages/nuxt3/src/app/nuxt.ts#L18",target:"_blank",rel:"noopener noreferrer"}},[t._v("runtime hooks"),s("OutboundLink")],1),t._v(":")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("app:created\tvueApp\tWhen initial vueApp instance is created\napp:beforeMount\tvueApp\tSame as app:created\napp:mounted\tvueApp\tWhen Vue app is initialized and mounted in browser\napp:rendered\t-\tWhen SSR rendering is done\napp:suspense:resolve\tappComponent\tOn Suspense resolved event\npage:start\tpageComponent\tOn Suspense pending event\npage:finish\tpageComponent\tOn Suspense resolved event\nmeta:register\tmetaRenderers\t(internal)\nvue:setup\t-\t(internal)\nvue:error\n")])])]),s("h3",{attrs:{id:"payload"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#payload"}},[t._v("#")]),t._v(" payload")]),t._v(" "),s("p",[t._v("服务端渲染在激活阶段会将数据传递给客户端，这部分的数据储存在"),s("code",[t._v("nuxtApp.payload.data")]),t._v("中")]),t._v(" "),s("h2",{attrs:{id:"数据获取"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据获取"}},[t._v("#")]),t._v(" 数据获取")]),t._v(" "),s("p",[t._v("nuxt中的数据获取都会默认缓存，只有在参数修改才会重新获取，或者手动使用"),s("code",[t._v("refresh")]),t._v("或者"),s("code",[t._v("refreshNuxtData")])]),t._v(" "),s("h3",{attrs:{id:"key"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#key"}},[t._v("#")]),t._v(" key")]),t._v(" "),s("p",[t._v("通过使用"),s("code",[t._v("key")]),t._v("来防止数据获取混乱，key被存放在nuxt实例的payload中，还在调用过程中的接口被存放在"),s("code",[t._v("nuxt._asyncDataPromises")])]),t._v(" "),s("h3",{attrs:{id:"useasyncdata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#useasyncdata"}},[t._v("#")]),t._v(" useAsyncData")]),t._v(" "),s("p",[t._v("支持页面、组件、plugin在服务器端获取异步数据：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useAsyncData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" Object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" lazy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" server"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("参数：")]),t._v(" "),s("ol",[s("li",[t._v("key：唯一key，确保获取正确的数据")]),t._v(" "),s("li",[t._v("fn: 返回一个异步函数的函数")]),t._v(" "),s("li",[t._v("options:\n"),s("ol",[s("li",[t._v("lazy: 是否在解析 async 函数之前加载路由（默认为 false）,"),s("code",[t._v("useLazyAsyncData")]),t._v("是这个配置的语法糖写法")]),t._v(" "),s("li",[t._v("server:是否在服务器端获取数据（默认为 true）")]),t._v(" "),s("li",[s("em",[t._v("transform")]),t._v(": 获得结果后对结果进行转换")]),t._v(" "),s("li",[t._v("pick:提供一个数组，其中的值为接口返回数据中要包含的key（这样可以减少页面的内存消耗）")])])])]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("script setup")]),t._v("支持顶级await")])]),t._v(" "),s("h2",{attrs:{id:"uselazyasyncdata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#uselazyasyncdata"}},[t._v("#")]),t._v(" useLazyAsyncData")]),t._v(" "),s("p",[t._v("即使是lazy也会在服务端预先获取数据，不需要写await")]),t._v(" "),s("h3",{attrs:{id:"usefetch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usefetch"}},[t._v("#")]),t._v(" useFetch")]),t._v(" "),s("p",[t._v("相当于useAsyncData的语法糖，不用再写key了")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useFetch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("参数：")]),t._v(" "),s("ol",[s("li",[s("p",[s("code",[t._v("key")]),t._v(": Provide a custom key")])]),t._v(" "),s("li",[s("p",[t._v("Options from  "),s("a",{attrs:{href:"https://github.com/unjs/ohmyfetch",target:"_blank",rel:"noopener noreferrer"}},[t._v("ohmyfetch"),s("OutboundLink")],1)]),t._v(" "),s("ol",[s("li",[s("code",[t._v("method")]),t._v(": Request method")]),t._v(" "),s("li",[s("code",[t._v("params")]),t._v(": Query params")]),t._v(" "),s("li",[s("code",[t._v("baseURL")]),t._v(": Base URL for request")])])]),t._v(" "),s("li",[s("p",[t._v("options中还支持useAsyncData中的options，同样提供语法糖写法："),s("code",[t._v("useLazyFetch")])])])]),t._v(" "),s("p",[t._v("key的生成规则:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('const key = "$f_" + (opts.key || hash([request, { ...opts, transform: null }]));\n')])])]),s("h2",{attrs:{id:"state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[t._v("#")]),t._v(" State")]),t._v(" "),s("h3",{attrs:{id:"usestate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usestate"}},[t._v("#")]),t._v(" useState")]),t._v(" "),s("p",[t._v("创建全局共享的只读数据，只有在初始化时可以赋值。可以使用在page、component、plugin中,只能用在setup和生命周期钩子中")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("useState"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" init"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Ref"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("p",[t._v("永远不要在 "),s("script",{attrs:{setup:""}})])])}),[],!1,null,null,null);a.default=r.exports}}]);