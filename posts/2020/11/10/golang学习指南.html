<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>golang学习指南 | L.Rain的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <meta name="description" content="L.Rain的博客">
    <link rel="preload" href="/assets/css/0.styles.0b94e76f.css" as="style"><link rel="preload" href="/assets/js/app.9a385967.js" as="script"><link rel="preload" href="/assets/js/7.8545d9f8.js" as="script"><link rel="preload" href="/assets/js/51.53d3189f.js" as="script"><link rel="prefetch" href="/assets/js/1.f6e0f07f.js"><link rel="prefetch" href="/assets/js/10.4a6afb4e.js"><link rel="prefetch" href="/assets/js/100.7abf2fda.js"><link rel="prefetch" href="/assets/js/101.a347818c.js"><link rel="prefetch" href="/assets/js/102.293ef46c.js"><link rel="prefetch" href="/assets/js/11.d13437d4.js"><link rel="prefetch" href="/assets/js/12.7d7635cb.js"><link rel="prefetch" href="/assets/js/13.919964bf.js"><link rel="prefetch" href="/assets/js/14.ab767f4b.js"><link rel="prefetch" href="/assets/js/15.8f5b48e5.js"><link rel="prefetch" href="/assets/js/16.3224b1f5.js"><link rel="prefetch" href="/assets/js/17.87f9b661.js"><link rel="prefetch" href="/assets/js/18.5d097e3c.js"><link rel="prefetch" href="/assets/js/19.4720b022.js"><link rel="prefetch" href="/assets/js/20.fb105d14.js"><link rel="prefetch" href="/assets/js/21.f8779953.js"><link rel="prefetch" href="/assets/js/22.af12eb08.js"><link rel="prefetch" href="/assets/js/23.7e32a9fa.js"><link rel="prefetch" href="/assets/js/24.c3641faf.js"><link rel="prefetch" href="/assets/js/25.9de1f825.js"><link rel="prefetch" href="/assets/js/26.8616e878.js"><link rel="prefetch" href="/assets/js/27.eb4629e5.js"><link rel="prefetch" href="/assets/js/28.b17b249a.js"><link rel="prefetch" href="/assets/js/29.9a1a1888.js"><link rel="prefetch" href="/assets/js/3.abcd40dc.js"><link rel="prefetch" href="/assets/js/30.1003f92c.js"><link rel="prefetch" href="/assets/js/31.a1b8c73c.js"><link rel="prefetch" href="/assets/js/32.0ba638fb.js"><link rel="prefetch" href="/assets/js/33.a1389464.js"><link rel="prefetch" href="/assets/js/34.6e321214.js"><link rel="prefetch" href="/assets/js/35.b1e2f5d1.js"><link rel="prefetch" href="/assets/js/36.2c3f4fb0.js"><link rel="prefetch" href="/assets/js/37.feacfa16.js"><link rel="prefetch" href="/assets/js/38.f3016a1e.js"><link rel="prefetch" href="/assets/js/39.45c098a3.js"><link rel="prefetch" href="/assets/js/4.037891d1.js"><link rel="prefetch" href="/assets/js/40.211d2373.js"><link rel="prefetch" href="/assets/js/41.5904d463.js"><link rel="prefetch" href="/assets/js/42.d9ec67ba.js"><link rel="prefetch" href="/assets/js/43.22b9f9a4.js"><link rel="prefetch" href="/assets/js/44.19f84f5c.js"><link rel="prefetch" href="/assets/js/45.53ce2212.js"><link rel="prefetch" href="/assets/js/46.711d321a.js"><link rel="prefetch" href="/assets/js/47.fa2d3b03.js"><link rel="prefetch" href="/assets/js/48.d701fa9b.js"><link rel="prefetch" href="/assets/js/49.b984ba66.js"><link rel="prefetch" href="/assets/js/5.023c6154.js"><link rel="prefetch" href="/assets/js/50.629a8383.js"><link rel="prefetch" href="/assets/js/52.b57c32cf.js"><link rel="prefetch" href="/assets/js/53.0c8a8212.js"><link rel="prefetch" href="/assets/js/54.ee34d505.js"><link rel="prefetch" href="/assets/js/55.6c488d5e.js"><link rel="prefetch" href="/assets/js/56.4e428ec6.js"><link rel="prefetch" href="/assets/js/57.26e695c3.js"><link rel="prefetch" href="/assets/js/58.b4646b7c.js"><link rel="prefetch" href="/assets/js/59.04481ea3.js"><link rel="prefetch" href="/assets/js/6.118b5a7a.js"><link rel="prefetch" href="/assets/js/60.30d59f03.js"><link rel="prefetch" href="/assets/js/61.d1d8007b.js"><link rel="prefetch" href="/assets/js/62.2f0a550d.js"><link rel="prefetch" href="/assets/js/63.d36d79a9.js"><link rel="prefetch" href="/assets/js/64.7f67e3cf.js"><link rel="prefetch" href="/assets/js/65.751dcb64.js"><link rel="prefetch" href="/assets/js/66.b577a1c6.js"><link rel="prefetch" href="/assets/js/67.e108e6a3.js"><link rel="prefetch" href="/assets/js/68.e595cfb2.js"><link rel="prefetch" href="/assets/js/69.39f38f37.js"><link rel="prefetch" href="/assets/js/70.596e9001.js"><link rel="prefetch" href="/assets/js/71.296a511a.js"><link rel="prefetch" href="/assets/js/72.f427c950.js"><link rel="prefetch" href="/assets/js/73.5530225f.js"><link rel="prefetch" href="/assets/js/74.6345dd38.js"><link rel="prefetch" href="/assets/js/75.d2628118.js"><link rel="prefetch" href="/assets/js/76.08abf0d1.js"><link rel="prefetch" href="/assets/js/77.4e8c7864.js"><link rel="prefetch" href="/assets/js/78.906b9cbf.js"><link rel="prefetch" href="/assets/js/79.011b1cbe.js"><link rel="prefetch" href="/assets/js/8.51c6e2dd.js"><link rel="prefetch" href="/assets/js/80.ee5fd44b.js"><link rel="prefetch" href="/assets/js/81.02dd9c8d.js"><link rel="prefetch" href="/assets/js/82.ec68bf25.js"><link rel="prefetch" href="/assets/js/83.1c86ad25.js"><link rel="prefetch" href="/assets/js/84.595784c1.js"><link rel="prefetch" href="/assets/js/85.6063c63f.js"><link rel="prefetch" href="/assets/js/86.c6d4caa0.js"><link rel="prefetch" href="/assets/js/87.586d62e6.js"><link rel="prefetch" href="/assets/js/88.2df0ff81.js"><link rel="prefetch" href="/assets/js/89.fe4cbd75.js"><link rel="prefetch" href="/assets/js/9.50140b23.js"><link rel="prefetch" href="/assets/js/90.46c0c350.js"><link rel="prefetch" href="/assets/js/91.ca424313.js"><link rel="prefetch" href="/assets/js/92.782c7f00.js"><link rel="prefetch" href="/assets/js/93.72a7bd09.js"><link rel="prefetch" href="/assets/js/94.65da01c6.js"><link rel="prefetch" href="/assets/js/95.7720da11.js"><link rel="prefetch" href="/assets/js/96.c65f5117.js"><link rel="prefetch" href="/assets/js/97.9206449a.js"><link rel="prefetch" href="/assets/js/98.0266c48e.js"><link rel="prefetch" href="/assets/js/99.abb52d07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b94e76f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(https://picsum.photos/1920/250.webp);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          L.Rain的博客
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/" class="navbar-link" data-v-e4145d0a>
            主页
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            分类
          </a><a href="https://github.com/baixiaoyu2997" target="_blank" rel="noopener noreferrer" class="navbar-link" data-v-e4145d0a><span data-v-e4145d0a>Github</span> <span data-v-e4145d0a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          golang学习指南
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-11-10
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2021-08-04
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2020/11/09/koa%E6%8C%87%E5%8D%97.html" class="post-link" data-v-4e23451f>
      上一篇 : koa指南
    </a> <a href="/posts/2020/11/10/go-micro%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html" class="post-link" data-v-4e23451f>
      下一篇 : go-micro学习指南
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><h2 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h2> <p>官方文档：https://golang.org/ref/spec</p> <p>查看每个版本的golang api: https://github.com/golang/go/tree/master/api</p> <h2 id="学习资源"><a href="#学习资源" class="header-anchor">#</a> 学习资源</h2> <ol><li><s><a href="https://tour.go-zh.org/basics/1" target="_blank" rel="noopener noreferrer">go tour<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:简单上手，熟悉语法</s></li> <li><a href="https://www.bilibili.com/video/BV1fD4y1m7TD?p=1" target="_blank" rel="noopener noreferrer">Go语言编程快速入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>视频教程，适合初学者</li></ol> <p><a href="https://www.bilibili.com/video/BV1gJ411p7xC" target="_blank" rel="noopener noreferrer">go web开发<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol start="4"><li><a href="http://golang.iswbm.com/en/latest/index.html" target="_blank" rel="noopener noreferrer">Go编程时光<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:学习基础知识（个人博客）</li> <li><a href="https://github.com/unknwon/the-way-to-go_ZH_CN" target="_blank" rel="noopener noreferrer">Go入门指南<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：正式学习书籍</li> <li><a href="https://books.studygolang.com/The-Golang-Standard-Library-by-Example/" target="_blank" rel="noopener noreferrer">《Go语言标准库》<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,学习官方库的使用</li></ol> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>https://golang.org/dl/</p> <h2 id="编辑器"><a href="#编辑器" class="header-anchor">#</a> 编辑器</h2> <ol><li><p>安装vscode插件<code>Go</code></p></li> <li><p>安装go tools，<code>f1&gt;Go:Install/Update Tools</code>,全选，然后确定，这个需要配置代理，否则会安装报错</p></li> <li><p>使用包，需要初始化<code>go mod</code>，输入指令<code>go mod init main</code></p></li> <li><p>debug时总是需要按f5来看结果，这很不方便，可以安装插件<code>watch-run</code>，并添加debug task：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token comment">// See https://go.microsoft.com/fwlink/?LinkId=733558</span>
  <span class="token comment">// for the documentation about the tasks.json format</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tasks&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;label&quot;</span><span class="token operator">:</span> <span class="token string">&quot;go debug&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shell&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;command&quot;</span><span class="token operator">:</span> <span class="token string">&quot;go run ${file}&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>vscode配置文件添加：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;watch-run.targetList&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;**/*.go&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;task&quot;</span><span class="token operator">:</span> <span class="token string">&quot;go debug&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
</code></pre></div></li></ol> <h2 id="名词解释"><a href="#名词解释" class="header-anchor">#</a> 名词解释</h2> <h3 id="类型别名"><a href="#类型别名" class="header-anchor">#</a> 类型别名</h3> <p>同一个类型的另一个名字，可以自定义类型别名：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> <span class="token builtin">byte</span><span class="token operator">=</span><span class="token builtin">uint8</span>
<span class="token keyword">type</span> <span class="token builtin">rune</span><span class="token operator">=</span><span class="token builtin">int32</span>
</code></pre></div><h3 id="环绕行为"><a href="#环绕行为" class="header-anchor">#</a> 环绕行为</h3> <p>当值超过该类型最大值时，会从最小值重新开始累计</p> <h3 id="goroutine"><a href="#goroutine" class="header-anchor">#</a> goroutine</h3> <p>独立的任务叫做goroutine。约定：如果代码文档中没有明确说明，那么我们假定这个方法在并发访问的时候是不安全的</p> <h3 id="worker"><a href="#worker" class="header-anchor">#</a> worker</h3> <p>长时间使用的goroutine被称为工作进程，一般使用以下方式达到事件循环的目的</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">for</span> <span class="token punctuation">{</span>
  <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> c<span class="token operator">:=</span><span class="token operator">&lt;-</span>r<span class="token punctuation">.</span>commandc<span class="token punctuation">:</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="文档"><a href="#文档" class="header-anchor">#</a> 文档</h2> <h3 id="type-assertion"><a href="#type-assertion" class="header-anchor">#</a> Type Assertion</h3> <p>类型断言，使用方法有两种：</p> <ol><li><code>t:=i.(T)</code> 断言一个接口对象i里不是nil,并且接口对象存储的值类型时T，如果断言成功，就会返回值给t，断言失败会触发panic</li> <li><code>t, ok:= i.(T)</code>失败不回触发panic，而是ok值为false</li></ol> <h3 id="errors"><a href="#errors" class="header-anchor">#</a> Errors</h3> <p>自定义错误类型：错误是一个内部的接口，只要包含一个Error() string方法的类都属于该接口。错误类型约定应以<code>Error</code>结尾</p> <p>声明变量为错误时，约定以<code>Err</code>开头</p> <p>panic比os.Exit更好，panic后会执行所有defer的动作，而Exit不会</p> <p>在defer函数中调用recover可以防止panic，程序正常执行。</p> <h3 id="statements-声明"><a href="#statements-声明" class="header-anchor">#</a> Statements（声明）</h3> <h4 id="defer"><a href="#defer" class="header-anchor">#</a> Defer</h4> <p>延迟处理，所有deferred的动作可以在函数返回前执行。</p> <h4 id="go"><a href="#go" class="header-anchor">#</a> go</h4> <p>启动goroutine,只需要再调用前面加一个go关键字，只能用在函数前。</p> <p>计算机处理器会使用“分时”技术，再多个goroutine上轮流花费时间</p> <p>在使用goroutine时，各个goroutine的执行顺序无法确定</p> <p>即使已经停止等待goroutine，但只要main函数还没返回，仍在运行的goroutine将会继续占用内存。</p> <h4 id="select"><a href="#select" class="header-anchor">#</a> select</h4> <p>与switch类似，哪个chanl先返回哪个先执行。</p> <p>不包含任何case的情况下，将永远等下去。</p> <h3 id="词汇元素"><a href="#词汇元素" class="header-anchor">#</a> 词汇元素</h3> <h4 id="rune-literals"><a href="#rune-literals" class="header-anchor">#</a> Rune literals</h4> <p>字符用单引号表示<code>''</code></p> <h3 id="declarations-and-scope"><a href="#declarations-and-scope" class="header-anchor">#</a> Declarations and scope</h3> <h4 id="type"><a href="#type" class="header-anchor">#</a> type</h4> <p>type可以声明一个新的类型，使用新类型可以提高代码可读性和可靠性，值得注意的是，尽管新的类型基于旧类型，但是这两个类型无法混用。</p> <p>通过添加方法可以为新类型添加行为</p> <h3 id="package"><a href="#package" class="header-anchor">#</a> package</h3> <ol><li><p>包名与导入路径的最后一个元素一致。例如，<code>&quot;math/rand&quot;</code> 包中的源码均以 <code>package rand</code> 语句开始</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;math/rand&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;My favorite number is&quot;</span><span class="token punctuation">,</span> rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>在 Go 中，如果一个名字以大写字母开头，那么它就是已导出的。在导入一个包时，你只能引用其中已导出的名字。任何“未导出”的名字在该包外均无法访问。</p></li></ol> <h3 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h3> <p>函数的零值为<code>nil</code></p> <h4 id="参数"><a href="#参数" class="header-anchor">#</a> 参数</h4> <p>函数需要为参数添加类型，如果多个类型值一致，那么可以省略除了最后一个参数的类型声明</p> <div class="language-go extra-class"><pre class="language-go"><code>x <span class="token builtin">int</span><span class="token punctuation">,</span> y <span class="token builtin">int</span>
x<span class="token punctuation">,</span> y <span class="token builtin">int</span>
</code></pre></div><p>多个参数使用<code>...</code>表示，例如：<code>main(a...int)</code></p> <p>函数的参数总是传递参数的副本</p> <h4 id="返回值"><a href="#返回值" class="header-anchor">#</a> 返回值</h4> <p>函数可以返回任意数量的返回值</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">swap</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> y<span class="token punctuation">,</span> x
<span class="token punctuation">}</span>
</code></pre></div><p>命名返回值： <code>return</code>空时， 返回已命名的返回值。也就是 <code>直接</code> 返回。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">split</span><span class="token punctuation">(</span>sum <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x <span class="token operator">=</span> sum <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">/</span> <span class="token number">9</span>
	y <span class="token operator">=</span> sum <span class="token operator">-</span> x
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="方法关联类型"><a href="#方法关联类型" class="header-anchor">#</a> 方法关联类型</h4> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> test <span class="token builtin">float64</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>k test<span class="token punctuation">)</span> <span class="token function">celsius</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> b <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token builtin">int</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此处的k称为接收者，每个方法只能有一个接收者,接收者传入类型为test类型，方法调用方式：</p> <div class="language-go extra-class"><pre class="language-go"><code>test<span class="token punctuation">.</span><span class="token function">celsius</span><span class="token punctuation">(</span><span class="token number">2.1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3.5</span><span class="token punctuation">)</span> <span class="token comment">// test也可以为test类型的变量</span>
</code></pre></div><p>celsius方法接收到的参数第一个为接收者k，剩下的为函数声明参数</p> <h4 id="方法的转发"><a href="#方法的转发" class="header-anchor">#</a> 方法的转发</h4> <p>还可以在方法中调用接收者中的字段的方法</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>t temp<span class="token punctuation">)</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token punctuation">)</span> celsius<span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>high<span class="token operator">+</span>t<span class="token punctuation">.</span>low<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>r report<span class="token punctuation">)</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token punctuation">)</span> celsius<span class="token punctuation">{</span>
  <span class="token keyword">return</span> r<span class="token punctuation">.</span>temp<span class="token punctuation">.</span><span class="token function">average</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 调用report类型中temp字段的方法</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这种写法比较繁琐，可以使用struct的嵌入，类型自动关联字段的方法</p> <h4 id="方法的接收者与指针"><a href="#方法的接收者与指针" class="header-anchor">#</a> 方法的接收者与指针</h4> <p>方法的接收者处理指针是与函数的参数基本类似的，会解引用，但是接收类型要为指针类型。如果有一个方法接收指针类型，那么其他方法也应该如此</p> <h3 id="基本类型"><a href="#基本类型" class="header-anchor">#</a> 基本类型</h3> <ol><li><p>变量使用var定义，可以出现在包或者函数级别</p></li> <li><p>同时声明多个变量时，如果类型相同，可以只给最后一个变量添加类型定义</p></li> <li><p>初始化，初始化时有值的情况可以省略类型定义</p></li> <li><p>短声明，在<strong>函数</strong>中，简洁赋值语句，<code>:=</code>可在类型明确的地方代替<code>var</code>声明。短声明只能用在函数内</p></li> <li><p>函数外的每个语句都必须以关键字开始，<code>var,func</code>等等</p></li> <li><p>变量声明也可以像导入语句一样分组成一个语法块</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> <span class="token punctuation">(</span>
	ToBe   <span class="token builtin">bool</span>       <span class="token operator">=</span> <span class="token boolean">false</span>
	MaxInt <span class="token builtin">uint64</span>     <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">64</span> <span class="token operator">-</span> <span class="token number">1</span>
	z      <span class="token builtin">complex128</span> <span class="token operator">=</span> cmplx<span class="token punctuation">.</span><span class="token function">Sqrt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">12i</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>类型转换：表达式 <code>T(v)</code> 将值 <code>v</code> 转换为类型 <code>T</code>。Go 在不同类型的项之间赋值时需要显式转换</p></li> <li><p>值为单引号和双引号的区别，单引号为一个字符，惯上用它来区别字符值和整数值，双引号表示字符串字面量，支持转义，不想转义使用反引号`</p></li></ol> <h4 id="整数"><a href="#整数" class="header-anchor">#</a> 整数</h4> <ol><li>int，int和uint都是与架构有关的</li> <li>uint,无符号整数类型</li> <li>unit8,可以用来表示css颜色，因为取值范围相同（0-255）</li></ol> <p><img src="https://blog-pic.oss-cn-beijing.aliyuncs.com/image-20210630161106786.png" alt="image-20210630161106786"></p> <h4 id="常量"><a href="#常量" class="header-anchor">#</a> 常量</h4> <p>使用<code>const</code>声明，不能使用<code>:=</code>声明。常量可以是字符、字符串、布尔值或数值,甚至也可以没有类型(untyped)</p> <p>常量不能修改</p> <h4 id="零值"><a href="#零值" class="header-anchor">#</a> 零值</h4> <p>没有明确初始值的变量声明会被赋予他们的零值。零值是：</p> <ul><li>数值类型为 <code>0</code>，</li> <li>布尔类型为 <code>false</code>，</li> <li>字符串为 <code>&quot;&quot;</code>（空字符串）。</li></ul> <h4 id="int"><a href="#int" class="header-anchor">#</a> int</h4> <p><code>int</code>, <code>uint</code> 和 <code>uintptr</code> 在 32 位系统上通常为 32 位宽，在 64 位系统上则为 64 位宽。 当你需要一个整数值时应使用 <code>int</code> 类型，除非你有特殊的理由使用固定大小或无符号的整数类型。</p> <h4 id="int32"><a href="#int32" class="header-anchor">#</a> int32</h4> <p>int32的类型别名为<code>rune</code></p> <h4 id="uint8"><a href="#uint8" class="header-anchor">#</a> uint8</h4> <p>uint8的别名是<code>byte</code>,目的是用于二进制数据</p> <h4 id="boolean"><a href="#boolean" class="header-anchor">#</a> boolean</h4> <p>布尔值只有true和false</p> <h4 id="float"><a href="#float" class="header-anchor">#</a> float</h4> <p>浮点类型可以表达的值大于uint64最大值</p> <h4 id="string"><a href="#string" class="header-anchor">#</a> string</h4> <p>string可以看做是一种特殊的slice类型，获取长度可以使用len</p> <h3 id="其他类型"><a href="#其他类型" class="header-anchor">#</a> 其他类型</h3> <h4 id="big"><a href="#big" class="header-anchor">#</a> Big</h4> <p>一旦使用了big.int，那么等式里其他部分也必须使用<code>big.int</code></p> <div class="language-go extra-class"><pre class="language-go"><code>num<span class="token operator">:=</span><span class="token function">new</span><span class="token punctuation">(</span>big<span class="token punctuation">.</span>Int<span class="token punctuation">)</span>
num<span class="token punctuation">.</span><span class="token function">SetString</span><span class="token punctuation">(</span><span class="token string">'12312311231232113123123'</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><p>无类型数字常量是由big来处理</p> <h4 id="结构体"><a href="#结构体" class="header-anchor">#</a> 结构体</h4> <p>类似于ts中的<code>interface</code>，结构体中的属性称为结构体字段</p> <h4 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h4> <p>数组长度由创建时定义，不可再改变。</p> <p>使用复合字面值初始化数组：<code>dwarfs :=[5]string{&quot;dfs&quot;,&quot;dfs&quot;,&quot;dfs&quot;,&quot;dfs&quot;,&quot;dfs&quot;}</code>,还可以使用<code>...</code>作为数组的长度，go编译器会为你算出数组的元素数量<code>dwarfs :=[...]string{&quot;dfs&quot;,&quot;dfs&quot;,&quot;dfs&quot;,&quot;dfs&quot;,&quot;dfs&quot;}</code></p> <p>使用<code>len(arr)</code>可以查看数组的长度，使用<code>cap(arr)</code>可以查看数组的容量,数组的零值为<code>nil</code></p> <p>数组赋值给新的变量或者传递给函数时都会产生一个新的数组副本，所以性能会比较低，一般使用切片作为参数而不是数组。</p> <p><strong>切片</strong></p> <p>数组支持切片操作，切片只是对引用的描述，修改值会影响原数组，以下切片写法是等价的：</p> <div class="language- extra-class"><pre class="language-text"><code>a[0:10]
a[:10]
a[0:]
a[:]
</code></pre></div><p>切片的默认值是<code>nil</code></p> <p>切片的索引不能是负数</p> <p>切片添加值使用<code>append</code></p> <p>切片操作也可以用于字符串</p> <p>使用3索引可以限制切片的容量，例如：<code>ter:=planets[0:4:4]</code></p> <p>可以单独声明slice:<code>dwarfs :=[]string{&quot;test&quot;,&quot;test&quot;,&quot;test&quot;,&quot;test&quot;}</code>,也就是没有长度的数组形式。</p> <blockquote><p>文章：<a href="https://blog.go-zh.org/go-slices-usage-and-internals" target="_blank" rel="noopener noreferrer">Go 切片：用法和本质<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h4 id="map"><a href="#map" class="header-anchor">#</a> map</h4> <p>map默认值为<code>nil</code>, map声明<code>map[string]int</code>,这里的string表示key的类型，而int表示值的类型。访问key只能通过<code>[]</code>,在访问map中的key时，如果不确定是否有值，那么可以通过返回值的第二个值进行判断：</p> <div class="language-go extra-class"><pre class="language-go"><code>moon<span class="token operator">:=</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token keyword">if</span> moon<span class="token punctuation">,</span>ok<span class="token operator">:=</span>moon<span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;存在&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;不存在&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以使用make指定map的容量<code>m := make(map[string]int, 99)</code></p> <h4 id="struct"><a href="#struct" class="header-anchor">#</a> struct</h4> <p>结构体，类似于class,不是引用类型。访问字段使用<code>.</code>，声明结构体变量</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> curiosity <span class="token keyword">struct</span><span class="token punctuation">{</span>
  a <span class="token builtin">int64</span>
<span class="token punctuation">}</span>
</code></pre></div><p>声明struct类型</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> location <span class="token keyword">struct</span><span class="token punctuation">{</span>
  a <span class="token builtin">int64</span>
  b <span class="token builtin">int64</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过复合字面值初始化struct</p> <div class="language-go extra-class"><pre class="language-go"><code>test<span class="token operator">:=</span>location<span class="token punctuation">{</span>b<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token comment">// 键值对形式可以不按照顺序赋值</span>
test<span class="token operator">:=</span>location<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span> <span class="token comment">// 按照结构体字段顺序赋值</span>
</code></pre></div><p>转换成json，默认只转换出大写开头的，如果想要自定义，那么需要在后边加上额外内容(tag)：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> location <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  Lat <span class="token builtin">float64</span> <span class="token string">`json:&quot;latitude&quot;xml:&quot;latitude&quot; binding:&quot;-&quot;`</span> <span class="token comment">// -表示忽略该校验</span>
  Long <span class="token builtin">float64</span> <span class="token string">`json:&quot;longitude&quot; binding:&quot;required&quot;`</span> <span class="token comment">// binding required表示必须传该值</span>
<span class="token punctuation">}</span>
</code></pre></div><p>约定，如果方法以<code>new</code>开头，后边是结构体，那么通常是用来构造数据的，例如<code>newPerson</code></p> <p><strong>嵌入</strong></p> <p>struct中通过组合的方式拆分关联度比较高的字段成为一个新类型：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> location <span class="token keyword">struct</span><span class="token punctuation">{</span>
  style style
  color unit8
<span class="token punctuation">}</span>
<span class="token keyword">type</span> style <span class="token keyword">struct</span><span class="token punctuation">{</span>
  width <span class="token builtin">int64</span>
  height <span class="token builtin">int64</span>
<span class="token punctuation">}</span>
</code></pre></div><p>还有一种简写的写法，叫做嵌入：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> location <span class="token keyword">struct</span><span class="token punctuation">{</span>
  style
  color unit8
<span class="token punctuation">}</span>
<span class="token keyword">type</span> style <span class="token keyword">struct</span><span class="token punctuation">{</span>
  width <span class="token builtin">int64</span>
  height <span class="token builtin">int64</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用嵌入的写法会将组合字段的方法加入struct，比如style 有个<code>calculation</code>方法，这个时候location也可以直接使用：<code>location.calculation()</code>，还可以直接使用字段<code>location.width</code>,这种行为称为转发。</p> <p>当命名冲突时，不能使用这种简写，还是要使用<code>location.style.width</code>,当最外层struct中有同名方法时，则程序会优先使用该方法。</p> <h4 id="interface"><a href="#interface" class="header-anchor">#</a> interface</h4> <p>声明为接口类型的变量默认值为<code>nil</code>,接口类型的变量只有在类型和值都为nil时才 等于<code>nil</code></p> <p>接口关注与类型可以做什么，而不是储存了什么。</p> <p>接口通过列举类型必须满足的一组方法来进行声明。</p> <p>不需要显示声明接口。</p> <p>通常声明interface类型的时候习惯使用<code>er</code>结尾</p> <h4 id="指针"><a href="#指针" class="header-anchor">#</a> 指针</h4> <p>为什么要用指针？</p> <ol><li>指针可以帮助函数在内部修改外部变量的值，还可以帮助我们在任何地方修改其指向数据的值。</li> <li>传递指针参数可以节省拷贝大结构体的内存开销</li></ol> <p>通过&amp;操作符可以获取变量的内存地址。</p> <p><strong>内部指针</strong>：<code>&amp;</code>不仅可以获得结构体的内存地址，还可以获得其中字段的内存地址。</p> <p><code>*</code>放在类型前面表示指针类型，指针不能直接赋值给其他类型，只能赋值给<code>*type</code></p> <p><code>*</code>放在变量前面表示解引用,只能用在值为指针类型的变量上,或者复合字面量：<code>timmy:=&amp;person{name:&quot;Timothy&quot;,age:10}</code>,访问字段时，对结构体进行解引用不是必须的。数组在执行索引或切片操作时会自动解引用。slice和map的复合字面值没有自动解引用的功能。</p> <p><strong>隐式指针</strong>：go语言里有一些内置的集合类型就在暗中使用指针。map在被赋值或者作为参数传递的时候不回被复制。</p> <p>对<code>nil</code>解引用会引起程序恐慌，导致报错</p> <blockquote><p>文章：<a href="https://studygolang.com/articles/32103" target="_blank" rel="noopener noreferrer">什么时候使用指针？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h4 id="channel"><a href="#channel" class="header-anchor">#</a> Channel</h4> <p>通道可以在多个goroutine之间安全的传值</p> <p>通道可以用作变量、函数参数、结构体字段等等</p> <p>创建通道用make函数<code>c:=make(chan int)</code>。不使用make初始化通道，那么通道变量的值就是nil。对nil通道进行发送或接收不回引起panic，但会导致永久阻塞。对nil通道执行close函数，那么会引起panic。</p> <p>向通道发送或者接收值使用<code>&lt;-</code>符号，发送值例子：<code>c&lt;-99</code>，从通道接收值例子：<code>r:=&lt;-c</code></p> <p>接收或者发送值到通道时会阻塞当前线程运行。</p> <p><strong>缓冲channel</strong></p> <p>通过在make创建channel时，添加缓冲区，可以在之后才阻塞线程：<code>cha:=make(chan int,4)</code></p> <h3 id="流程控制语句"><a href="#流程控制语句" class="header-anchor">#</a> 流程控制语句</h3> <h4 id="for循环"><a href="#for循环" class="header-anchor">#</a> for循环</h4> <p>Go只有一种循环结构：for循环。</p> <p>基本的 <code>for</code> 循环由三部分组成，它们用分号隔开：</p> <ul><li>初始化语句：在第一次迭代前执行,可选</li> <li>条件表达式：在每次迭代前求值</li> <li>后置语句：在每次迭代的结尾执行，可选</li></ul> <p>还可以省略掉<code>;</code>，只使用for，当 作<code>while</code>使用：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	sum <span class="token operator">:=</span> <span class="token number">1</span>
	<span class="token keyword">for</span> sum <span class="token operator">&lt;</span> <span class="token number">1000</span> <span class="token punctuation">{</span>
		sum <span class="token operator">+=</span> sum
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>数组和字符串、channel遍历都可以使用：<code>for i := range arr</code>。</p> <p>range还可以用来遍历chanl，直到通道关闭位置</p> <h4 id="if语句"><a href="#if语句" class="header-anchor">#</a> if语句</h4> <p><code>if</code>支持简短语句，在表达式之前执行一个简单的语句，该语句声明的变量作用域仅在<code>if</code>之内,或者else。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">,</span> lim <span class="token builtin">float64</span><span class="token punctuation">)</span> <span class="token builtin">float64</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> v <span class="token operator">:=</span> math<span class="token punctuation">.</span><span class="token function">Pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> v <span class="token operator">&lt;</span> lim <span class="token punctuation">{</span>
		<span class="token keyword">return</span> v
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> lim
<span class="token punctuation">}</span>
</code></pre></div><h4 id="switch"><a href="#switch" class="header-anchor">#</a> switch</h4> <p>只运行选定的case，不需要break，除非以 <code>fallthrough</code> 语句结束，否则分支会自动终止。case 无需为常量，且取值不必为整数。</p> <p><code>switch</code>可以没有条件，同switch true一样</p> <h4 id="defer-2"><a href="#defer-2" class="header-anchor">#</a> defer</h4> <p>defer 语句会将函数推迟到外层函数返回之后执行。</p> <p>推迟的函数调用会被压入一个栈中。当外层函数返回时，被推迟的函数会按照后进先出的顺序调用。</p> <h3 id="结构体-2"><a href="#结构体-2" class="header-anchor">#</a> 结构体</h3> <p>类似于js中的class，结构体字段使用点号来访问：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">type</span> Vertex <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	X <span class="token builtin">int</span>
	Y <span class="token builtin">int</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	v <span class="token operator">:=</span> Vertex<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span>
	v<span class="token punctuation">.</span>X <span class="token operator">=</span> <span class="token number">4</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>X<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="内置函数"><a href="#内置函数" class="header-anchor">#</a> 内置函数</h3> <p>内置函数不需要<code>import</code></p> <h4 id="len"><a href="#len" class="header-anchor">#</a> len</h4> <p>查看字符串字节长度</p> <h4 id="cap"><a href="#cap" class="header-anchor">#</a> cap</h4> <p>查看切片容量，如果append后超过原容量，那么会产生一个新数组，容量为之前容量的2倍</p> <h4 id="append"><a href="#append" class="header-anchor">#</a> append</h4> <p>添加slice，<code>test=append(a,1)</code>,合并其他slice，使用<code>...</code> ，<code>test=append(a,anthorSlice...)</code></p> <h4 id="delete"><a href="#delete" class="header-anchor">#</a> delete</h4> <p>删除map中的key</p> <h4 id="make"><a href="#make" class="header-anchor">#</a> make</h4> <p>动态创建切片、map、channel,make返回类型的引用。make和new都是用来分配内存的内建函数，且在堆上分配内存，make即分配内存，也初始化内存。new只是将内存清零，new返回的是指向类型的指针，new可以分配任意类型。</p> <h4 id="close"><a href="#close" class="header-anchor">#</a> Close</h4> <p>关闭chanl</p> <h2 id="mod"><a href="#mod" class="header-anchor">#</a> mod</h2> <p>init指令后边指定的是该项目的包名称,执行之后生成<code>go.mod</code>文件,该文件包含包名和使用的go的版本：</p> <div class="language- extra-class"><pre class="language-text"><code>module main
go 1.16
</code></pre></div><h3 id="go-get"><a href="#go-get" class="header-anchor">#</a> go get</h3> <p>已有项目如果想安装所有的包，那么使用<code>go get</code>获取</p> <h2 id="package-2"><a href="#package-2" class="header-anchor">#</a> package</h2> <p>大写字母开头的函数、变量或其他标识符都会被导出。小写字母开头的就不行,当导入包后。</p> <p>包的入口函数为<code>main</code>,如果没有在程序中使用，则会触发<code>init</code>函数</p> <p><code>import</code>本地包时使用的是目录位置，比如说：<code>main/dao</code>，则是导入<code>dao</code>这个文件夹下的所有包</p> <p>一个文件夹下的所有包的<code>package</code>必须同名</p> <h3 id="embed"><a href="#embed" class="header-anchor">#</a> embed</h3> <p>文件嵌入到程序中，可以使用在web开发时的静态资源打包。需要<code>go v1.16</code></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;embed&quot;</span>
	<span class="token string">&quot;html/template&quot;</span>
	<span class="token string">&quot;io/fs&quot;</span>
	<span class="token string">&quot;net/http&quot;</span>
	<span class="token string">&quot;github.com/gin-gonic/gin&quot;</span>
<span class="token punctuation">)</span>
<span class="token comment">//go:embed static/* templates/*</span>
<span class="token keyword">var</span> f embed<span class="token punctuation">.</span>FS
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fsys<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> fs<span class="token punctuation">.</span><span class="token function">Sub</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">&quot;static&quot;</span><span class="token punctuation">)</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	templ <span class="token operator">:=</span> template<span class="token punctuation">.</span><span class="token function">Must</span><span class="token punctuation">(</span>template<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ParseFS</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">&quot;templates/*.tmpl&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;templates/home/*.tmpl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">SetHTMLTemplate</span><span class="token punctuation">(</span>templ<span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">StaticFS</span><span class="token punctuation">(</span><span class="token string">&quot;/static/&quot;</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">FS</span><span class="token punctuation">(</span>fsys<span class="token punctuation">)</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">.</span><span class="token function">HTML</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;index.tmpl&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/search&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
			<span class="token string">&quot;query&quot;</span><span class="token punctuation">:</span> c<span class="token punctuation">.</span><span class="token function">Query</span><span class="token punctuation">(</span><span class="token string">&quot;q&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="strings"><a href="#strings" class="header-anchor">#</a> strings</h3> <h4 id="join-arr-string-sep-string-string"><a href="#join-arr-string-sep-string-string" class="header-anchor">#</a> Join(arr []string, sep string) string</h4> <p>根据片段拆分成字符串</p> <h4 id="compare-str1-str2-int"><a href="#compare-str1-str2-int" class="header-anchor">#</a> Compare(str1,str2) int</h4> <p>比较两个字符串，如果相等则返回0，str1小于str2则返回-1，大于返回1</p> <h4 id="equalfold-str1-str2-bool"><a href="#equalfold-str1-str2-bool" class="header-anchor">#</a> EqualFold(str1,str2) bool</h4> <p>计算 s 与 t 忽略字母大小写后是否相等。</p> <h3 id="strconv"><a href="#strconv" class="header-anchor">#</a> strconv</h3> <p>实现转换相关功能</p> <h3 id="fmt"><a href="#fmt" class="header-anchor">#</a> fmt</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%c&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出单个字符。
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出十进制整数。
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%f&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出十进制浮点数<span class="token punctuation">.</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%o&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出八进制数。
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出字符串。
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%u&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出无符号十进制数。
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>；输出十六进制数。
<span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%v&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>；输入a的值
<span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%+v&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>；输入a的声明值，包含key
<span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%T&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>；输入a的类型
<span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;./%s&quot;</span><span class="token punctuation">,</span>f<span class="token punctuation">.</span>Filename<span class="token punctuation">)</span> <span class="token comment">// 格式化拼接字符串</span>
<span class="token function">Fprintf</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span><span class="token string">&quot;hello astaxie!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 将第二个参数写入到第一个参数，第一个参数为<span class="token string">`io.Writter`</span>类型
</code></pre></div><h3 id="unicode"><a href="#unicode" class="header-anchor">#</a> unicode</h3> <h4 id="utf8"><a href="#utf8" class="header-anchor">#</a> utf8</h4> <p><code>utf8.RuneCountInString</code>可以用来查看字符串中字符个数</p> <h4 id="math"><a href="#math" class="header-anchor">#</a> math</h4> <p>math.<a href="https://golang.org/src/math/floor.go?s=933:962#L38" target="_blank" rel="noopener noreferrer">Trunc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 返回float64的整数值</p> <h3 id="encoding"><a href="#encoding" class="header-anchor">#</a> encoding</h3> <h4 id="json-marshal"><a href="#json-marshal" class="header-anchor">#</a> json.Marshal</h4> <p>把任何类型转换为byte类型</p> <h4 id="json-unmarshal-body-result"><a href="#json-unmarshal-body-result" class="header-anchor">#</a> json.Unmarshal(body, &amp;result)</h4> <p>转换第一个参数为json格式，赋值给resutl变量</p> <h3 id="http"><a href="#http" class="header-anchor">#</a> http</h3> <h4 id="client"><a href="#client" class="header-anchor">#</a> client</h4> <p>可以统一为其他请求进行预设，一般为header的设置。client.Get和client.Post是对client.NewRequest的包装</p> <p>设置好client后，需要client.Do()发送请求</p> <h4 id="type-request"><a href="#type-request" class="header-anchor">#</a> type Request</h4> <p><strong>Request.ParseForm()</strong></p> <p>解析原始请求query，默认不解析，解析后request.Form为map类型的query,value的值为数组</p> <p>如果不解析Form，则Form值为<code>[]</code></p> <p>Request本身也提供了FormValue函数来获取参数，例如<code>r.Form[&quot;username&quot;]</code>也可以写成<code>r.FormValue(&quot;username&quot;)</code>。调用<code>r.FormValue</code>时会自动调用<code>r.ParseForm</code>,所以不用提前调用。<code>r.FormValue</code>只会返回同名参数中的第一个，若不存在则返回空字符串。</p> <p><code>r.Form</code> 对不同类型的表单元素的留空有不同的处理， 对于空文本框、空文本区域以及文件上传，元素的值为空值，而如果是未选中的复选框和单选按钮，则根本不会在 r.Form 中产生相应条目，如果我们用上面例子中的方式去获取数据时程序就会报错。所以我们需要通过 r.Form.Get() 来获取值，因为如果字段不存在，通过该方式获取的是空值。但是通过 r.Form.Get() 只能获取单个的值，</p> <h4 id="listenandserve"><a href="#listenandserve" class="header-anchor">#</a> ListenAndServe</h4> <p>启动服务，会阻塞程序运行。</p> <h3 id="html"><a href="#html" class="header-anchor">#</a> html</h3> <h3 id="io"><a href="#io" class="header-anchor">#</a> io</h3> <h4 id="ioutil-readdir"><a href="#ioutil-readdir" class="header-anchor">#</a> ioutil.ReadDir</h4> <p>读取当前目录</p> <h4 id="ioutil-readall"><a href="#ioutil-readall" class="header-anchor">#</a> ioutil.ReadAll</h4> <p>一次性读取所有返回</p> <h3 id="os"><a href="#os" class="header-anchor">#</a> os</h3> <h4 id="create"><a href="#create" class="header-anchor">#</a> Create</h4> <p>创建文件</p> <h3 id="sync"><a href="#sync" class="header-anchor">#</a> sync</h3> <h4 id="mutex"><a href="#mutex" class="header-anchor">#</a> mutex</h4> <p>互斥锁,定义在被保护的变量之上，一个已经被锁定的goroutine再次被锁定则会引发死锁。</p> <h3 id="time"><a href="#time" class="header-anchor">#</a> time</h3> <h4 id="now"><a href="#now" class="header-anchor">#</a> Now()</h4> <p>当前时间</p> <h4 id="since-time"><a href="#since-time" class="header-anchor">#</a> Since(time)</h4> <p>获取参数到当前时间之差</p> <h4 id="sleep-time-second"><a href="#sleep-time-second" class="header-anchor">#</a> Sleep(time.Second)</h4> <p>睡眠几秒</p> <h2 id="gin框架"><a href="#gin框架" class="header-anchor">#</a> Gin框架</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>web服务框架</p> <h4 id="中间件"><a href="#中间件" class="header-anchor">#</a> 中间件</h4> <p>Gin中的中间件必须是一个<code>gin.HandlerFunc</code>类型,普通的请求方法参数中从第二个开始都是中间件，按照写入顺序执行。中间件一般会写成闭包的形式，这样写的好处在于，可以做一些准备工作或者接受配置，这样就不用在具体中间件中写一堆判断了。</p> <p>如果要在gin中使用goroutine，那么不应该goroutine中修改gin的上下文，只能使用gin上下文的副本。</p> <h3 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h3> <p>安装： <code>go get -u github.com/gin-gonic/gin</code></p> <p>引入：<code>import (&quot;github.com/gin-gonic/gin&quot;)</code></p> <h3 id="default"><a href="#default" class="header-anchor">#</a> Default()</h3> <p>默认使用了<code>Logger</code>和<code>Recovery</code>中间件，<code>Logger</code>将日志写入gin.DefaultWriter,即使设置了GIN_MODE=realease。</p> <p><code>Recovery</code>中间会recover任何panic。如果有panic的话，会写入500响应码</p> <h3 id="new"><a href="#new" class="header-anchor">#</a> New()</h3> <p>如果不想使用Default则使用New创建一个没有中间件的路由</p> <h3 id="engine"><a href="#engine" class="header-anchor">#</a> Engine</h3> <p>Gin实例</p> <h4 id="maxmultipartmemory"><a href="#maxmultipartmemory" class="header-anchor">#</a> MaxMultipartMemory</h4> <p>设置处理提交文件时默认的内存限制，小于这个限制的内容保存在内存中，大于这个限制的超出部分保存在本地临时文件中</p> <h4 id="run-port"><a href="#run-port" class="header-anchor">#</a> Run(port)</h4> <p>启动服务</p> <h4 id="loadhtmlfiles-files"><a href="#loadhtmlfiles-files" class="header-anchor">#</a> loadHTMLFiles(files)</h4> <p>加载模版</p> <h4 id="setfuncmap"><a href="#setfuncmap" class="header-anchor">#</a> SetFuncMap</h4> <p>添加自定义函数</p> <h4 id="static-relativepath-root"><a href="#static-relativepath-root" class="header-anchor">#</a> Static(relativePath,root)</h4> <p>定义静态文件地址,第一个参数为代码中使用的假名，第二个参数为假名指向的服务器真实目录</p> <h4 id="any-path-func"><a href="#any-path-func" class="header-anchor">#</a> Any(path,func)</h4> <p>除了<code>post、get</code>等方法处理请求，还可以使用Any处理所有方法,通过<code>context.Request.Method</code>判断该请求是哪种方法</p> <h4 id="noroute-func"><a href="#noroute-func" class="header-anchor">#</a> NoRoute(func)</h4> <p>处理没有接收的请求</p> <h4 id="group-name"><a href="#group-name" class="header-anchor">#</a> Group(name)</h4> <p>路由组，管理不同业务类型的路由时，使用分组可以保证结构清晰，支持嵌套</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	userGroup <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span> <span class="token comment">// 代码块可以不加，添加是为了看着直观</span>
		userGroup<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/index&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		userGroup<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		userGroup<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	shopGroup <span class="token operator">:=</span> r<span class="token punctuation">.</span><span class="token function">Group</span><span class="token punctuation">(</span><span class="token string">&quot;/shop&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		shopGroup<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/index&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		shopGroup<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/cart&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		shopGroup<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;/checkout&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="use-middlerware-handlefunc"><a href="#use-middlerware-handlefunc" class="header-anchor">#</a> Use(middlerware...handleFunc)</h4> <p>全局注册中间件，先于请求中的中间件执行。所有请求都会触发该中间件</p> <h3 id="context"><a href="#context" class="header-anchor">#</a> Context</h3> <h4 id="copy"><a href="#copy" class="header-anchor">#</a> Copy()</h4> <p>创建一个当前上下文的副本</p> <h4 id="html-code-name-obj"><a href="#html-code-name-obj" class="header-anchor">#</a> HTML(code,name,obj)</h4> <p>渲染模版,需要先加载模版后才能使用。参数：状态吗，模版名称，渲染参数</p> <h4 id="json-code-data"><a href="#json-code-data" class="header-anchor">#</a> JSON(code,data)</h4> <p>传输json格式数据</p> <h4 id="query-key"><a href="#query-key" class="header-anchor">#</a> Query(key)</h4> <p>获取请求对应key的querystring</p> <h4 id="defaultquery-key-defaultvalue"><a href="#defaultquery-key-defaultvalue" class="header-anchor">#</a> DefaultQuery(key,defaultValue)</h4> <p>类似于Query，但是提供默认值</p> <h4 id="getquery-key"><a href="#getquery-key" class="header-anchor">#</a> GetQuery(key)</h4> <p>类似于Query，返回参数多了一个是否存在，如果不存在返回false</p> <h4 id="param-path"><a href="#param-path" class="header-anchor">#</a> Param(path)</h4> <p>当路由为动态路由时，使用Param(path)获取动态路由的id</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//Default返回一个默认的路由引擎</span>
	r <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/user/search/:username/:address&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		username <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span>
		address <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">)</span>
		<span class="token comment">//输出json结果给调用方</span>
		c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
			<span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span>  <span class="token string">&quot;ok&quot;</span><span class="token punctuation">,</span>
			<span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span>
			<span class="token string">&quot;address&quot;</span><span class="token punctuation">:</span>  address<span class="token punctuation">,</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	r<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="postform-key"><a href="#postform-key" class="header-anchor">#</a> PostForm(key)</h4> <p>如果请求为post类型的form表单数据时，通过PostForm(key)获取value，<code>DefaultPostForm</code>还可以添加默认值</p> <h4 id="bindjson"><a href="#bindjson" class="header-anchor">#</a> BindJSON</h4> <p>解析参数</p> <h4 id="shouldbind-struct"><a href="#shouldbind-struct" class="header-anchor">#</a> ShouldBind(* struct)</h4> <p>简写取参数的动作，直接从结构体中绑定querystring中相对应的参数,参数接收指针类型的结构体，无论前端传的是哪种<code>Content-Type</code>,都会被解析。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Binding from JSON</span>
<span class="token keyword">type</span> Login <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	User     <span class="token builtin">string</span> <span class="token string">`form:&quot;user&quot; json:&quot;user&quot; binding:&quot;required&quot;`</span>
	Password <span class="token builtin">string</span> <span class="token string">`form:&quot;password&quot; json:&quot;password&quot; binding:&quot;required&quot;`</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	router <span class="token operator">:=</span> gin<span class="token punctuation">.</span><span class="token function">Default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">// 绑定JSON的示例 ({&quot;user&quot;: &quot;q1mi&quot;, &quot;password&quot;: &quot;123456&quot;})</span>
	router<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span><span class="token string">&quot;/loginJSON&quot;</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> login Login
		<span class="token keyword">if</span> err <span class="token operator">:=</span> c<span class="token punctuation">.</span><span class="token function">ShouldBind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>login<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;login info:%#v\n&quot;</span><span class="token punctuation">,</span> login<span class="token punctuation">)</span>
			c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusOK<span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span>
				<span class="token string">&quot;user&quot;</span><span class="token punctuation">:</span>     login<span class="token punctuation">.</span>User<span class="token punctuation">,</span>
				<span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> login<span class="token punctuation">.</span>Password<span class="token punctuation">,</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			c<span class="token punctuation">.</span><span class="token function">JSON</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>StatusBadRequest<span class="token punctuation">,</span> gin<span class="token punctuation">.</span>H<span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">:</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// Listen and serve on 0.0.0.0:8080</span>
	router<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token string">&quot;:8080&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="formfile-name"><a href="#formfile-name" class="header-anchor">#</a> FormFile(name)</h4> <p>接收上传文件时使用。返回匹配到name的第一个值</p> <h4 id="saveuploadedfile-file-path"><a href="#saveuploadedfile-file-path" class="header-anchor">#</a> SaveUploadedFile(file,path)</h4> <p>保存上传文件</p> <h4 id="redirect-code-location"><a href="#redirect-code-location" class="header-anchor">#</a> Redirect(code,location)</h4> <p>重定向到外部链接，想要内部重定向使用：</p> <div class="language-go extra-class"><pre class="language-go"><code>r<span class="token punctuation">.</span><span class="token function">GET</span><span class="token punctuation">(</span><span class="token string">&quot;/a&quot;</span><span class="token punctuation">,</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span><span class="token punctuation">{</span>
  c<span class="token punctuation">.</span>Request<span class="token punctuation">.</span>URL<span class="token punctuation">.</span>Path<span class="token operator">=</span><span class="token string">&quot;/b&quot;</span> <span class="token comment">// 修改请求地址</span>
  r<span class="token punctuation">.</span><span class="token function">HandleContext</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token comment">// 继续后续的处理</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="next"><a href="#next" class="header-anchor">#</a> Next()</h4> <p>跳过当前中间件，将执行控制权交给下一个中间件，当后边的中间件执行完毕后，会继续执行当前上下文之后的代码</p> <h4 id="abort"><a href="#abort" class="header-anchor">#</a> Abort()</h4> <p>阻止后续中间件的执行，会执行完当前上下文代码后继续执行上一层中间件。</p> <h4 id="set-key-value"><a href="#set-key-value" class="header-anchor">#</a> Set(key,value)</h4> <p>在上下文中传递状态时用到，set值之后不同的中间件可以共享这个状态</p> <h4 id="get-key"><a href="#get-key" class="header-anchor">#</a> Get(key)</h4> <p>获取上下文中定义的key</p> <h3 id="h"><a href="#h" class="header-anchor">#</a> H</h3> <p>gin内部提供了<code>map[string]interface{}</code>类型的简写：<code>gin.H</code></p> <h2 id="gorm"><a href="#gorm" class="header-anchor">#</a> GORM</h2> <h3 id="简介-2"><a href="#简介-2" class="header-anchor">#</a> 简介</h3> <p>安装：<code>go get -u gorm.io/gorm</code>,<code>go get -u gorm.io/driver/sqlite</code>,<code>go get -u gorm.io/driver/mysql</code></p> <p>代码中导入相关数据库驱动：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;gorm.io/driver/mysql&quot;</span>
	<span class="token string">&quot;gorm.io/gorm&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div><p>数据表用结构体来表示</p> <p>数据行用结构体实例来表示</p> <p>字段用结构体字段表示</p> <h4 id="立即执行方法"><a href="#立即执行方法" class="header-anchor">#</a> 立即执行方法</h4> <p>立即执行方法是指那些会立即生成sql语句病发送到数据库的方法，一般时CRUD方法，例如：<code>Create、Frist、Find、Take、Save、UpdateXXX、Delete、Scan、Row、Rows</code></p> <h4 id="orm"><a href="#orm" class="header-anchor">#</a> ORM</h4> <p>什么是orm，分别代表对象、关系、映射，也就是用代码中的对象来编写关系型数据库</p> <p>orm的优点：提高开发效率</p> <p>orm的缺点：牺牲执行性能、牺牲灵活性、弱化SQL能力</p> <h3 id="context-2"><a href="#context-2" class="header-anchor">#</a> Context</h3> <h4 id="withcontext"><a href="#withcontext" class="header-anchor">#</a> WithContext</h4> <p>关联上下文</p> <h3 id="高级查询"><a href="#高级查询" class="header-anchor">#</a> 高级查询</h3> <h4 id="findinbatches"><a href="#findinbatches" class="header-anchor">#</a> FindInBatches</h4> <p>批量查询并处理记录</p> <h4 id="firstorinit"><a href="#firstorinit" class="header-anchor">#</a> FirstOrInit</h4> <p>获取第一条匹配的数据，如果没有则根据给定的条件(仅支持 sturct 和 map 条件)初始化一个实例,如果查询到则Attrs不生效。这些改动不会被保存到数据库。</p> <div class="language-go extra-class"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">&quot;no_existing&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Attrs</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Age<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">FirstOrInit</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</code></pre></div><h4 id="firstorcreate"><a href="#firstorcreate" class="header-anchor">#</a> FirstOrCreate</h4> <p>与FirstOrInit不同，FirstOrCreate会将结果写会数据库。获取第一条匹配的记录，或者根据给定的条件（仅支持struct和map条件）更新一条新记录，不管是否找到记录<code>Assing</code>都会将属性赋值给struct。Assgin不管是否查询到都讲属性赋值给实例。</p> <div class="language-go extra-class"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;non_existing&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Assign</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Age<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">FirstOrCreate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</code></pre></div><h3 id="声明模型"><a href="#声明模型" class="header-anchor">#</a> 声明模型</h3> <h4 id="gorm-model"><a href="#gorm-model" class="header-anchor">#</a> gorm.Model</h4> <p>GORM 定义一个 <code>gorm.Model</code> 结构体，其包括字段 <code>ID</code>、<code>CreatedAt</code>、<code>UpdatedAt</code>、<code>DeletedAt</code>,可以将它嵌入结构体中</p> <h3 id="连接数据库"><a href="#连接数据库" class="header-anchor">#</a> 连接数据库</h3> <div class="language-go extra-class"><pre class="language-go"><code>DB<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> gorm<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>mysql<span class="token punctuation">.</span>Config<span class="token punctuation">{</span>
		DSN<span class="token punctuation">:</span><span class="token string">&quot;root:baixiaoyu2997@tcp(127.0.0.1:3306)/db1?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Config<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="迁移"><a href="#迁移" class="header-anchor">#</a> 迁移</h3> <h4 id="automigrate"><a href="#automigrate" class="header-anchor">#</a> AutoMigrate</h4> <p>用于自动前一schema保持schema是最新的</p> <h3 id="创建"><a href="#创建" class="header-anchor">#</a> 创建</h3> <h4 id="create-2"><a href="#create-2" class="header-anchor">#</a> Create</h4> <p>通过数据的指针来创建一条记录，通过在结构体的tag中制定default来设置默认值。</p> <div class="language- extra-class"><pre class="language-text"><code>type User struct{
	ID int64
	Name string `grom:&quot;default:'张三'&quot;`
}
</code></pre></div><p>当插入数据时，如果值显示设置为 零值，并且该字段设置了默认值，那么会优先使用默认值。</p> <p>如果想解决上边的问题，那么有两种方法：</p> <ol><li>使用指针</li> <li>使用Scanner/Valuer</li></ol> <h4 id="批量插入"><a href="#批量插入" class="header-anchor">#</a> 批量插入</h4> <p>Create支持使用slice批量插入</p> <p>使用<code>CreateInBatches(users,100)</code>还可以指定数量</p> <h4 id="关联创建"><a href="#关联创建" class="header-anchor">#</a> 关联创建</h4> <div class="language-go extra-class"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span>
  Name<span class="token punctuation">:</span> <span class="token string">&quot;jinzhu&quot;</span><span class="token punctuation">,</span>
  CreditCard<span class="token punctuation">:</span> CreditCard<span class="token punctuation">{</span>Number<span class="token punctuation">:</span> <span class="token string">&quot;411111111111&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h3> <h4 id="first"><a href="#first" class="header-anchor">#</a> First</h4> <p>根据主键查询第一条记录</p> <h4 id="find"><a href="#find" class="header-anchor">#</a> Find</h4> <p>查询所有记录，第二个参数</p> <h4 id="take"><a href="#take" class="header-anchor">#</a> Take</h4> <p>随机获取一条记录</p> <h4 id="last"><a href="#last" class="header-anchor">#</a> Last</h4> <p>根据主键查询最后一条数据</p> <h4 id="where"><a href="#where" class="header-anchor">#</a> where</h4> <p>where方法有多种写法，第一种与普通sql的where一致，语法：</p> <div class="language- extra-class"><pre class="language-text"><code>db.Where(&quot;name = ?&quot;,&quot;jinzhu&quot;).First(&amp;user) // 查询name=jinzhu的数据
</code></pre></div><p>第二种使用Struct和Map查询：</p> <div class="language- extra-class"><pre class="language-text"><code>db.Where(map[string]interface{}{&quot;name&quot;:&quot;jinzhu&quot;}).Find(&amp;users)
</code></pre></div><p>通过结构体进行查询时，将不会查询零值，想要查询零值的话使用map</p> <h4 id="not"><a href="#not" class="header-anchor">#</a> Not</h4> <p>用法与where类似</p> <h4 id="or"><a href="#or" class="header-anchor">#</a> Or</h4> <p>用法与where类似</p> <h4 id="select-2"><a href="#select-2" class="header-anchor">#</a> Select</h4> <p>选择查询返回的列</p> <h4 id="order"><a href="#order" class="header-anchor">#</a> Order</h4> <p>排序方式，可多个</p> <h4 id="limit"><a href="#limit" class="header-anchor">#</a> Limit</h4> <p>限制条数，当值为-1时，消除之前Limit的影响</p> <h4 id="offset"><a href="#offset" class="header-anchor">#</a> Offset</h4> <p>偏移量，当值为-1时，消除之前Offset的影响</p> <h4 id="scan"><a href="#scan" class="header-anchor">#</a> Scan</h4> <p>返回结果至struct，与Find类似</p> <h4 id="preload"><a href="#preload" class="header-anchor">#</a> Preload</h4> <p>想要查询关联表的数据，需要使用<code>Preload</code>预先加载，如果有关联表的关联表那么可以使用嵌套语法</p> <h3 id="更新"><a href="#更新" class="header-anchor">#</a> 更新</h3> <h4 id="save"><a href="#save" class="header-anchor">#</a> Save</h4> <p>保存所有字段，即使字段是零值，如果没有主键则直接插入数据</p> <h4 id="update"><a href="#update" class="header-anchor">#</a> Update</h4> <p>更新单个列的值，使用Update时需要指定条件，Update支持struct和map类型参数。使用struct更新时，默认只会更新非零值的字段。</p> <p>想要只更新指定的列，那么可以使用Select预先筛选出来</p> <h4 id="updates"><a href="#updates" class="header-anchor">#</a> Updates</h4> <p>更新多列，支持struct和map，只会更新非零值,如果接收的数据有很多，但是只想更新部分，需要在语句前加<code>Select</code>选定要更新的列,或者添加Omit忽略要更新的列。如果更新的时候想跳过hooks，那么使用<code>UpdateColumn</code>或者<code>UpdateColumns</code></p> <h4 id="omit"><a href="#omit" class="header-anchor">#</a> Omit</h4> <p>如果更新的时候想要忽略某个字段，name使用Omit</p> <h4 id="rowsaffected"><a href="#rowsaffected" class="header-anchor">#</a> RowsAffected</h4> <p>通过返回值的RowsAffected字段，可以获得更新的记录数。</p> <h4 id="更新关联数据"><a href="#更新关联数据" class="header-anchor">#</a> 更新关联数据</h4> <div class="language-go extra-class"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Session</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Session<span class="token punctuation">{</span>FullSaveAssociations<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Updates</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</code></pre></div><h4 id="使用sql表达式"><a href="#使用sql表达式" class="header-anchor">#</a> 使用SQL表达式</h4> <div class="language-go extra-class"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Model</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>product<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token string">&quot;price&quot;</span><span class="token punctuation">,</span> gorm<span class="token punctuation">.</span><span class="token function">Expr</span><span class="token punctuation">(</span><span class="token string">&quot;price * ? + ?&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 价格变为原来的2倍+100</span>
</code></pre></div><h3 id="删除"><a href="#删除" class="header-anchor">#</a> 删除</h3> <h4 id="delete-2"><a href="#delete-2" class="header-anchor">#</a> Delete</h4> <p>给定主键时，删除一条记录，否则会批量删除</p> <h4 id="软删除"><a href="#软删除" class="header-anchor">#</a> 软删除</h4> <p>如果模型中包含DeleteAt，它将自动获得软删除的能力。不通过gorm.Model，手动开启软删除在模型中添加:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  ID      <span class="token builtin">int</span>
  Deleted gorm<span class="token punctuation">.</span>DeletedAt
  Name    <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以通过<code>Unscoped</code>方法找到软删除的记录。</p> <h4 id="硬删除"><a href="#硬删除" class="header-anchor">#</a> 硬删除</h4> <div class="language-go extra-class"><pre class="language-go"><code>db<span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>order<span class="token punctuation">)</span>
<span class="token comment">// DELETE FROM orders WHERE id=10;</span>
</code></pre></div><h4 id="delete-flag"><a href="#delete-flag" class="header-anchor">#</a> Delete Flag</h4> <p>将 unix 时间戳作为 delete flag</p> <div class="language-GO extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token string">&quot;gorm.io/plugin/soft_delete&quot;</span>
<span class="token keyword">type</span> User <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  ID        <span class="token builtin">uint</span>
  Name      <span class="token builtin">string</span>
  DeletedAt soft_delete<span class="token punctuation">.</span>DeletedAt
<span class="token punctuation">}</span>
</code></pre></div><h3 id="scope"><a href="#scope" class="header-anchor">#</a> scope</h3> <p>复用逻辑，把共通的查询逻辑写成<code>func(*gorm.DB) *gorm.DB</code>函数使用。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">AmountGreaterThan1000</span><span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;amount &gt; ?&quot;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">PaidWithCreditCard</span><span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;pay_mode_sign = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">PaidWithCod</span><span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;pay_mode_sign = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">OrderStatus</span><span class="token punctuation">(</span>status <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>db <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB <span class="token punctuation">{</span>
    <span class="token keyword">return</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;status IN (?)&quot;</span><span class="token punctuation">,</span> status<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">,</span> PaidWithCreditCard<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>orders<span class="token punctuation">)</span>
<span class="token comment">// 查找所有金额大于 1000 的信用卡订单</span>
db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">,</span> PaidWithCod<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>orders<span class="token punctuation">)</span>
<span class="token comment">// 查找所有金额大于 1000 的 COD 订单</span>
db<span class="token punctuation">.</span><span class="token function">Scopes</span><span class="token punctuation">(</span>AmountGreaterThan1000<span class="token punctuation">,</span> <span class="token function">OrderStatus</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;paid&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;shipped&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>orders<span class="token punctuation">)</span>
<span class="token comment">// 查找所有金额大于1000 的已付款或已发货订单</span>
</code></pre></div><h3 id="表"><a href="#表" class="header-anchor">#</a> 表</h3> <h4 id="清空整个表"><a href="#清空整个表" class="header-anchor">#</a> 清空整个表</h4> <p>两种方法：</p> <ol><li><code>db.Migrator().DropTable(&amp;User{}) 删除表</code></li> <li>清空表</li></ol> <div class="language-go extra-class"><pre class="language-go"><code> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;1 = 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 db<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span><span class="token string">&quot;truncate table users&quot;</span><span class="token punctuation">)</span>
 db<span class="token punctuation">.</span><span class="token function">Session</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Session<span class="token punctuation">{</span>AllowGlobalUpdate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>参考：https://www.cnblogs.com/sss4/p/14163524.html</p> <h4 id="重命名表"><a href="#重命名表" class="header-anchor">#</a> 重命名表</h4> <p><code>db.Migrator().ReanameTable(&amp;User{},&amp;User2{})</code></p> <h4 id="是否存在表"><a href="#是否存在表" class="header-anchor">#</a> 是否存在表</h4> <p><code>db.Migrator().HasTable(&amp;User{})</code></p> <h3 id="实例方法"><a href="#实例方法" class="header-anchor">#</a> 实例方法</h3> <h4 id="singulartable-bool"><a href="#singulartable-bool" class="header-anchor">#</a> SingularTable(bool)</h4> <p>禁用默认表名的复数形式，如果设置为true，则表名不带s</p> <h4 id="table-name"><a href="#table-name" class="header-anchor">#</a> Table(name)</h4> <p>制定要操作某一个表</p> <h4 id="migrator-createtable-type"><a href="#migrator-createtable-type" class="header-anchor">#</a> Migrator().CreateTable(&amp;type)</h4> <p>手动创建表</p> <h4 id="newrecord-type"><a href="#newrecord-type" class="header-anchor">#</a> NewRecord(&amp;type)</h4> <p>判断数据库该数据主键是否为空</p> <h4 id="raw"><a href="#raw" class="header-anchor">#</a> Raw</h4> <p>原生sql查询</p> <h3 id="debug"><a href="#debug" class="header-anchor">#</a> Debug</h3> <p>在任何操作语句前面加上<code>Debug()</code>都会在控制台打印对应的<code>sql</code>命令</p> <h3 id="钩子"><a href="#钩子" class="header-anchor">#</a> 钩子</h3> <p>创建、查询、更新、删除等操作之前、之后调用的函数</p> <h4 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h4> <ol><li><p>如何将零值存入数据库？</p> <blockquote><ol><li>使用指针的方式</li> <li>使用Scanner/Valuer</li> <li>Save</li></ol></blockquote></li></ol> <h2 id="goquery"><a href="#goquery" class="header-anchor">#</a> Goquery</h2> <h3 id="find-2"><a href="#find-2" class="header-anchor">#</a> Find</h3> <p>类似querySelectorAll，返回<code>Selection</code>，可以链式调用</p> <h3 id="first-2"><a href="#first-2" class="header-anchor">#</a> First</h3> <p>返回查找到的第一个</p> <h2 id="爬虫"><a href="#爬虫" class="header-anchor">#</a> 爬虫</h2> <h3 id="动态页面"><a href="#动态页面" class="header-anchor">#</a> 动态页面</h3> <p>直接调访问的接口即可</p> <h3 id="静态页面"><a href="#静态页面" class="header-anchor">#</a> 静态页面</h3> <p>使用 <code>goquery</code> 库</p> <h3 id="静态文件处理"><a href="#静态文件处理" class="header-anchor">#</a> 静态文件处理</h3> <p>相对路径的文件都下载到本地，获取静态文件可以参考这个回答：https://github.com/chromedp/chromedp/issues/760#issuecomment-786340809,</p> <p>可以通过监听<code>Network.responseReceived</code>事件，保存文件，参考：https://stackoverflow.com/questions/53640405/puppeteer-save-webpage-and-images</p> <h2 id="工程化"><a href="#工程化" class="header-anchor">#</a> 工程化</h2> <h3 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h3> <h4 id="流程"><a href="#流程" class="header-anchor">#</a> 流程</h4> <p><code>URL --&gt; routers --&gt; controller --&gt; logic--&gt; model --&gt;</code></p> <h4 id="controller"><a href="#controller" class="header-anchor">#</a> controller</h4> <p>负责解析路由的控制器方法</p> <h4 id="routers"><a href="#routers" class="header-anchor">#</a> routers</h4> <p>路由相关绑定</p> <h4 id="templates"><a href="#templates" class="header-anchor">#</a> templates</h4> <p>模板</p> <h4 id="dao"><a href="#dao" class="header-anchor">#</a> dao</h4> <p>数据库初始化相关代码</p> <h4 id="static"><a href="#static" class="header-anchor">#</a> static</h4> <p>模板静态文件</p> <h4 id="models"><a href="#models" class="header-anchor">#</a> models</h4> <p>模型的定义及相关的增删改查操作</p> <h4 id="login"><a href="#login" class="header-anchor">#</a> login</h4> <p>具体的业务功能</p> <h2 id="微服务"><a href="#微服务" class="header-anchor">#</a> 微服务</h2> <h3 id="rpc"><a href="#rpc" class="header-anchor">#</a> RPC</h3> <p>远程过程调用（Remote Procedure Call，RPC）是一个计算机通信协议。</p> <p>该协议允许运行一台计算机的程序调用另一台计算机的子程序</p> <p>golang的rpc必须符合4个基本条件：</p> <div class="language- extra-class"><pre class="language-text"><code>结构体字段首字母要大写，可以别人调用
函数名必须首字母大写
函数第一参数是接收参数，第二个参数是返回给客户端的参数，必须是指针类型
函数还必须有一个返回值error
</code></pre></div><p>微服务架构下数据交互一般是对内 RPC，对外 REST</p> <h2 id="最佳实践"><a href="#最佳实践" class="header-anchor">#</a> 最佳实践</h2> <h3 id="浮点类型计算"><a href="#浮点类型计算" class="header-anchor">#</a> 浮点类型计算</h3> <p>未了尽量最小化舍入错误，尽量先做乘法，再做除法</p> <h3 id="时间变量类型"><a href="#时间变量类型" class="header-anchor">#</a> 时间变量类型</h3> <p>应该使用int64或者uint64,因为到2038年就会超过int32的最大数。</p> <h3 id="函数参数为数组"><a href="#函数参数为数组" class="header-anchor">#</a> 函数参数为数组</h3> <p>尽量使用切片而不是数组，这样性能会好点。</p> <h3 id="函数变量"><a href="#函数变量" class="header-anchor">#</a> 函数变量</h3> <p>检查函数值是否为<code>nil</code>,并在有需要时提供默认行为</p> <h3 id="错误处理"><a href="#错误处理" class="header-anchor">#</a> 错误处理</h3> <p>减少错误处理代码的一种策略时：将易错的代码和不会出错的代码隔离开</p> <h2 id="问题-2"><a href="#问题-2" class="header-anchor">#</a> 问题</h2> <h3 id="如何判断数据类型"><a href="#如何判断数据类型" class="header-anchor">#</a> 如何判断数据类型？</h3> <ol><li>在业务代码中使用<code>reflect.TypeOf(xxx)</code></li> <li>在print中使用<code>fmt.Printf(&quot;%T&quot;, p)</code></li></ol> <h3 id="如何把字符转换成int"><a href="#如何把字符转换成int" class="header-anchor">#</a> 如何把字符转换成int？</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">int</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token string">'0'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="数字转换成字符串乱码"><a href="#数字转换成字符串乱码" class="header-anchor">#</a> 数字转换成字符串乱码？</h3> <p>这个数字超出了code point范围</p> <h3 id="如何判断字符串都是中文"><a href="#如何判断字符串都是中文" class="header-anchor">#</a> 如何判断字符串都是中文？</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">if</span> m<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">MatchString</span><span class="token punctuation">(</span><span class="token string">&quot;^\\p{Han}+$&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>Form<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;realname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">!</span>m <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="如何判断字符串都是英文"><a href="#如何判断字符串都是英文" class="header-anchor">#</a> 如何判断字符串都是英文？</h3> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">if</span> m<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">MatchString</span><span class="token punctuation">(</span><span class="token string">&quot;^[a-zA-Z]+$&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>Form<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;engname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">!</span>m <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="什么时候会触发panic"><a href="#什么时候会触发panic" class="header-anchor">#</a> 什么时候会触发panic</h3> <ol><li>对值为nil的map添加元素</li></ol> <h3 id="go爬虫需要注意什么"><a href="#go爬虫需要注意什么" class="header-anchor">#</a> go爬虫需要注意什么？</h3> <p>流程：</p> <ol><li>获取页面所有url</li> <li>去重、判断链接是否有效</li> <li>timeout</li> <li>使用gorm时注意要使用UTF-8编码，如果不是需要转换</li></ol> <h2 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h2> <ol><li><a href="https://zhuanlan.zhihu.com/p/75373075" target="_blank" rel="noopener noreferrer">Go语言设计和工具链核心团队成员介绍<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-11-10
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2021-08-04
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2020/11/09/koa%E6%8C%87%E5%8D%97.html" class="post-link" data-v-4e23451f>
      上一篇 : koa指南
    </a> <a href="/posts/2020/11/10/go-micro%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html" class="post-link" data-v-4e23451f>
      下一篇 : go-micro学习指南
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" data-v-9d847660><img src="https://blog-pic.oss-cn-beijing.aliyuncs.com/avatar.webp" alt="L.Rain" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      L.Rain
    </section> <section class="info-desc" data-v-9d847660>真实、自由、宽容</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="ChengDu City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ChengDu City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ChengDu City, China
        </span></span></section> <section data-v-9d847660><span title="ChengDu YeeYun Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ChengDu YeeYun Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ChengDu YeeYun Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:bxy2997@sina.com" title="bxy2997@sina.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>bxy2997@sina.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          bxy2997@sina.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/baixiaoyu2997" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: L.Rain" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: L.Rain</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a><a href="https://weibo.com/1504398495" target="_blank" class="sns-link" data-v-9d847660><span title="新浪微博: 白晓宇V" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>新浪微博: 白晓宇V</title><use xlink:href="#icon-weibo" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#介绍">介绍</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#学习资源">学习资源</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#安装">安装</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#编辑器">编辑器</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#名词解释">名词解释</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#类型别名">类型别名</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#环绕行为">环绕行为</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#goroutine">goroutine</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#worker">worker</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#文档">文档</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#type-assertion">Type Assertion</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#errors">Errors</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#statements-声明">Statements（声明）</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#词汇元素">词汇元素</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#declarations-and-scope">Declarations and scope</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#package">package</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#函数">函数</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#基本类型">基本类型</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#其他类型">其他类型</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#流程控制语句">流程控制语句</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#结构体-2">结构体</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#内置函数">内置函数</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#mod">mod</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#go-get">go get</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#package-2">package</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#embed">embed</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#strings">strings</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#strconv">strconv</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#fmt">fmt</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#unicode">unicode</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#encoding">encoding</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#http">http</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#html">html</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#io">io</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#os">os</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#sync">sync</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#time">time</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#gin框架">Gin框架</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#简介">简介</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#初始化">初始化</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#default">Default()</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#new">New()</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#engine">Engine</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#context">Context</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#h">H</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#gorm">GORM</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#简介-2">简介</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#context-2">Context</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#高级查询">高级查询</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#声明模型">声明模型</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#连接数据库">连接数据库</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#迁移">迁移</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#创建">创建</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#查询">查询</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#更新">更新</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#删除">删除</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#scope">scope</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#表">表</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#实例方法">实例方法</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#debug">Debug</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#钩子">钩子</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#goquery">Goquery</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#find-2">Find</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#first-2">First</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#爬虫">爬虫</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#动态页面">动态页面</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#静态页面">静态页面</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#静态文件处理">静态文件处理</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#工程化">工程化</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#目录结构">目录结构</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#微服务">微服务</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#rpc">RPC</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#最佳实践">最佳实践</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#浮点类型计算">浮点类型计算</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#时间变量类型">时间变量类型</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#函数参数为数组">函数参数为数组</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#函数变量">函数变量</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#错误处理">错误处理</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#问题-2">问题</a><ul><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#如何判断数据类型">如何判断数据类型？</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#如何把字符转换成int">如何把字符转换成int？</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#数字转换成字符串乱码">数字转换成字符串乱码？</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#如何判断字符串都是中文">如何判断字符串都是中文？</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#如何判断字符串都是英文">如何判断字符串都是英文？</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#什么时候会触发panic">什么时候会触发panic</a></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#go爬虫需要注意什么">go爬虫需要注意什么？</a></li></ul></li><li><a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#其他">其他</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2020/11/10/golang%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/baixiaoyu2997" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: L.Rain" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: L.Rain</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a><a href="https://weibo.com/1504398495" target="_blank" class="sns-link" data-v-1375e54c><span title="新浪微博: 白晓宇V" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>新浪微博: 白晓宇V</title><use xlink:href="#icon-weibo" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <!----></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.9a385967.js" defer></script><script src="/assets/js/7.8545d9f8.js" defer></script><script src="/assets/js/51.53d3189f.js" defer></script>
  </body>
</html>
