<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MongoDB指南 | L.Rain的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <meta name="description" content="L.Rain的博客">
    <link rel="preload" href="/assets/css/0.styles.0b94e76f.css" as="style"><link rel="preload" href="/assets/js/app.9324d2ff.js" as="script"><link rel="preload" href="/assets/js/7.8545d9f8.js" as="script"><link rel="preload" href="/assets/js/27.c58d5520.js" as="script"><link rel="prefetch" href="/assets/js/1.f6e0f07f.js"><link rel="prefetch" href="/assets/js/10.4a6afb4e.js"><link rel="prefetch" href="/assets/js/100.b98d55aa.js"><link rel="prefetch" href="/assets/js/101.586bf41f.js"><link rel="prefetch" href="/assets/js/102.ce7d5cb2.js"><link rel="prefetch" href="/assets/js/11.d13437d4.js"><link rel="prefetch" href="/assets/js/12.7d7635cb.js"><link rel="prefetch" href="/assets/js/13.919964bf.js"><link rel="prefetch" href="/assets/js/14.7ab77631.js"><link rel="prefetch" href="/assets/js/15.610bd4c1.js"><link rel="prefetch" href="/assets/js/16.911a5ae9.js"><link rel="prefetch" href="/assets/js/17.601875a5.js"><link rel="prefetch" href="/assets/js/18.cdbf1e01.js"><link rel="prefetch" href="/assets/js/19.e5b3faeb.js"><link rel="prefetch" href="/assets/js/20.fb105d14.js"><link rel="prefetch" href="/assets/js/21.f8779953.js"><link rel="prefetch" href="/assets/js/22.013cddab.js"><link rel="prefetch" href="/assets/js/23.d2d0200d.js"><link rel="prefetch" href="/assets/js/24.a4bf473c.js"><link rel="prefetch" href="/assets/js/25.67d033df.js"><link rel="prefetch" href="/assets/js/26.e52b5070.js"><link rel="prefetch" href="/assets/js/28.ffea5f26.js"><link rel="prefetch" href="/assets/js/29.9a1a1888.js"><link rel="prefetch" href="/assets/js/3.abcd40dc.js"><link rel="prefetch" href="/assets/js/30.1003f92c.js"><link rel="prefetch" href="/assets/js/31.b376d659.js"><link rel="prefetch" href="/assets/js/32.5adf5558.js"><link rel="prefetch" href="/assets/js/33.6655144a.js"><link rel="prefetch" href="/assets/js/34.6e321214.js"><link rel="prefetch" href="/assets/js/35.b1e2f5d1.js"><link rel="prefetch" href="/assets/js/36.2c3f4fb0.js"><link rel="prefetch" href="/assets/js/37.0fcdbcdb.js"><link rel="prefetch" href="/assets/js/38.9824fdb0.js"><link rel="prefetch" href="/assets/js/39.94846118.js"><link rel="prefetch" href="/assets/js/4.037891d1.js"><link rel="prefetch" href="/assets/js/40.211d2373.js"><link rel="prefetch" href="/assets/js/41.5904d463.js"><link rel="prefetch" href="/assets/js/42.d9ec67ba.js"><link rel="prefetch" href="/assets/js/43.22b9f9a4.js"><link rel="prefetch" href="/assets/js/44.19f84f5c.js"><link rel="prefetch" href="/assets/js/45.53ce2212.js"><link rel="prefetch" href="/assets/js/46.711d321a.js"><link rel="prefetch" href="/assets/js/47.fa2d3b03.js"><link rel="prefetch" href="/assets/js/48.d701fa9b.js"><link rel="prefetch" href="/assets/js/49.b984ba66.js"><link rel="prefetch" href="/assets/js/5.023c6154.js"><link rel="prefetch" href="/assets/js/50.629a8383.js"><link rel="prefetch" href="/assets/js/51.d0e25afd.js"><link rel="prefetch" href="/assets/js/52.b57c32cf.js"><link rel="prefetch" href="/assets/js/53.0c8a8212.js"><link rel="prefetch" href="/assets/js/54.ee34d505.js"><link rel="prefetch" href="/assets/js/55.a92ccd5d.js"><link rel="prefetch" href="/assets/js/56.9a66062d.js"><link rel="prefetch" href="/assets/js/57.26e695c3.js"><link rel="prefetch" href="/assets/js/58.b4646b7c.js"><link rel="prefetch" href="/assets/js/59.04481ea3.js"><link rel="prefetch" href="/assets/js/6.118b5a7a.js"><link rel="prefetch" href="/assets/js/60.ade358bb.js"><link rel="prefetch" href="/assets/js/61.89ddfcec.js"><link rel="prefetch" href="/assets/js/62.91e41fa8.js"><link rel="prefetch" href="/assets/js/63.d36d79a9.js"><link rel="prefetch" href="/assets/js/64.fe5c9e38.js"><link rel="prefetch" href="/assets/js/65.8ad87539.js"><link rel="prefetch" href="/assets/js/66.cc166559.js"><link rel="prefetch" href="/assets/js/67.73119f21.js"><link rel="prefetch" href="/assets/js/68.9e33a20d.js"><link rel="prefetch" href="/assets/js/69.8080253c.js"><link rel="prefetch" href="/assets/js/70.596e9001.js"><link rel="prefetch" href="/assets/js/71.296a511a.js"><link rel="prefetch" href="/assets/js/72.bcecac18.js"><link rel="prefetch" href="/assets/js/73.33be5503.js"><link rel="prefetch" href="/assets/js/74.6fc91345.js"><link rel="prefetch" href="/assets/js/75.db327d9f.js"><link rel="prefetch" href="/assets/js/76.b8e3568a.js"><link rel="prefetch" href="/assets/js/77.07c40e16.js"><link rel="prefetch" href="/assets/js/78.2653a54e.js"><link rel="prefetch" href="/assets/js/79.dfa63043.js"><link rel="prefetch" href="/assets/js/8.51c6e2dd.js"><link rel="prefetch" href="/assets/js/80.e627a2d5.js"><link rel="prefetch" href="/assets/js/81.6efe8e5e.js"><link rel="prefetch" href="/assets/js/82.45fa6969.js"><link rel="prefetch" href="/assets/js/83.7eb98d57.js"><link rel="prefetch" href="/assets/js/84.6782fe47.js"><link rel="prefetch" href="/assets/js/85.6063c63f.js"><link rel="prefetch" href="/assets/js/86.c6d4caa0.js"><link rel="prefetch" href="/assets/js/87.0d25d5af.js"><link rel="prefetch" href="/assets/js/88.4d59c911.js"><link rel="prefetch" href="/assets/js/89.eb7107e9.js"><link rel="prefetch" href="/assets/js/9.50140b23.js"><link rel="prefetch" href="/assets/js/90.e328c878.js"><link rel="prefetch" href="/assets/js/91.16c69f34.js"><link rel="prefetch" href="/assets/js/92.f9513378.js"><link rel="prefetch" href="/assets/js/93.0b1e555f.js"><link rel="prefetch" href="/assets/js/94.65da01c6.js"><link rel="prefetch" href="/assets/js/95.7720da11.js"><link rel="prefetch" href="/assets/js/96.c65f5117.js"><link rel="prefetch" href="/assets/js/97.cd052ad6.js"><link rel="prefetch" href="/assets/js/98.ac2721e7.js"><link rel="prefetch" href="/assets/js/99.1af8b736.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b94e76f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(https://picsum.photos/1920/250.webp);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          L.Rain的博客
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/" class="navbar-link" data-v-e4145d0a>
            主页
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            分类
          </a><a href="https://github.com/baixiaoyu2997" target="_blank" rel="noopener noreferrer" class="navbar-link" data-v-e4145d0a><span data-v-e4145d0a>Github</span> <span data-v-e4145d0a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          MongoDB指南
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-11-13
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2020-12-05
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2020/11/10/go-micro%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html" class="post-link" data-v-4e23451f>
      上一篇 : go-micro学习指南
    </a> <a href="/posts/2021/01/23/tailwind-css%E5%AD%A6%E4%B9%A0.html" class="post-link" data-v-4e23451f>
      下一篇 : Tailwind.css学习
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><h1 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h1> <p>MongoDB 是非关系型数据库。</p> <p>MongoDB 的存储结构 以前我们的关系型数据库的数据结构都是顶层是库，库下面是表，表下面是数据。但是 MongoDB 有所不同，库下面是集合，集合下面是文档</p> <h2 id="下载"><a href="#下载" class="header-anchor">#</a> 下载</h2> <p>地址： https://www.mongodb.com/try/download/community</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p>参考官方文档：https://docs.mongodb.com/manual/tutorial/install-mongodb-on-os-x/#install-mongodb-community-edition</p> <p>安装完毕后，使用<code>mongod --config /usr/local/etc/mongod.conf --fork</code>命令启动,想要手动关闭使用命令<code>db.shutdownServer()</code></p> <p>如果成功了，那么会输出如下日志：</p> <div class="language-diff extra-class"><pre class="language-diff"><code>{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:31.986+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:23285,   &quot;ctx&quot;:&quot;main&quot;,&quot;msg&quot;:&quot;Automatically disabling TLS 1.0, to force-enable TLS 1.0 specify --sslDisabledProtocols 'none'&quot;}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:31.991+08:00&quot;},&quot;s&quot;:&quot;W&quot;,  &quot;c&quot;:&quot;ASIO&quot;,     &quot;id&quot;:22601,   &quot;ctx&quot;:&quot;main&quot;,&quot;msg&quot;:&quot;No TransportLayer configured during NetworkInterface startup&quot;}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:31.991+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;NETWORK&quot;,  &quot;id&quot;:4648602, &quot;ctx&quot;:&quot;main&quot;,&quot;msg&quot;:&quot;Implicit TCP FastOpen in use.&quot;}
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> {&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:31.991+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:4615611, &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;MongoDB starting&quot;,&quot;attr&quot;:{&quot;pid&quot;:2926,&quot;port&quot;:27017,&quot;dbPath&quot;:&quot;/data/db&quot;,&quot;architecture&quot;:&quot;64-bit&quot;,&quot;host&quot;:&quot;2997&quot;}}
</span></span>{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:31.991+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:23403,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Build Info&quot;,&quot;attr&quot;:{&quot;buildInfo&quot;:{&quot;version&quot;:&quot;4.4.1&quot;,&quot;gitVersion&quot;:&quot;ad91a93a5a31e175f5cbf8c69561e788bbc55ce1&quot;,&quot;modules&quot;:[],&quot;allocator&quot;:&quot;system&quot;,&quot;environment&quot;:{&quot;distarch&quot;:&quot;x86_64&quot;,&quot;target_arch&quot;:&quot;x86_64&quot;}}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:31.991+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:51765,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Operating System&quot;,&quot;attr&quot;:{&quot;os&quot;:{&quot;name&quot;:&quot;Mac OS X&quot;,&quot;version&quot;:&quot;19.6.0&quot;}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.000+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:21951,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Options set by command line&quot;,&quot;attr&quot;:{&quot;options&quot;:{}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.006+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:22315,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Opening WiredTiger&quot;,&quot;attr&quot;:{&quot;config&quot;:&quot;create,cache_size=7680M,session_max=33000,eviction=(threads_min=4,threads_max=4),config_base=false,statistics=(fast),log=(enabled=true,archive=true,path=journal,compressor=snappy),file_manager=(close_idle_time=100000,close_scan_interval=10,close_handle_minimum=250),statistics_log=(wait=0),verbose=[recovery_progress,checkpoint_progress,compact_progress],&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.539+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:22430,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;WiredTiger message&quot;,&quot;attr&quot;:{&quot;message&quot;:&quot;[1605248552:539974][2926:0x116f06dc0], txn-recover: [WT_VERB_RECOVERY | WT_VERB_RECOVERY_PROGRESS] Set global recovery timestamp: (0, 0)&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.540+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:22430,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;WiredTiger message&quot;,&quot;attr&quot;:{&quot;message&quot;:&quot;[1605248552:540061][2926:0x116f06dc0], txn-recover: [WT_VERB_RECOVERY | WT_VERB_RECOVERY_PROGRESS] Set global oldest timestamp: (0, 0)&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.585+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:4795906, &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;WiredTiger opened&quot;,&quot;attr&quot;:{&quot;durationMillis&quot;:579}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.585+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;RECOVERY&quot;, &quot;id&quot;:23987,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;WiredTiger recoveryTimestamp&quot;,&quot;attr&quot;:{&quot;recoveryTimestamp&quot;:{&quot;$timestamp&quot;:{&quot;t&quot;:0,&quot;i&quot;:0}}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.626+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:22262,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Timestamp monitor starting&quot;}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.627+08:00&quot;},&quot;s&quot;:&quot;W&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:22120,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Access control is not enabled for the database. Read and write access to data and configuration is unrestricted&quot;,&quot;tags&quot;:[&quot;startupWarnings&quot;]}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.627+08:00&quot;},&quot;s&quot;:&quot;W&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:22140,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;This server is bound to localhost. Remote systems will be unable to connect to this server. Start the server with --bind_ip &lt;address&gt; to specify which IP addresses it should serve responses from, or with --bind_ip_all to bind to all interfaces. If this behavior is desired, start the server with --bind_ip 127.0.0.1 to disable this warning&quot;,&quot;tags&quot;:[&quot;startupWarnings&quot;]}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.627+08:00&quot;},&quot;s&quot;:&quot;W&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:22184,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Soft rlimits too low&quot;,&quot;attr&quot;:{&quot;currentValue&quot;:8192,&quot;recommendedMinimum&quot;:64000},&quot;tags&quot;:[&quot;startupWarnings&quot;]}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.631+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:20320,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;createCollection&quot;,&quot;attr&quot;:{&quot;namespace&quot;:&quot;admin.system.version&quot;,&quot;uuidDisposition&quot;:&quot;provided&quot;,&quot;uuid&quot;:{&quot;uuid&quot;:{&quot;$uuid&quot;:&quot;6d53eaa2-0afd-4322-aa09-15203edca039&quot;}},&quot;options&quot;:{&quot;uuid&quot;:{&quot;$uuid&quot;:&quot;6d53eaa2-0afd-4322-aa09-15203edca039&quot;}}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.677+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;INDEX&quot;,    &quot;id&quot;:20345,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Index build: done building&quot;,&quot;attr&quot;:{&quot;buildUUID&quot;:null,&quot;namespace&quot;:&quot;admin.system.version&quot;,&quot;index&quot;:&quot;_id_&quot;,&quot;commitTimestamp&quot;:{&quot;$timestamp&quot;:{&quot;t&quot;:0,&quot;i&quot;:0}}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.679+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;COMMAND&quot;,  &quot;id&quot;:20459,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Setting featureCompatibilityVersion&quot;,&quot;attr&quot;:{&quot;newVersion&quot;:&quot;4.4&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.680+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:20536,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Flow Control is enabled on this deployment&quot;}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.682+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:20320,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;createCollection&quot;,&quot;attr&quot;:{&quot;namespace&quot;:&quot;local.startup_log&quot;,&quot;uuidDisposition&quot;:&quot;generated&quot;,&quot;uuid&quot;:{&quot;uuid&quot;:{&quot;$uuid&quot;:&quot;e1c9416f-df99-4ab4-8566-618b90fed819&quot;}},&quot;options&quot;:{&quot;capped&quot;:true,&quot;size&quot;:10485760}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.718+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;INDEX&quot;,    &quot;id&quot;:20345,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Index build: done building&quot;,&quot;attr&quot;:{&quot;buildUUID&quot;:null,&quot;namespace&quot;:&quot;local.startup_log&quot;,&quot;index&quot;:&quot;_id_&quot;,&quot;commitTimestamp&quot;:{&quot;$timestamp&quot;:{&quot;t&quot;:0,&quot;i&quot;:0}}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.718+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;FTDC&quot;,     &quot;id&quot;:20625,   &quot;ctx&quot;:&quot;initandlisten&quot;,&quot;msg&quot;:&quot;Initializing full-time diagnostic data capture&quot;,&quot;attr&quot;:{&quot;dataDirectory&quot;:&quot;/data/db/diagnostic.data&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.720+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;NETWORK&quot;,  &quot;id&quot;:23015,   &quot;ctx&quot;:&quot;listener&quot;,&quot;msg&quot;:&quot;Listening on&quot;,&quot;attr&quot;:{&quot;address&quot;:&quot;/tmp/mongodb-27017.sock&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.720+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;NETWORK&quot;,  &quot;id&quot;:23015,   &quot;ctx&quot;:&quot;listener&quot;,&quot;msg&quot;:&quot;Listening on&quot;,&quot;attr&quot;:{&quot;address&quot;:&quot;127.0.0.1&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.720+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;NETWORK&quot;,  &quot;id&quot;:23016,   &quot;ctx&quot;:&quot;listener&quot;,&quot;msg&quot;:&quot;Waiting for connections&quot;,&quot;attr&quot;:{&quot;port&quot;:27017,&quot;ssl&quot;:&quot;off&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.722+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;CONTROL&quot;,  &quot;id&quot;:20712,   &quot;ctx&quot;:&quot;LogicalSessionCacheReap&quot;,&quot;msg&quot;:&quot;Sessions collection is not set up; waiting until next sessions reap interval&quot;,&quot;attr&quot;:{&quot;error&quot;:&quot;NamespaceNotFound: config.system.sessions does not exist&quot;}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.722+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;STORAGE&quot;,  &quot;id&quot;:20320,   &quot;ctx&quot;:&quot;LogicalSessionCacheRefresh&quot;,&quot;msg&quot;:&quot;createCollection&quot;,&quot;attr&quot;:{&quot;namespace&quot;:&quot;config.system.sessions&quot;,&quot;uuidDisposition&quot;:&quot;generated&quot;,&quot;uuid&quot;:{&quot;uuid&quot;:{&quot;$uuid&quot;:&quot;f33a4f9e-c6ea-439d-a042-89ef5c27a705&quot;}},&quot;options&quot;:{}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.782+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;INDEX&quot;,    &quot;id&quot;:20345,   &quot;ctx&quot;:&quot;LogicalSessionCacheRefresh&quot;,&quot;msg&quot;:&quot;Index build: done building&quot;,&quot;attr&quot;:{&quot;buildUUID&quot;:null,&quot;namespace&quot;:&quot;config.system.sessions&quot;,&quot;index&quot;:&quot;_id_&quot;,&quot;commitTimestamp&quot;:{&quot;$timestamp&quot;:{&quot;t&quot;:0,&quot;i&quot;:0}}}}
{&quot;t&quot;:{&quot;$date&quot;:&quot;2020-11-13T14:22:32.782+08:00&quot;},&quot;s&quot;:&quot;I&quot;,  &quot;c&quot;:&quot;INDEX&quot;,    &quot;id&quot;:20345,   &quot;ctx&quot;:&quot;LogicalSessionCacheRefresh&quot;,&quot;msg&quot;:&quot;Index build: done building&quot;,&quot;attr&quot;:{&quot;buildUUID&quot;:null,&quot;namespace&quot;:&quot;config.system.sessions&quot;,&quot;index&quot;:&quot;lsidTTLIndex&quot;,&quot;commitTimestamp&quot;:{&quot;$timestamp&quot;:{&quot;t&quot;:0,&quot;i&quot;:0}}}}
</code></pre></div><p>代码高亮部分显示服务启动在端口<code>27017</code>上</p> <h3 id="连接数据库"><a href="#连接数据库" class="header-anchor">#</a> 连接数据库</h3> <p>现在数据库已经启动了，我们可以通过新打开一个命令行来对其操控：</p> <div class="language- extra-class"><pre class="language-text"><code>$ mongo
&gt; show dbs
admin 0.000GB
config 0.000GB
local 0.000GB
&gt; db.version()
4.4.1
</code></pre></div><h3 id="可执行文件"><a href="#可执行文件" class="header-anchor">#</a> 可执行文件</h3> <p>通过 shell 可以运行命令，但是太过于麻烦，<code>mongo</code>可以执行 js 文件（对的，你没看错，越来越像 node 了）,编写 js 文件：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// goTask.js</span>
<span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token string">&quot;L.Rain&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> timeStamp <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jsonDdatabase <span class="token operator">=</span> <span class="token punctuation">{</span> loginUnser<span class="token operator">:</span> userName<span class="token punctuation">,</span> loginTime<span class="token operator">:</span> timeStamp <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;log&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>jsonDdatabase<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;[demo]log pritn success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用 mongo 调用：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>mongo goTask.js
</code></pre></div><h4 id="连接数据库-2"><a href="#连接数据库-2" class="header-anchor">#</a> 连接数据库</h4> <p>在<code>js</code>文件中需要使用<code>connect(db)</code>来连接到指定数据库,如果指定的数据库不存在，则创建该数据库：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;company&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="mongo-shell"><a href="#mongo-shell" class="header-anchor">#</a> mongo shell</h2> <blockquote><p>https://docs.mongodb.com/manual/reference/method/ &gt; https://docs.mongodb.com/manual/reference/command/nav-administration/</p></blockquote> <ul><li>show dbs:显示已有数据库，默认会有<code>admin、config、local</code>，这些名字是不允许使用的</li> <li>show users:显示该库下所有用户</li> <li><code>use &lt;db&gt;</code>: 进入数据库，如果该数据库不存在则新建。</li> <li>show collections:显示数据库中的集合（关系型中叫表）</li> <li>db: 显示当前所在数据库,当刚从<code>mongo</code>命令进入时，默认应该返回<code>test</code></li> <li>load: 执行 已存在 js 文件并</li> <li><code>mongod --auth</code>:使用账户密码登陆，再次登录时需要使用<code>mongo -u &lt;用户名&gt; -p &lt;密码&gt; &lt;ip:port&gt;/admin</code>的形式才能登录。</li></ul> <h3 id="换行"><a href="#换行" class="header-anchor">#</a> 换行</h3> <blockquote><p>https://docs.mongodb.com/manual/mongo/#multi-line-operations-in-the-mongo-shell</p></blockquote> <p>如果第一行是以<code>(</code>或者<code>{</code>或者<code>[</code>那么回车就会出现换行</p> <h2 id="备份"><a href="#备份" class="header-anchor">#</a> 备份</h2> <div class="language- extra-class"><pre class="language-text"><code>mongodump
  --host 127.0.0.1
  --port 27017
  --out D://databack/backup
  --collection myCollections
  --db test
  --username username
  --password password
</code></pre></div><h2 id="恢复"><a href="#恢复" class="header-anchor">#</a> 恢复</h2> <div class="language- extra-class"><pre class="language-text"><code>mongostore
  --host 127.0.0.1
  --port 27017
  --username username
  --password password
  &lt;path to the backup&gt;
</code></pre></div><h2 id="mongoose"><a href="#mongoose" class="header-anchor">#</a> Mongoose</h2> <p>Mongoose 是在 node.js 异步环境下对 mongodb 进行便捷操作的对象模型工具。简化编写 MongoDB 验证，转换和业务逻辑，Mongoose 为模型提供了一种直接的，基于 schema 结构去定义你的数据模型。它内置数据验证， 查询构建，业务逻辑钩子等，开箱即用。</p> <p>Mongoose 会缓冲所有命令，直到它连接到数据库为止。这意味着你不必等到它连接到 MongoDB 即可定义模型，运行查询等。</p> <p>Mongoose 有两个特点：</p> <ul><li>通过关系型数据库的思想来设计非关系型数据库</li> <li>基于 mongodb 驱动，简化操作</li></ul> <h3 id="api"><a href="#api" class="header-anchor">#</a> api</h3> <p>https://mongoosejs.com/docs/api.html</p> <h3 id="中间件"><a href="#中间件" class="header-anchor">#</a> 中间件</h3> <p>Mongoose 4.x 有四种中间件： document 中间件，model 中间件，aggregate 中间件，和 query 中间件。<br>
所有中间件支持 pre 和 post 钩子</p> <p>pre 钩子分串行和并行两种</p> <h3 id="connect"><a href="#connect" class="header-anchor">#</a> connect</h3> <p>连接数据库：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mongoose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 用户名密码形式登录</span>
mongoose
  <span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb://test:test123456@ds119210.mlab.com:19210/koa-restful-api&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>连接本地数据库的话就是连接改成<code>mongodb://localhost:27017/&lt;DATABASE_NAME&gt;</code></p> <h3 id="schema"><a href="#schema" class="header-anchor">#</a> Schema</h3> <p>每个schema就会映射到mongodb中的集合，对数据库表的定义，不具备对数据库的操作能力，Schema 有多个<a href="http://www.mongoosejs.net/docs/middleware.html" target="_blank" rel="noopener noreferrer">中间件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> Number<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="设置索引"><a href="#设置索引" class="header-anchor">#</a> 设置索引</h4> <p>普通索引,只需要添加<code>index:true</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  sn<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> String<span class="token punctuation">,</span>
    index<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="添加-model-自定义静态方法"><a href="#添加-model-自定义静态方法" class="header-anchor">#</a> 添加 Model 自定义静态方法</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UserSchema<span class="token punctuation">.</span>statics<span class="token punctuation">.</span><span class="token function-variable function">findBySn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">sn<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this指向当前的Model类</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> sn<span class="token operator">:</span> sn <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> doc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">(</span>err<span class="token punctuation">,</span> doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 使用</span>
UserModel<span class="token punctuation">.</span><span class="token function">findBySn</span><span class="token punctuation">(</span><span class="token string">'sdf12312'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="添加model实例方法"><a href="#添加model实例方法" class="header-anchor">#</a> 添加Model实例方法</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
UserSchema<span class="token punctuation">.</span>methods<span class="token punctuation">.</span><span class="token function-variable function">print</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// this指向当前的model实例</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 使用</span>
<span class="token keyword">const</span> u<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span><span class="token string">'李四7'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span><span class="token string">'123'</span><span class="token punctuation">,</span>
  status<span class="token operator">:</span><span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
u<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 李四7</span>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\
#### 数据校验
内置的数据校验有：
- required:必传
- max：用于Number类型，最大值
- min：用于Number类型，最小值
- enum：用于String类型，枚举类型，要求数据必须满足枚举值，例如：enum:['0','1','2']
- match:用于String类型，数据必须复合match（正则）的规则
- maxlength：用于String类型，最大长度
- minlength：用于String类型，最小长度
</span><span class="token template-punctuation string">`</span></span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span>js
<span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
    required<span class="token operator">:</span><span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>自定义的验证方法,加入<code>validate</code>函数，可以使用在任意类型里：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
    <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">status</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> status<span class="token operator">===</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="schematype"><a href="#schematype" class="header-anchor">#</a> SchemaType</h3> <p>Schema 支持的类型有：</p> <div class="language- extra-class"><pre class="language-text"><code>String
Number
Date
Buffer
Boolean
Mixed
ObjectId
Array
Decimal128
Map
Schema
</code></pre></div><p>定义类型时可以直接赋值为字符串形式，定义类型：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> UserSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  age<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  status<span class="token operator">:</span> Number<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>也可以用对象形式添加额外的选项：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  updated<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> Date<span class="token punctuation">.</span>now <span class="token punctuation">}</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> Number<span class="token punctuation">,</span> min<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> max<span class="token operator">:</span> <span class="token number">65</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mixed<span class="token operator">:</span> Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>Mixed<span class="token punctuation">,</span>
  _someId<span class="token operator">:</span> Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">,</span>
  decimal<span class="token operator">:</span> Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>Decimal128<span class="token punctuation">,</span>
  array<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofString<span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofNumber<span class="token operator">:</span> <span class="token punctuation">[</span>Number<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofDates<span class="token operator">:</span> <span class="token punctuation">[</span>Date<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofBuffer<span class="token operator">:</span> <span class="token punctuation">[</span>Buffer<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofBoolean<span class="token operator">:</span> <span class="token punctuation">[</span>Boolean<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofMixed<span class="token operator">:</span> <span class="token punctuation">[</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>Mixed<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofObjectId<span class="token operator">:</span> <span class="token punctuation">[</span>Schema<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>ObjectId<span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofArrays<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  ofArrayOfNumbers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>Number<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  nested<span class="token operator">:</span> <span class="token punctuation">{</span>
    stuff<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> String<span class="token punctuation">,</span> lowercase<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> trim<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  map<span class="token operator">:</span> Map<span class="token punctuation">,</span>
  mapOfString<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> Map<span class="token punctuation">,</span>
    <span class="token keyword">of</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>常用额外参数：</p> <ul><li>type 类型</li> <li>default 默认值</li></ul> <h4 id="预定义模式修饰符"><a href="#预定义模式修饰符" class="header-anchor">#</a> 预定义模式修饰符</h4> <p>对增加的数据进行一些格式化。例如：<code>lowercase、uppercase、trim</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> NewsSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> String<span class="token punctuation">,</span>
    trim<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="自定义修饰符"><a href="#自定义修饰符" class="header-anchor">#</a> 自定义修饰符</h4> <p>除了内置的修饰符还可以使用 set 修饰符在增加数据的时候对数据进行格式化。也可以通过 get（不建议使用）在实例获取数据时对数据进行格式化。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> NewsSchema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> String<span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="model"><a href="#model" class="header-anchor">#</a> Model</h3> <p>由 Schema 发布生成的模型，具有抽象属性和行为的数据库操作对,可以对集合进行删、改、查，新增应该放到<code>Document</code>中<code>save()</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> db <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;mongodb://127.0.0.1:27017/test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建Model</span>
<span class="token keyword">var</span> TestModel <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">&quot;Test1&quot;</span><span class="token punctuation">,</span> TestSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>Mongoose.prototype.model()</code>参数解析：</p> <ul><li>第一个参数是 model 的 name 或者是要继承的 Model，如果没有第三个参数，那么表示该 model 对第一个参数名+s 的集合生效,如果第一个参数本身就是带<code>s</code>的话，那么找到的就是同名的集合。集合首字母小写。</li> <li>第二个参数是 schema</li> <li>第三个参数是集合名称</li> <li>第四个参数是 skipInit</li></ul> <h4 id="model-save-callback"><a href="#model-save-callback" class="header-anchor">#</a> model.save(callback)</h4> <p>保存数据，首先初始化model:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> news<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">News</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span><span class="token string">'我是新闻'</span><span class="token punctuation">,</span>
  author<span class="token operator">:</span><span class="token string">'张三'</span><span class="token punctuation">,</span>
  content<span class="token operator">:</span><span class="token string">'我是内容'</span><span class="token punctuation">,</span>
  status<span class="token operator">:</span><span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
news<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span>
</code></pre></div><h4 id="model-updateone-query-params-callback"><a href="#model-updateone-query-params-callback" class="header-anchor">#</a> model.updateOne(query,params，callback)</h4> <p>修改数据</p> <h4 id="model-deleteone-query-callback"><a href="#model-deleteone-query-callback" class="header-anchor">#</a> model.deleteOne(query,callback)</h4> <p>删除数据</p> <h4 id="model-aggregate-callback"><a href="#model-aggregate-callback" class="header-anchor">#</a> model.aggregate([],callback)</h4> <p>聚合管道</p> <h3 id="document"><a href="#document" class="header-anchor">#</a> Document</h3> <p>由 Model 创建的实体，他的操作也会影响数据库，相当于<code>Model.create(req.body)</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> u <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;李四6&quot;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
  status<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Model 实例化时会做以下几件事：</p> <ul><li>尝试转换参数类型，比如定义<code>User model</code>时，<code>age</code>类型为<code>Number</code>,那么会转化<code>'123'</code>为<code>123</code>,如果转化失败则<code>u</code>中不会包含<code>age</code>属性。</li> <li>如果添加没有在 Model 中定义的字段，那么实例化时生成的的 document 不会包含该字段。</li> <li>如果没有传入定义时的字段，则该字段不会被添加到数据库。</li></ul> <h4 id="常用方法"><a href="#常用方法" class="header-anchor">#</a> 常用方法</h4> <ol><li>save() 保存数据</li></ol> <h2 id="最佳实践"><a href="#最佳实践" class="header-anchor">#</a> 最佳实践</h2> <h3 id="批量插入性能"><a href="#批量插入性能" class="header-anchor">#</a> 批量插入性能</h3> <p>循环单个插入和批量一次插入，速度会差很多，优先使用批量插入。</p> <h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <h3 id="address-already-in-use"><a href="#address-already-in-use" class="header-anchor">#</a> Address already in use</h3> <p>说明端口已经被占用，可以使用另外一个端口：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>mongod --port <span class="token number">27018</span>
</code></pre></div><p>或者杀掉所有 mongod 进程：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">killall</span> mongod
</code></pre></div><h3 id="attempted-to-create-a-lock-file-on-a-read-only-directory-data-db"><a href="#attempted-to-create-a-lock-file-on-a-read-only-directory-data-db" class="header-anchor">#</a> Attempted to create a lock file on a read-only directory: /data/db</h3> <p>导致这个问题的原因是该文件夹的用户权限问题，检查该目录的所属：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">cd</span> /data/
<span class="token function">ls</span> -l
</code></pre></div><p>发现输出是<code>root</code>,不是当前用户，所以修改成当前用户就 ok 了：</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">chown</span> -R xxx /data/db/
</code></pre></div><h1 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h1> <h2 id="关系数据库中表与表的3中关系"><a href="#关系数据库中表与表的3中关系" class="header-anchor">#</a> 关系数据库中表与表的3中关系</h2> <ol><li>一对一</li> <li>一对多</li> <li>多对多，一般通过中间表对双方的信息进行保存</li></ol> <h1 id="api-2"><a href="#api-2" class="header-anchor">#</a> API</h1> <h2 id="database-methods"><a href="#database-methods" class="header-anchor">#</a> Database Methods</h2> <h3 id="use-database-name"><a href="#use-database-name" class="header-anchor">#</a> use &lt;DATABASE_NAME&gt;</h3> <p>创建数据库</p> <h3 id="db-auth"><a href="#db-auth" class="header-anchor">#</a> db.auth(<username>, <password>)</password></username></h3> <p>用户建权，建权成功返回 1，失败返回 0</p> <h3 id="db-createuser-user-writeconcern"><a href="#db-createuser-user-writeconcern" class="header-anchor">#</a> db.createUser(user,writeConcern)</h3> <p>数据库创建用户和权限</p> <p>参数 user：</p> <div class="language- extra-class"><pre class="language-text"><code>{
  user: &quot;&lt;name&gt;&quot;,
  pwd: passwordPrompt(),      // Or  &quot;&lt;cleartext password&gt;&quot;
  customData: { &lt;any information&gt; },
  roles: [
    { role: &quot;&lt;role&gt;&quot;, db: &quot;&lt;database&gt;&quot; } | &quot;&lt;role&gt;&quot;,
    ...
  ],
  authenticationRestrictions: [
     {
       clientSource: [&quot;&lt;IP&gt;&quot; | &quot;&lt;CIDR range&gt;&quot;, ...],
       serverAddress: [&quot;&lt;IP&gt;&quot; | &quot;&lt;CIDR range&gt;&quot;, ...]
     },
     ...
  ],
  mechanisms: [ &quot;&lt;SCRAM-SHA-1|SCRAM-SHA-256&gt;&quot;, ... ],
  passwordDigestor: &quot;&lt;server|client&gt;&quot;
}
</code></pre></div><p>其中<code>&lt;role&gt;</code>的内置可选值为：</p> <ol><li>数据库用户角色：read、readWrite；</li> <li>数据库管理角色：dbAdmin、dbOwner、userAdmin;</li> <li>集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManage；</li> <li>备份恢复角色：backup、restore；</li> <li>所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase</li> <li>超级用户角色：root</li> <li>内部角色：__system</li></ol> <h3 id="db-updateuser"><a href="#db-updateuser" class="header-anchor">#</a> db.updateUser()</h3> <p>修改用户</p> <h3 id="db-dropuser"><a href="#db-dropuser" class="header-anchor">#</a> db.dropUser()</h3> <p>删除用户</p> <h3 id="db-dropdatabase"><a href="#db-dropdatabase" class="header-anchor">#</a> db.dropDatabase()</h3> <p>删除当前数据库</p> <h3 id="db-runcommand"><a href="#db-runcommand" class="header-anchor">#</a> db.runCommand()</h3> <p>提供帮助程序以运行指定的数据库命令。这是发出数据库命令的首选方法，因为它在 shell 和程序之间提供了一致的接口。</p> <h2 id="collection-methods-集合"><a href="#collection-methods-集合" class="header-anchor">#</a> collection Methods(集合)</h2> <p>在对数据进行修改的时候不能只修改对应的属性，应该返回整个新的文档。</p> <h3 id="db-collection-explain"><a href="#db-collection-explain" class="header-anchor">#</a> db.collection.explain()</h3> <p>返回有关以下查询方法的信息：</p> <ul><li>aggregate</li> <li>count</li> <li>find</li> <li>remove</li> <li>update</li> <li>distinct</li> <li>findAndModify</li> <li>mapReduce</li></ul> <p>参数：<code>&quot;queryPlanner&quot; (Default)|&quot;executionStats&quot;｜&quot;allPlansExecution&quot;</code></p> <h4 id="查看是否命中索引"><a href="#查看是否命中索引" class="header-anchor">#</a> 查看是否命中索引</h4> <p>可以通过传入executionStats参数，查看返回信息中的<code>indexBounds</code>来判断是否命中索引</p> <h3 id="db-collection-insert"><a href="#db-collection-insert" class="header-anchor">#</a> db.collection.insert</h3> <p>插入数据，当集合不存在时，新建集合,注意一次插入不要超过 48M，向.zip 和大图片什么的尽量用静态存储，MongoDB 存储静态路径就好，这也算是一个规则。</p> <h3 id="db-collection-remove"><a href="#db-collection-remove" class="header-anchor">#</a> db.collection.remove</h3> <p>第一个参数是查询，第二个参数是选项是否只删除一个。</p> <h3 id="db-collection-drop"><a href="#db-collection-drop" class="header-anchor">#</a> db.collection.drop</h3> <p>清空当前集合</p> <h3 id="db-collection-update"><a href="#db-collection-update" class="header-anchor">#</a> db.collection.update</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">update</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span>update<span class="token punctuation">,</span> <span class="token punctuation">{</span>upsert<span class="token operator">:</span><span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">,</span>multi<span class="token operator">:</span> <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">,</span>writeConcern<span class="token operator">:</span> <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span><span class="token punctuation">,</span>collation<span class="token operator">:</span> <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span><span class="token punctuation">,</span> arrayFilters<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">&lt;</span>filterdocument1<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">...</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>hint<span class="token operator">:</span> <span class="token operator">&lt;</span>document <span class="token operator">|</span> string<span class="token operator">&gt;</span><span class="token comment">// Available starting in MongoDB 4.2})</span>
</code></pre></div><p>修改文档，,query 为查询，update 参数为修改为，options：</p> <ul><li>multi 为 true 时，修改所有匹配的文档，默认值为 false</li> <li>upsert 为 true 时，如果不存在该数据，则插入该条数据，默认值为 false</li></ul> <h3 id="db-collection-findandmodify"><a href="#db-collection-findandmodify" class="header-anchor">#</a> db.collection.findAndModify</h3> <p>修改并返回文档，平时工作中更多是用这个方法来进行数据库的修改，因为有返回状态，虽然性能没有直接使用命令快，但是更安全。<br>
参数：</p> <div class="language- extra-class"><pre class="language-text"><code>db.collection.findAndModify({
    query: &lt;document&gt;, // 需要查询的条件/文档
    sort: &lt;document&gt;,  // 进行排序
    remove: &lt;boolean&gt;,
    update: &lt;document or aggregation pipeline&gt;, // Changed in MongoDB 4.2
    new: &lt;boolean&gt;, // 是否返回修改后文档
    fields: &lt;document&gt;, // 需要返回的字段
    upsert: &lt;boolean&gt;,  // 没有要修改的值时是否新增这个值
    bypassDocumentValidation: &lt;boolean&gt;,
    writeConcern: &lt;document&gt;,
    collation: &lt;document&gt;,
    arrayFilters: [ &lt;filterdocument1&gt;, ... ]
});
</code></pre></div><p>例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myModify <span class="token operator">=</span> <span class="token punctuation">{</span>
  findAndModify<span class="token operator">:</span> <span class="token string">&quot;workmate&quot;</span><span class="token punctuation">,</span>
  query<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;JSPang&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  update<span class="token operator">:</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">new</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//更新完成，需要查看结果，如果为false不进行查看结果</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ResultMessage <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span>myModify<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printjson</span><span class="token punctuation">(</span>ResultMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="db-collection-find"><a href="#db-collection-find" class="header-anchor">#</a> db.collection.find</h3> <p>参数：</p> <ul><li>query, 查询参数,如果参数为{}则返回所有
<ul><li>如果查询数组，那么使用<code>[]</code>则精确查询，例如：<code>{interest:['看电影']}</code>,如果使用字符串，则为查询包含该值的数据，例如：<code>{interest:'看电影'}</code></li></ul></li> <li>projection，要返回的字段，不传递参数则全部返回，设置参数后默认返回<code>_id</code> <ul><li>取消默认返回<code>_id</code>，可以添加参数<code>{_id:false}</code>,值也可以是<code>0或1</code>,例如：<code>{name:true,&quot;skill.skillOne&quot;:true,_id:false}</code> 返回：</li></ul></li> <li>cursor 游标,可以使用游标的方法来对返回做处理</li></ul> <p>对返回游标进行遍历：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;company&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//进行链接对应的集合collections</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//声明变量result，并把查询结果赋值给result</span>
<span class="token comment">//利用游标的hasNext()进行循环输出结果。</span>
result<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printjson</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="db-collection-findone"><a href="#db-collection-findone" class="header-anchor">#</a> db.collection.findOne</h3> <p>查找第一个</p> <h3 id="db-collection-createindex-keys-options-commitquorum"><a href="#db-collection-createindex-keys-options-commitquorum" class="header-anchor">#</a> db.collection.createIndex(keys, options, commitQuorum)</h3> <p>为数据建立索引。索引是特殊的数据结构，索引存储在一个易于遍历读取的数据集合中，索引是对数据库表中一列或多列的值进行排序的一种结构。无论是在关系型数据库还是文档数据库，建立索引都是非常重要的。索引会消耗硬盘和内存资源，所以还是要根据程序需要进行建立。MongoDB 也给我们进行了限制，只允许我们建立 64 个索引值。</p> <p>参数：</p> <ul><li>keys 表示需要建立所以的属性，例如：<code>{text:1}</code>,值为 1 表示升序，值为-1 表示降序</li> <li>options</li></ul> <h4 id="索引中的问题"><a href="#索引中的问题" class="header-anchor">#</a> 索引中的问题：</h4> <ul><li>数据不超万条时，不需要使用索引。性能的提升并不明显，而大大增加了内存和硬盘的消耗。</li> <li>查询数据超过表数据量 30%时，不要使用索引字段查询。实际证明会比不使用索引更慢，因为它大量检索了索引表和我们原表。</li> <li>数字索引（即值为数字的 key），要比字符串索引快的多，在百万级甚至千万级数据量面前，使用数字索引是个明确的选择。</li> <li>把你经常查询的数据做成一个内嵌数据（对象型的数据），然后集体进行索引。</li></ul> <h4 id="复合索引"><a href="#复合索引" class="header-anchor">#</a> 复合索引</h4> <p>在 find 中使用多个建立索引的 key 时，按照建立 getIndexes()中的顺序查找。</p> <h4 id="全文索引"><a href="#全文索引" class="header-anchor">#</a> 全文索引</h4> <ul><li>key 值为 text 则创建全文索引：<code>db.info.createIndex({textContent:'text'})</code></li> <li>搜索全文索引：<code>db.info.find({$text:{$search:&quot;programmer&quot;}})</code>,使用$text 表示使用全文索引搜索
<ul><li>查找多个词：<code>db.info.find({$text:{$search:&quot;programmer family diary drink&quot;}})</code>,搜索出来的结果是<code>或</code>的关系,会把包含这些字的数据都查出来，</li> <li>如果不想查带有<code>drink</code>文字的数据，那么使用<code>-</code>表示：<code>db.info.find({$text:{$search:&quot;programmer family diary -drink&quot;}})</code></li> <li>查找带有空格的词语,使用转义符：<code>db.info.find({$text:{$search:&quot;\&quot;love PlayGame\&quot; drink&quot;}})</code></li></ul></li></ul> <h4 id="唯一索引"><a href="#唯一索引" class="header-anchor">#</a> 唯一索引</h4> <p>在缺省情况下创建的索引都不是唯一索引，在第二个参数中添加<code>{unique:true}</code>则创建唯一索引</p> <h3 id="db-collection-getindexes"><a href="#db-collection-getindexes" class="header-anchor">#</a> db.collection.getIndexes()</h3> <p>查看现有索引</p> <h3 id="db-collection-dropindex-index"><a href="#db-collection-dropindex-index" class="header-anchor">#</a> db.collection.dropIndex(index)</h3> <p>删除索引，参数为索引 name 或者索引 key 值：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token string">&quot;catIdx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cat<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="db-collection-aggregate"><a href="#db-collection-aggregate" class="header-anchor">#</a> db.collection.aggregate([])</h3> <p>聚合管道，通过聚合管道可以对集合进行变幻组合，实际项目中通常用作：表关联查询、数据的统计。</p> <h4 id="管道操作符"><a href="#管道操作符" class="header-anchor">#</a> 管道操作符</h4> <table><thead><tr><th>名称</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>$project</td> <td>增加、删除、重命名字段</td> <td></td></tr> <tr><td>$match</td> <td>条件匹配。只满足条件的文档才能进入下一阶段</td> <td></td></tr> <tr><td>$limit</td> <td>限制结果的数量</td> <td></td></tr> <tr><td>$skip</td> <td>跳过文档的数量</td> <td></td></tr> <tr><td>$sort</td> <td>条件排序</td> <td></td></tr> <tr><td>$group</td> <td>条件组合结果、统计、分组</td> <td></td></tr> <tr><td>$lookup</td> <td>用以引入其他集合的数据（表关联查询）</td> <td></td></tr></tbody></table> <h4 id="project"><a href="#project" class="header-anchor">#</a> $project</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>db.order.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token variable">$project</span>:<span class="token punctuation">{</span>trade_no:1,all_price:1<span class="token punctuation">}</span> // 返回的数据只包含<span class="token variable"><span class="token variable">`</span>trade_no<span class="token variable">`</span></span>和<span class="token variable"><span class="token variable">`</span>all_price<span class="token variable">`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="match"><a href="#match" class="header-anchor">#</a> $match</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>db.order.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token variable">$project</span>:<span class="token punctuation">{</span>trade_no:1,all_price:1<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span>
    <span class="token variable">$match</span>:<span class="token punctuation">{</span><span class="token string">&quot;all_price&quot;</span>:<span class="token punctuation">{</span><span class="token variable">$gte</span>:90<span class="token punctuation">}</span><span class="token punctuation">}</span> // 返回的数据只包含<span class="token variable"><span class="token variable">`</span>trade_no<span class="token variable">`</span></span>和<span class="token variable"><span class="token variable">`</span>all_price<span class="token variable">`</span></span>，并且all_price大于等于90
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="group"><a href="#group" class="header-anchor">#</a> $group</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>db.order_item.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">'<span class="token variable">$order_id</span>'</span>,total:<span class="token punctuation">{</span><span class="token variable">$sum</span><span class="token builtin class-name">:</span><span class="token string">&quot;<span class="token variable">$num</span>&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span> // 使用order_id字段分组，返回的数据中包含<span class="token variable"><span class="token variable">`</span>_id<span class="token variable">`</span></span>和<span class="token variable"><span class="token variable">`</span>total<span class="token variable">`</span></span>字段，<span class="token variable"><span class="token variable">`</span>total<span class="token variable">`</span></span>字段值为分组后的num字段之和
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="sort"><a href="#sort" class="header-anchor">#</a> $sort</h4> <div class="language-sh extra-class"><pre class="language-sh"><code>db.order.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token variable">$project</span>:<span class="token punctuation">{</span>trade_no:1,all_price:1<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span>
    <span class="token variable">$match</span>:<span class="token punctuation">{</span><span class="token string">&quot;all_price&quot;</span>:<span class="token punctuation">{</span><span class="token variable">$gte</span>:90<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span>
    <span class="token variable">$sort</span>:<span class="token punctuation">{</span><span class="token string">&quot;all_price&quot;</span>:-1<span class="token punctuation">}</span>  // 返回的数据只包含<span class="token variable"><span class="token variable">`</span>trade_no<span class="token variable">`</span></span>和<span class="token variable"><span class="token variable">`</span>all_price<span class="token variable">`</span></span>，并且all_price大于等于90，按照降序排序
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="lookup"><a href="#lookup" class="header-anchor">#</a> $lookup</h4> <div class="language- extra-class"><pre class="language-text"><code>db.order.aggregate([
  {
    $lookup:{
      from:'order_item',  // 关联的集合
      localField:'order_id', // 主表（order）字段
      foreignField:'order_id', // 关联表（order_item）字段
      as:&quot;items&quot; // 查询出来的数据作为`items`字段返回
    }
  }
])
</code></pre></div><h2 id="操作符"><a href="#操作符" class="header-anchor">#</a> 操作符</h2> <p>https://docs.mongodb.com/manual/reference/operator/update/</p> <h3 id="set"><a href="#set" class="header-anchor">#</a> $set</h3> <p>用<code>$set</code>操作符就可以实现单独新增、修改属性：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;MinJie&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> sex<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">21</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果嵌套文档可以是用属性的形式进行修改：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;MinJie&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;skill.skillThree&quot;</span><span class="token operator">:</span> <span class="token string">&quot;word&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>修改数组时，如果不知道具体值，只知道位置，可以通过 index 修改：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;xiaoWang&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;interest.2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Code&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="unset"><a href="#unset" class="header-anchor">#</a> $unset</h3> <p>使用<code>$unset</code>可以删除键值对：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;MinJie&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $unset<span class="token operator">:</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="inc"><a href="#inc" class="header-anchor">#</a> $inc</h3> <p>对数字进行计算：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;MinJie&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $inc<span class="token operator">:</span> <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="push"><a href="#push" class="header-anchor">#</a> $push</h3> <p>对数组文档进行操作，如果该数组不存在则创建新数组，如果修改属性不为数组，则什么都不做。支持内嵌属性格式。</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;MinJie&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $push<span class="token operator">:</span> <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token string">&quot;draw&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="addtoset"><a href="#addtoset" class="header-anchor">#</a> $addToSet</h3> <p>相当于<code>&lt;update&gt;</code>版的$ne，平时更多是使用$addToSet 而不是$ne</p> <h3 id="pop"><a href="#pop" class="header-anchor">#</a> $pop</h3> <p>删除数组的起始值或者末尾值，根据参数决定</p> <ul><li>1:从数组末端删除</li> <li>-1:从数组开头删除</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;xiaoWang&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $pop<span class="token operator">:</span> <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="in"><a href="#in" class="header-anchor">#</a> $in</h3> <p>用于搜索一键多值，值为数组形式，值满足其中一项即可，比如搜索同事中年龄是 25 岁或 33 岁的信息：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;skill.skillOne&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="nin"><a href="#nin" class="header-anchor">#</a> $nin</h3> <p>与$in 相反，匹配 值不等于输入的文档</p> <h3 id="or"><a href="#or" class="header-anchor">#</a> $or</h3> <p>查询多个键值，与$in不同的是，$in 是用来查询等于，$or 可以进行比较查询：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> age<span class="token operator">:</span> <span class="token punctuation">{</span> $gte<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;skill.skillThree&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PHP&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;skill.skillThree&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="nor"><a href="#nor" class="header-anchor">#</a> $nor</h3> <p>与$or 相反</p> <h3 id="and"><a href="#and" class="header-anchor">#</a> $and</h3> <p>用来查找几个 key 值都满足的情况,语法同$or</p> <h3 id="not"><a href="#not" class="header-anchor">#</a> $not</h3> <p>它用来查询除条件之外的值，比如我们现在要查找除年龄大于 20 岁，小于 30 岁的人员信。</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token punctuation">{</span>
      $not<span class="token operator">:</span> <span class="token punctuation">{</span>
        $lte<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
        $gte<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;skill.skillOne&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="all"><a href="#all" class="header-anchor">#</a> $all</h3> <p>用于数组多项查询,需要满足所有条件：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token punctuation">{</span> $all<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;看电影&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;看书&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> interest<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="size"><a href="#size" class="header-anchor">#</a> $size</h3> <p>根据数组的长度查询出结果。</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token punctuation">{</span> $size<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> interest<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="where"><a href="#where" class="header-anchor">#</a> $where</h3> <p>它可以让我们在条件里使用 js 的方法来进行复杂查询：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> $where<span class="token operator">:</span> <span class="token string">&quot;this.age&gt;30&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>this 指向 workmate 集合本身，虽然强大和灵活，但是这种查询对于数据库的压力和安全性都会变重，不推荐使用。</p> <h2 id="projection-操作符"><a href="#projection-操作符" class="header-anchor">#</a> Projection 操作符</h2> <blockquote><p>用于对返回数据进行操作</p></blockquote> <h3 id="slice"><a href="#slice" class="header-anchor">#</a> $slice</h3> <p>指定返回数据的长度：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> interest<span class="token operator">:</span> <span class="token punctuation">{</span> $slice<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> _id<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="cursor-游标"><a href="#cursor-游标" class="header-anchor">#</a> cursor 游标</h2> <h3 id="cursor-limit-number"><a href="#cursor-limit-number" class="header-anchor">#</a> cursor.limit(number)</h3> <p>控制返回值数量，参数为 0 时不做限制。此方法对分页有用。</p> <h3 id="cursor-skip-number"><a href="#cursor-skip-number" class="header-anchor">#</a> cursor.skip(number)</h3> <p>指定从何处开始返回结果，此方法对分页有用。</p> <h3 id="cursor-sort"><a href="#cursor-sort" class="header-anchor">#</a> cursor.sort(<document>)</document></h3> <p>对返回值排序，可以指定属性按照升序还是降序排序,升序值为 1，降序为-1：</p> <div class="language- extra-class"><pre class="language-text"><code>db.users.find({ }).sort( { age : -1, posts: 1 } )
</code></pre></div><h3 id="cursor-hasnext"><a href="#cursor-hasnext" class="header-anchor">#</a> cursor.hasNext()</h3> <p>如果 db.collection.find()查询返回的游标可以进一步迭代以返回更多文档，则返回 true。<br>
使用 while 遍历:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">&quot;company&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//进行链接对应的集合collections</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//声明变量result，并把查询结果赋值给result</span>
<span class="token comment">//利用游标的hasNext()进行循环输出结果。</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printjson</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//用json格式打印结果</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="cursor-hint-index"><a href="#cursor-hint-index" class="header-anchor">#</a> cursor.hint(index)</h3> <p>调用此方法来覆盖默认的索引顺序：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用randNum0进行索引查找</span>
db<span class="token punctuation">.</span>randomInfo
  <span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> usename<span class="token operator">:</span> <span class="token string">&quot;zkcvjlsdkfjslf&quot;</span><span class="token punctuation">,</span> randNum0<span class="token operator">:</span> <span class="token number">908274</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">hint</span><span class="token punctuation">(</span><span class="token punctuation">{</span> randNum0<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="修饰符"><a href="#修饰符" class="header-anchor">#</a> 修饰符</h2> <blockquote><p>比较大小可用于数字格式、时间格式</p></blockquote> <h3 id="each"><a href="#each" class="header-anchor">#</a> $each</h3> <p>批量操作，可与<code>$addToSet</code>和<code>$push</code>一起使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> newInterset <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Sing&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Dance&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Code&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;xiaoWang&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> $addToSet<span class="token operator">:</span> <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token punctuation">{</span> $each<span class="token operator">:</span> newInterset <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="lt"><a href="#lt" class="header-anchor">#</a> $lt</h3> <p>小于，全称<code>less-than</code></p> <h3 id="lte"><a href="#lte" class="header-anchor">#</a> lte</h3> <p>小于等于，英文全称<code>less-than-equal</code></p> <h3 id="gt"><a href="#gt" class="header-anchor">#</a> $gt</h3> <p>大于，英文全称<code>greater-than</code></p> <h3 id="gte"><a href="#gte" class="header-anchor">#</a> $gte</h3> <p>大于等于，英文全称<code>greater-than-equal</code></p> <h3 id="ne"><a href="#ne" class="header-anchor">#</a> $ne</h3> <p>不等于，$ne 用于<code>&lt;query&gt;</code>，查找是否不存在值。</p> <p>当用于对象时，判断的值应为整个对象：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&quot;MinJie&quot;</span><span class="token punctuation">,</span>
    skill<span class="token operator">:</span> <span class="token punctuation">{</span>
      $ne<span class="token operator">:</span> <span class="token punctuation">{</span>
        skillOne<span class="token operator">:</span> <span class="token string">&quot;PhotoShop&quot;</span><span class="token punctuation">,</span>
        SkillTwo<span class="token operator">:</span> <span class="token string">&quot;UI&quot;</span><span class="token punctuation">,</span>
        SkillThree<span class="token operator">:</span> <span class="token string">&quot;Word+Excel+PPT&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> $push<span class="token operator">:</span> <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token string">&quot;talk4&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>当用于数组时，判断是否包括该值：</p> <div class="language-js extra-class"><pre class="language-js"><code>db<span class="token punctuation">.</span>workmate<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;xiaoWang&quot;</span><span class="token punctuation">,</span> interest<span class="token operator">:</span> <span class="token punctuation">{</span> $ne<span class="token operator">:</span> <span class="token string">&quot;playGame&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> $push<span class="token operator">:</span> <span class="token punctuation">{</span> interest<span class="token operator">:</span> <span class="token string">&quot;Game&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-11-13
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2020-12-05
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2020/11/10/go-micro%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97.html" class="post-link" data-v-4e23451f>
      上一篇 : go-micro学习指南
    </a> <a href="/posts/2021/01/23/tailwind-css%E5%AD%A6%E4%B9%A0.html" class="post-link" data-v-4e23451f>
      下一篇 : Tailwind.css学习
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" data-v-9d847660><img src="https://blog-pic.oss-cn-beijing.aliyuncs.com/avatar.webp" alt="L.Rain" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      L.Rain
    </section> <section class="info-desc" data-v-9d847660>真实、自由、宽容</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="ChengDu City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ChengDu City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ChengDu City, China
        </span></span></section> <section data-v-9d847660><span title="ChengDu YeeYun Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ChengDu YeeYun Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ChengDu YeeYun Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:bxy2997@sina.com" title="bxy2997@sina.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>bxy2997@sina.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          bxy2997@sina.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/baixiaoyu2997" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: L.Rain" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: L.Rain</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a><a href="https://weibo.com/1504398495" target="_blank" class="sns-link" data-v-9d847660><span title="新浪微博: 白晓宇V" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>新浪微博: 白晓宇V</title><use xlink:href="#icon-weibo" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#下载">下载</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#安装">安装</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#连接数据库">连接数据库</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#可执行文件">可执行文件</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#mongo-shell">mongo shell</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#换行">换行</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#备份">备份</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#恢复">恢复</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#mongoose">Mongoose</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#api">api</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#中间件">中间件</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#connect">connect</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#schema">Schema</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#schematype">SchemaType</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#model">Model</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#document">Document</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#最佳实践">最佳实践</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#批量插入性能">批量插入性能</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#问题">问题</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#address-already-in-use">Address already in use</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#attempted-to-create-a-lock-file-on-a-read-only-directory-data-db">Attempted to create a lock file on a read-only directory: /data/db</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#关系数据库中表与表的3中关系">关系数据库中表与表的3中关系</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#database-methods">Database Methods</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#use-database-name">use</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-auth">db.auth()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-createuser-user-writeconcern">db.createUser(user,writeConcern)</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-updateuser">db.updateUser()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-dropuser">db.dropUser()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-dropdatabase">db.dropDatabase()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-runcommand">db.runCommand()</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#collection-methods-集合">collection Methods(集合)</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-explain">db.collection.explain()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-insert">db.collection.insert</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-remove">db.collection.remove</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-drop">db.collection.drop</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-update">db.collection.update</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-findandmodify">db.collection.findAndModify</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-find">db.collection.find</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-findone">db.collection.findOne</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-createindex-keys-options-commitquorum">db.collection.createIndex(keys, options, commitQuorum)</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-getindexes">db.collection.getIndexes()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-dropindex-index">db.collection.dropIndex(index)</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#db-collection-aggregate">db.collection.aggregate([])</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#操作符">操作符</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#set">\$set</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#unset">\$unset</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#inc">\$inc</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#push">\$push</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#addtoset">\$addToSet</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#pop">\$pop</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#in">\$in</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#nin">\$nin</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#or">\$or</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#nor">\$nor</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#and">\$and</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#not">\$not</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#all">\$all</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#size">\$size</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#where">\$where</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#projection-操作符">Projection 操作符</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#slice">\$slice</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#cursor-游标">cursor 游标</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#cursor-limit-number">cursor.limit(number)</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#cursor-skip-number">cursor.skip(number)</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#cursor-sort">cursor.sort()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#cursor-hasnext">cursor.hasNext()</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#cursor-hint-index">cursor.hint(index)</a></li></ul></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#修饰符">修饰符</a><ul><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#each">\$each</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#lt">\$lt</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#lte">lte</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#gt">\$gt</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#gte">\$gte</a></li><li><a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#ne">\$ne</a></li></ul></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2020/11/13/mongodb%E6%8C%87%E5%8D%97.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/baixiaoyu2997" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: L.Rain" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: L.Rain</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a><a href="https://weibo.com/1504398495" target="_blank" class="sns-link" data-v-1375e54c><span title="新浪微博: 白晓宇V" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>新浪微博: 白晓宇V</title><use xlink:href="#icon-weibo" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <!----></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.9324d2ff.js" defer></script><script src="/assets/js/7.8545d9f8.js" defer></script><script src="/assets/js/27.c58d5520.js" defer></script>
  </body>
</html>
