<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker学习随笔 | L.Rain的博客</title>
    <meta name="generator" content="VuePress 1.5.4">
    <meta name="description" content="L.Rain的博客">
    <link rel="preload" href="/assets/css/0.styles.62d2b403.css" as="style"><link rel="preload" href="/assets/js/app.85c1525a.js" as="script"><link rel="preload" href="/assets/js/7.bc1fde9d.js" as="script"><link rel="preload" href="/assets/js/18.56a1bafd.js" as="script"><link rel="prefetch" href="/assets/js/1.001ca197.js"><link rel="prefetch" href="/assets/js/10.da37578a.js"><link rel="prefetch" href="/assets/js/11.0e2e3984.js"><link rel="prefetch" href="/assets/js/12.7231344e.js"><link rel="prefetch" href="/assets/js/13.321d6087.js"><link rel="prefetch" href="/assets/js/14.05c51bcb.js"><link rel="prefetch" href="/assets/js/15.c9ae26d3.js"><link rel="prefetch" href="/assets/js/16.af3f7510.js"><link rel="prefetch" href="/assets/js/17.d9535ed9.js"><link rel="prefetch" href="/assets/js/19.079c592f.js"><link rel="prefetch" href="/assets/js/20.dc65b43c.js"><link rel="prefetch" href="/assets/js/21.9ab9cb0b.js"><link rel="prefetch" href="/assets/js/22.d434bea6.js"><link rel="prefetch" href="/assets/js/23.c1fd3810.js"><link rel="prefetch" href="/assets/js/24.98d1c9e6.js"><link rel="prefetch" href="/assets/js/25.ec6ee1d4.js"><link rel="prefetch" href="/assets/js/26.c2bb050a.js"><link rel="prefetch" href="/assets/js/27.718c3525.js"><link rel="prefetch" href="/assets/js/28.e35943dc.js"><link rel="prefetch" href="/assets/js/29.64b34d73.js"><link rel="prefetch" href="/assets/js/3.decef8c9.js"><link rel="prefetch" href="/assets/js/30.1c6bee5d.js"><link rel="prefetch" href="/assets/js/31.78417b34.js"><link rel="prefetch" href="/assets/js/32.7fd9bb01.js"><link rel="prefetch" href="/assets/js/33.7e5facc3.js"><link rel="prefetch" href="/assets/js/34.d4cad2b8.js"><link rel="prefetch" href="/assets/js/35.e61ccf57.js"><link rel="prefetch" href="/assets/js/36.5d7bb307.js"><link rel="prefetch" href="/assets/js/37.72d003f5.js"><link rel="prefetch" href="/assets/js/38.39f6499c.js"><link rel="prefetch" href="/assets/js/39.20734010.js"><link rel="prefetch" href="/assets/js/4.e31bdafd.js"><link rel="prefetch" href="/assets/js/40.65106412.js"><link rel="prefetch" href="/assets/js/41.620a69db.js"><link rel="prefetch" href="/assets/js/42.635e7c39.js"><link rel="prefetch" href="/assets/js/43.4afa9554.js"><link rel="prefetch" href="/assets/js/44.50b8538c.js"><link rel="prefetch" href="/assets/js/45.fccb1d4b.js"><link rel="prefetch" href="/assets/js/46.a21baf83.js"><link rel="prefetch" href="/assets/js/47.a40e82d3.js"><link rel="prefetch" href="/assets/js/48.31b0351b.js"><link rel="prefetch" href="/assets/js/49.77457516.js"><link rel="prefetch" href="/assets/js/5.d8ce88b3.js"><link rel="prefetch" href="/assets/js/50.14f1c36c.js"><link rel="prefetch" href="/assets/js/51.c4ea1d97.js"><link rel="prefetch" href="/assets/js/52.66cc0914.js"><link rel="prefetch" href="/assets/js/53.e4311a60.js"><link rel="prefetch" href="/assets/js/54.616179f9.js"><link rel="prefetch" href="/assets/js/55.4b9d3787.js"><link rel="prefetch" href="/assets/js/56.ba6254b3.js"><link rel="prefetch" href="/assets/js/57.7c7419f4.js"><link rel="prefetch" href="/assets/js/58.a003cd94.js"><link rel="prefetch" href="/assets/js/59.8e47fad7.js"><link rel="prefetch" href="/assets/js/6.15c09f13.js"><link rel="prefetch" href="/assets/js/60.6960ea02.js"><link rel="prefetch" href="/assets/js/61.4ebd91e8.js"><link rel="prefetch" href="/assets/js/62.7b8cd160.js"><link rel="prefetch" href="/assets/js/63.1379a6f7.js"><link rel="prefetch" href="/assets/js/64.4b5f669f.js"><link rel="prefetch" href="/assets/js/65.764ae542.js"><link rel="prefetch" href="/assets/js/66.8b08aefd.js"><link rel="prefetch" href="/assets/js/67.806019e3.js"><link rel="prefetch" href="/assets/js/68.3272a928.js"><link rel="prefetch" href="/assets/js/69.cd510b1d.js"><link rel="prefetch" href="/assets/js/70.dd3f047a.js"><link rel="prefetch" href="/assets/js/71.1b07020e.js"><link rel="prefetch" href="/assets/js/72.e58a6e8c.js"><link rel="prefetch" href="/assets/js/73.0931d0e0.js"><link rel="prefetch" href="/assets/js/74.9ec3c14d.js"><link rel="prefetch" href="/assets/js/75.3791b2c1.js"><link rel="prefetch" href="/assets/js/76.57f5abc3.js"><link rel="prefetch" href="/assets/js/77.493a9b9d.js"><link rel="prefetch" href="/assets/js/78.33633b31.js"><link rel="prefetch" href="/assets/js/79.0ba5b64b.js"><link rel="prefetch" href="/assets/js/8.9eb39c35.js"><link rel="prefetch" href="/assets/js/80.1b43c566.js"><link rel="prefetch" href="/assets/js/81.46692a12.js"><link rel="prefetch" href="/assets/js/82.78113bd2.js"><link rel="prefetch" href="/assets/js/83.2282455e.js"><link rel="prefetch" href="/assets/js/84.a64cbe5f.js"><link rel="prefetch" href="/assets/js/85.e98ebc5d.js"><link rel="prefetch" href="/assets/js/86.bd65bdf5.js"><link rel="prefetch" href="/assets/js/87.7af4503d.js"><link rel="prefetch" href="/assets/js/88.bede154c.js"><link rel="prefetch" href="/assets/js/89.00974455.js"><link rel="prefetch" href="/assets/js/9.21b6276e.js"><link rel="prefetch" href="/assets/js/90.525705b6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.62d2b403.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(https://picsum.photos/1920/250.webp);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          L.Rain的博客
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/" class="navbar-link" data-v-e4145d0a>
            主页
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            分类
          </a><a href="https://github.com/baixiaoyu2997" target="_blank" rel="noopener noreferrer" class="navbar-link" data-v-e4145d0a><span data-v-e4145d0a>Github</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-e4145d0a data-v-e4145d0a><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          Docker学习随笔
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-08-12
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2021-01-08
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2020/08/09/nuxt%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html" class="post-link" data-v-4e23451f>
      上一篇 : nuxt学习随笔
    </a> <a href="/posts/2020/08/21/egg%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html" class="post-link" data-v-4e23451f>
      下一篇 : egg学习随笔
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><h2 id="docker-是什么"><a href="#docker-是什么" class="header-anchor">#</a> Docker 是什么？</h2> <p>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案。</p> <p>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样。有了 Docker，就不用担心环境问题。</p> <p>总体来说，Docker 的接口相当简单，用户可以方便地创建和使用容器，把自己的应用放入容器。容器还可以进行版本管理、复制、分享、修改，就像管理普通的代码一样。</p> <h2 id="为什么要用-docker"><a href="#为什么要用-docker" class="header-anchor">#</a> 为什么要用 docker？</h2> <p>用户计算机的环境都不相同，软件必须保证两件事：操作系统的设置，各种库和组件的安装，只有它们都正确，软件才能运行。<br>
环境配置如此麻烦，换一台机器，就要重来一次，旷日费时，所以产生了 docker。</p> <h2 id="docker-中的概念"><a href="#docker-中的概念" class="header-anchor">#</a> docker 中的概念</h2> <h3 id="registry"><a href="#registry" class="header-anchor">#</a> Registry</h3> <p>镜像仓库，存储大量镜像，可以从镜像仓库拉取和推送镜像。</p> <h3 id="docker-镜像"><a href="#docker-镜像" class="header-anchor">#</a> Docker 镜像</h3> <p>类似虚拟机快照，从仓库拉取，或者在现有工具镜像上创建新镜像。通过镜像可以启动容器。<br>
关于镜像的一些概念：</p> <ul><li>虚悬镜像：强制删除一个已经运行容器的镜像，或者使用 docker pull 命令更新镜像时，镜像的名称和标签会转移到新镜像中，旧的镜像就会变成虚悬镜像，另外，在使用 docker build 构建镜像的时候，如果构建失败也会产生虚悬镜像。一般来说虚悬镜像已经没有实际用处，可以随意删除。</li></ul> <h3 id="docker-容器"><a href="#docker-容器" class="header-anchor">#</a> Docker 容器</h3> <p>从镜像中创建应用环境，以单进程的方式运行。对外公开服务。是一种短暂的和一次性的环境。</p> <h3 id="docker-数据卷"><a href="#docker-数据卷" class="header-anchor">#</a> Docker 数据卷</h3> <p>数据卷可以完成数据持久化，数据卷是一个可供一个或多个容器使用的特殊目录，它绕过 UFS，可以提供很多有用的特性：</p> <ul><li>数据卷可以在容器之间共享和重用</li> <li>对数据卷的修改会立马生效</li> <li>对数据卷的更新，不会影响镜像</li> <li>卷会一直存在，直到没有容器使用</li></ul> <h3 id="docker-网络"><a href="#docker-网络" class="header-anchor">#</a> Docker 网络</h3> <p>Docker 容器之间的网络交互，可以使用端口映射的方式，其他容器可以直接通过端口实现。除该方式外还有一个容器连接（linking）系统也可以达到容器交互。（本文中 node 连接 mongodb 使用的是端口映射的方式）</p> <h3 id="host-宿主机"><a href="#host-宿主机" class="header-anchor">#</a> Host 宿主机</h3> <p>指的是当前使用的真实操作系统</p> <h2 id="docker-操作指令"><a href="#docker-操作指令" class="header-anchor">#</a> docker 操作指令</h2> <h3 id="pull"><a href="#pull" class="header-anchor">#</a> pull</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>pull</td> <td>拉取镜像</td> <td></td></tr></tbody></table> <h3 id="images"><a href="#images" class="header-anchor">#</a> images</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>images</td> <td>查看当前所有本地镜像</td> <td></td></tr> <tr><td>images</td> <td>查看当前所有本地镜像+中间层镜像</td> <td>-a</td></tr> <tr><td>rmi</td> <td>删除镜像</td> <td><code>&lt;image name&gt;</code></td></tr> <tr><td>rmi</td> <td>强制删除镜像</td> <td>-f <code>&lt;image name&gt;</code></td></tr> <tr><td>image</td> <td>删除虚悬镜像</td> <td>prune</td></tr> <tr><td>image</td> <td>创建镜像，并定义镜像名</td> <td>build -t &lt;镜像名&gt; &lt;路径&gt;</td></tr></tbody></table> <h3 id="save"><a href="#save" class="header-anchor">#</a> save</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>save</td> <td>导出镜像</td> <td>-o &lt;输出文件名.tar&gt; &lt;待导出镜像名&gt;</td></tr></tbody></table> <h3 id="load"><a href="#load" class="header-anchor">#</a> load</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>load</td> <td>导入镜像</td> <td>-i &lt;镜像.tar&gt;</td></tr></tbody></table> <h3 id="tag"><a href="#tag" class="header-anchor">#</a> tag</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>tag</td> <td>修改镜像名称和标签</td> <td>&lt;原镜像名：原标签&gt; &lt;镜像名：标签&gt;</td></tr></tbody></table> <h3 id="run"><a href="#run" class="header-anchor">#</a> run</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>run</td> <td>新建并启动容器，设置容器名称</td> <td>--name &lt;容器名&gt; &lt;镜像名&gt;</td></tr> <tr><td>run</td> <td>新建并启动容器，<code>-t</code>配置一个伪终端，并绑定到容器的输入上，<code>-i</code>能让容器的标准输入保持打开状态，<code>-d</code>则可以让容器在后台保持运行，这三个参数可以合并为<code>-dit</code>，其顺序没有影响</td> <td>-dit &lt;镜像名&gt;</td></tr> <tr><td>run</td> <td>容器停止后自动删除</td> <td>--rm</td></tr></tbody></table> <h3 id="ps"><a href="#ps" class="header-anchor">#</a> ps</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>ps</td> <td>查看所有容器及其状态</td> <td>-a</td></tr></tbody></table> <h3 id="exec"><a href="#exec" class="header-anchor">#</a> exec</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>exec</td> <td>进入容器,如果只是想执行容器中的命令，可以不输入<code>bash</code>，替换成命令名，退出容器，输入<code>exit</code></td> <td>-it &lt;容器名字｜容器 id&gt; bash</td></tr></tbody></table> <h3 id="start"><a href="#start" class="header-anchor">#</a> start</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>start</td> <td>启动容器</td> <td>&lt;容器名&gt;</td></tr></tbody></table> <h3 id="stop"><a href="#stop" class="header-anchor">#</a> stop</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>stop</td> <td>停止容器</td> <td>&lt;容器名&gt;</td></tr></tbody></table> <h3 id="rm"><a href="#rm" class="header-anchor">#</a> rm</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>rm</td> <td>删除容器</td> <td>&lt;容器名&gt;</td></tr> <tr><td>rm</td> <td>强制删除容器</td> <td>-f &lt;容器名&gt;</td></tr></tbody></table> <h3 id="container"><a href="#container" class="header-anchor">#</a> container</h3> <table><thead><tr><th>名称</th> <th>说明</th> <th>参数</th></tr></thead> <tbody><tr><td>container</td> <td>清空所有已停止容器</td> <td>prune</td></tr></tbody></table> <h2 id="dockerfile"><a href="#dockerfile" class="header-anchor">#</a> Dockerfile</h2> <div class="language- extra-class"><pre class="language-text"><code># Dockerfile文件
FROM ubuntu:16.04
ENV WORK_DIR=/workspace
WORKDIR ${WORK_DIR}
COPY . ${WORK_DIR}
RUN npm start
</code></pre></div><p>Dockerfile 是一个文本文件，包含了镜像构建的所有命令，通过修改 Dockerfile 中的命令，就能定制化自己想要的镜像。Dockerfile 里面每一个指令都会构建一层镜像，层层叠加最终得到定制化镜像。</p> <ul><li><code>FROM</code>指令代表基于哪个镜像进行修改，第一条指令必须是 FROM 指令，若我们不想基于任何镜像，可以写 FROM scratch 即可完全从零开始构建镜像。</li> <li><code>ENV</code>设置环境变量，定义了环境变量，那么在后续的指令中，就可以使用这个环境变量。它有俩种写法：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>ENV &lt;key&gt; &lt;value&gt;
ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;
</code></pre></div><ul><li><code>COPY</code>指令可以将宿主机中的文件在构建镜像时复制到镜像存储中。<code>.dockerignore</code> 指定的文件不会拷贝</li> <li><code>WORKDIR</code>为<code>RUN、CMD、ENTRYPOINT</code> 指令配置工作目录。在刚进入容器时，系统会自动转到工作目录，默认的工作目录是根目录/。<br>
可以使用多个 WORKDIR 指令，后续命令如果参数是相对路径，则会基于之前命令指定的路径。例如:</li></ul> <div class="language- extra-class"><pre class="language-text"><code>WORKDIR /a
WORKDIR b
WORKDIR c
RUN pwd
# 则最终路径为 /a/b/c 。
</code></pre></div><ul><li><code>RUN</code>指令就是用来执行命令的指令，由于一条指令就会创建一层镜像，而镜像层数是有限制的，一般是 127 层，当我们需要执行多条命令时，一般都用&amp;&amp;连接多条命令，从而节省镜像层数。执行时机是在容器启动之前。</li> <li><code>ADD</code> ADD 指令和 COPY 类似，但包含更多功能，比如可以从一个网址下载文件到目标目录中（下载后文件默认权限是 600），另外一个常用的功能是自动解压，支持 gzip、bzip2 和 xz 压缩格式，比如 ADD file.tar /会将压缩包解压到目标路径中。由于 ADD 指令语义不够清晰，除了需要自动解压的情况，我们一般都不推荐使用 ADD 指令。</li> <li><code>CMD</code> 运行格式：CMD [&quot;可执行文件&quot;, &quot;参数 1&quot;, &quot;参数 2&quot;...]。CMD 指令可以用来指定容器默认的运行命令,执行时机是在容器启动后。</li> <li><code>EXPOSE</code> 声明将容器内的某个端口导出供外部访问，并没有实际功能，导出端口还是需要在命令行中添加<code>-p</code></li></ul> <h3 id="copy"><a href="#copy" class="header-anchor">#</a> COPY</h3> <p>COPY命令在拷贝文件夹时，目的地址应该加上该文件夹名，例如：<code>COPY logs /root/logs</code>
COPY命令可以一次拷贝多个文件：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>COPY README.md package.json gulpfile.js __BUILD_NUMBER ./
// 或者
COPY <span class="token punctuation">[</span><span class="token string">&quot;__BUILD_NUMBER&quot;</span>, <span class="token string">&quot;README.md&quot;</span>, <span class="token string">&quot;gulpfile&quot;</span>, <span class="token string">&quot;another_file&quot;</span>, <span class="token string">&quot;./&quot;</span><span class="token punctuation">]</span>
</code></pre></div><p>但是这种写法对文件夹无效，如果你写<code>COPY dir1 dir2 ./</code>,实际上等于：<code>COPY dir1/* dir2/* ./</code></p> <h2 id="docker-部署流程"><a href="#docker-部署流程" class="header-anchor">#</a> docker 部署流程</h2> <ol><li>首先在项目根目录下创建<code>.dockerignore</code>文件，防止打包不必要的文件：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>.git
node_modules
</code></pre></div><ol start="2"><li>项目根目录中创建<code>Dockerfile</code>文件：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>FROM node:10.0
# 在容器中创建一个目录
RUN mkdir -p /usr/src/nodejs/
# 定位到容器的工作目录
WORKDIR /usr/src/nodejs/
# RUN/COPY 是分层的，package.json 提前，只要没修改，就不会重新安装包
COPY package.json /usr/src/app/package.json
RUN cd /usr/src/app/
RUN npm i
# 把当前目录下的所有文件拷贝到 Image 的 /usr/src/nodejs/ 目录下
COPY . /usr/src/nodejs/
EXPOSE 3000
CMD npm start
</code></pre></div><ol start="3"><li>构建镜像</li></ol> <div class="language- extra-class"><pre class="language-text"><code>docker build -t ubuntu_demo:latest .
</code></pre></div><h2 id="最佳实践"><a href="#最佳实践" class="header-anchor">#</a> 最佳实践</h2> <ol><li>减少 Docker 的层数。<br>
COPY、ADD 和 RUN 会向镜像中添加新层，Docker 的层就像是 git 的提交一样，Docker 的层用于保存镜像的上一版本和当前版本之间的差异。当你向注册表请求镜像时，只是下载你尚未拥有的层。<br>
层会占用空间，拥有的层越多，最终的镜像就越大</li></ol> <h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <h3 id="docker镜像挂载外部文件"><a href="#docker镜像挂载外部文件" class="header-anchor">#</a> docker镜像挂载外部文件？</h3> <p>比如说想加载一个外部配置文件或者一个目录，那么可以通过以下方式指定：</p> <div class="language-sh extra-class"><pre class="language-sh"><code>docker run -it -v /test:/soft centos /bin/bash  
</code></pre></div><p>冒号&quot;:&quot;前面的目录是宿主机目录，后面的目录是容器内目录。</p> <blockquote><p>参考 https://www.cnblogs.com/shix0909/p/11124466.html</p></blockquote> <h3 id="删除所有-images"><a href="#删除所有-images" class="header-anchor">#</a> 删除所有 images</h3> <p><code>docker rmi --force $(docker images -q)</code></p> <h3 id="删除名称中包韩某个字符串的镜像"><a href="#删除名称中包韩某个字符串的镜像" class="header-anchor">#</a> 删除名称中包韩某个字符串的镜像</h3> <div class="language- extra-class"><pre class="language-text"><code># 例如删除包含“some”的镜像
docker rmi --force $(docker images | grep some | awk '{print $3}')
</code></pre></div><h3 id="删除所有的镜像"><a href="#删除所有的镜像" class="header-anchor">#</a> 删除所有的镜像</h3> <div class="language- extra-class"><pre class="language-text"><code>docker rmi $(docker images -q)
</code></pre></div><h2 id="引用"><a href="#引用" class="header-anchor">#</a> 引用</h2> <p><a href="https://www.cnblogs.com/ryanyangcs/p/12558727.html" target="_blank" rel="noopener noreferrer">两个奇技淫巧，将 Docker 镜像体积减小 99%<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-08-12
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2021-01-08
    </span></section> <section class="post-links" data-v-4e23451f><a href="/posts/2020/08/09/nuxt%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html" class="post-link" data-v-4e23451f>
      上一篇 : nuxt学习随笔
    </a> <a href="/posts/2020/08/21/egg%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html" class="post-link" data-v-4e23451f>
      下一篇 : egg学习随笔
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" data-v-9d847660><img src="https://blog-pic.oss-cn-beijing.aliyuncs.com/avatar.webp" alt="L.Rain" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      L.Rain
    </section> <section class="info-desc" data-v-9d847660>真实、自由、宽容</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="ChengDu City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ChengDu City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ChengDu City, China
        </span></span></section> <section data-v-9d847660><span title="ChengDu YeeYun Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>ChengDu YeeYun Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          ChengDu YeeYun Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:bxy2997@sina.com" title="bxy2997@sina.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>bxy2997@sina.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          bxy2997@sina.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/baixiaoyu2997" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: L.Rain" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: L.Rain</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a><a href="https://weibo.com/1504398495" target="_blank" class="sns-link" data-v-9d847660><span title="新浪微博: 白晓宇V" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>新浪微博: 白晓宇V</title><use xlink:href="#icon-weibo" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-是什么">Docker 是什么？</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#为什么要用-docker">为什么要用 docker？</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-中的概念">docker 中的概念</a><ul><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#registry">Registry</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-镜像">Docker 镜像</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-容器">Docker 容器</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-数据卷">Docker 数据卷</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-网络">Docker 网络</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#host-宿主机">Host 宿主机</a></li></ul></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-操作指令">docker 操作指令</a><ul><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#pull">pull</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#images">images</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#save">save</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#load">load</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#tag">tag</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#run">run</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#ps">ps</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#exec">exec</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#start">start</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#stop">stop</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#rm">rm</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#container">container</a></li></ul></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#dockerfile">Dockerfile</a><ul><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#copy">COPY</a></li></ul></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker-部署流程">docker 部署流程</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#最佳实践">最佳实践</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#问题">问题</a><ul><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#docker镜像挂载外部文件">docker镜像挂载外部文件？</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#删除所有-images">删除所有 images</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#删除名称中包韩某个字符串的镜像">删除名称中包韩某个字符串的镜像</a></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#删除所有的镜像">删除所有的镜像</a></li></ul></li><li><a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#引用">引用</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2020/08/12/docker%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/baixiaoyu2997" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: L.Rain" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: L.Rain</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a><a href="https://weibo.com/1504398495" target="_blank" class="sns-link" data-v-1375e54c><span title="新浪微博: 白晓宇V" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>新浪微博: 白晓宇V</title><use xlink:href="#icon-weibo" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <!----></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.85c1525a.js" defer></script><script src="/assets/js/7.bc1fde9d.js" defer></script><script src="/assets/js/18.56a1bafd.js" defer></script>
  </body>
</html>
